!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).xmsdk={})}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s=function(){function t(e){n(this,t),this._host=e}return r(t,[{key:"extractHeaders",value:function(t){return t.trim().split(/[\r\n]+/).map((function(t){var e=t.split(": "),n=e.shift(),o=e.join(": "),r=new com.ts.mobile.sdk.TransportHeader;return r.setName(n),r.setValue(o),r}))}},{key:"sendRequest",value:function(t){var e=this;return new Promise((function(n,o){var r=new XMLHttpRequest,i=function(){o(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Communication,r.responseText))};r.open(t.getMethod(),t.getUrl(),!0),r.withCredentials=!0,r.onreadystatechange=function(){if(4===r.readyState)try{if(0===r.status)return e._host.log(com.ts.mobile.sdk.LogLevel.Error,"transport","Destination server is invalid or the server does not support access-control-allow-origin."),o(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Communication,r.responseText));JSON.parse(r.responseText);var s=new com.ts.mobile.sdk.TransportResponse;s.setStatus(r.status),s.setMethod(t.getMethod()),s.setHeaders(e.extractHeaders(r.getAllResponseHeaders())),s.setBodyJson(r.responseText),n(s)}catch(t){i()}},r.onerror=function(){i()},t.getHeaders().forEach((function(t){r.setRequestHeader(t.getName(),t.getValue())})),r.setRequestHeader("Content-Type","application/json"),r.send(t.getBodyJson())}))}}]),t}(),a={ts_gen_back:"BACK",ts_gen_skip:"SKIP",ts_gen_continue:"Continue",ts_gen_cancel:"CANCEL",ts_gen_close:"CLOSE",ts_gen_ok:"OK",ts_gen_default:"Default",ts_gen_restart:"RESTART",ts_gen_expired:"Authenticator expired. Please reregister.",ts_gen_cancel_authentication:"CANCEL",ts_gen_change_authenticator:"CHANGE METHOD",ts_gen_select_authenticator:"CHANGE METHOD",ts_gen_retry_authenticator:"TRY AGAIN",ts_gen_dismiss:"DISMISS",ts_authenticator_device_biometrics:"Device Biometrics",ts_authenticator_password:"Password",ts_authenticator_pin:"PIN",ts_authenticator_pattern:"Pattern",ts_authenticator_otp:"OTP",ts_authenticator_fingerprint:"Fingerprint",ts_authenticator_question:"Security Questions",ts_authenticator_face_id:"Face ID",ts_authenticator_touch_id:"Touch ID",ts_authenticator_totp:"Soft Token",ts_authenticator_pattern_centralized:"Pattern",ts_authenticator_pin_centralized:"PIN",ts_authenticator_voice_server:"Voice",ts_authenticator_fido2:"FIDO2",ts_authenticator_mobile_approve:"Mobile Approve",ts_authenticator_face_server:"Face",ts_authenticator_fido_fidopin:"PIN",ts_authenticator_fido_fidoface:"Face ID",ts_authenticator_fido_fidofp:"Fingerprint",ts_authenticator_device_biometrics_description:"Use the biometric sensors registered on your device",ts_authenticator_password_description:"",ts_authenticator_pin_description:"Numeric PIN code",ts_authenticator_pin_centralized_description:"Numeric PIN code",ts_authenticator_pattern_description:"Visual pattern",ts_authenticator_pattern_centralized_description:"Visual pattern",ts_authenticator_otp_description:"One time password sent to your phone or email",ts_authenticator_voice_description:"Use your voice print",ts_authenticator_voice_server_description:"Use your voice print",ts_authenticator_questions_description:"Knowledge based questions",ts_authenticator_face_description:"Use your smartphone's camera",ts_authenticator_fingerprint_description:"Use your smartphone's biometric sensor",ts_authenticator_face_id_description:"Use Face ID",ts_authenticator_touch_id_description:"Use Touch ID",ts_authenticator_totp_description:"Use soft token",ts_authenticator_mobile_approve_description:"Use mobile approve",ts_authenticator_fido2_description:"Use a security key",ts_authenticator_password_title_auth:"Authenticate with Password",ts_authenticator_password_title_reg:"Register Password",ts_authenticator_password_intro_auth:"",ts_authenticator_password_intro_reg:"",ts_authenticator_password_field_hint:"Password",ts_authenticator_password_reg_field_hint:"Repeat password",ts_authenticator_password_cta_positive:"CONTINUE",ts_authenticator_password_error_too_short:"Password too short!",ts_authenticator_password_error_reg_no_match:"Passwords don't match!",ts_authenticator_password_error_reg_strength_validation_failed:"Password must be at least 6 characters long, and contain a mix of lowercase characters, uppercase characters, and digits.",ts_authenticator_pin_title_auth:"Authenticate with PIN Code",ts_authenticator_pin_title_reg:"Register PIN Code",ts_authenticator_pin_intro_auth:"Enter your PIN Code to proceed",ts_authenticator_pin_intro_reg:"Enter your new PIN Code to proceed",ts_authenticator_pin_intro_repeat:"Re-enter your new PIN Code",ts_authenticator_pin_error_reg_no_match:"Codes don't match!",ts_authenticator_pin_code_length:"Enter your %1$s-digit PIN code",ts_authenticator_otp_title_auth:"Authenticate with OTP",ts_authenticator_otp_qr_title:"Authenticate with QR",ts_authenticator_otp_targets_intro:"Please select how you want us to deliver a One Time Password to you.",ts_authenticator_otp_sms_title:"SMS",ts_authenticator_otp_email_title:"EMAIL",ts_authenticator_otp_voice_title:"VOICE",ts_authenticator_otp_push_title:"PUSH",ts_authenticator_otp_unknown_title:"Unknown",ts_authenticator_otp_sms_sent:"A text message with a code was sent to your phone. Please type it here.",ts_authenticator_otp_email_sent:"A code was sent to your email. Please type it here.",ts_authenticator_otp_push_sent:"A push notification with a code was sent to your phone. Please type it here.",ts_authenticator_otp_voice_sent:"A voice message with a code is being delivered to your phone. Please type it here.",ts_authenticator_otp_qr_sent:"A QR code was sent to your email. Please scan it.",ts_authenticator_otp_external_numeric_sent:"A code is being delivered to you. Please type it here.",ts_authenticator_otp_external_qr_sent:"Please scan the QR code to proceed",ts_authenticator_otp_resend:"RESEND OTP",ts_authenticator_otp_resend_message:"Didn't get the code?",ts_authenticator_otp_resend_intro:"Code resent.",ts_authenticator_otp_error_qr_permission:"Using QR to authenticate requires permission to access your phone's camera",ts_authenticator_otp_error_code_expired:"Your code is no longer valid, please request a new one",ts_authenticator_otp_code_length:"Enter the %1$s-digit code",ts_authenticator_pattern_title_auth:"Authenticate with Pattern",ts_authenticator_pattern_title_reg:"Register Pattern",ts_authenticator_pattern_intro_auth:"Draw your pattern to proceed",ts_authenticator_pattern_intro_reg:"Draw your new pattern to proceed",ts_authenticator_pattern_mismatch:"Patterns don't match. Re-draw your new pattern to proceed.",ts_authenticator_pattern_error_min_points:"Pattern is too short. Try again",ts_authenticator_pattern_intro_repeat:"Re-draw your pattern",ts_authenticator_pattern_cta_reset:"RESTART",ts_authenticator_fingerprint_title_auth:"Authenticate with Fingerprint",ts_authenticator_fingerprint_title_reg:"Confirm fingerprint to continue",ts_authenticator_fingerprint_status_hint:"Touch sensor",ts_authenticator_faceid_title_auth:"Authenticate with Face ID",ts_authenticator_faceid_title_reg:"Confirm Face ID to continue",ts_authenticator_touchid_title_reg:"Authenticate with Touch ID",ts_authenticator_touchid_title_auth:"Confirm Touch ID to continue",ts_authenticator_device_biometrics_title_auth:"Authenticate with device biometrics",ts_authenticator_device_biometrics_title_reg:"Confirm device biometrics to continue",ts_authenticator_device_biometrics_intro_auth:"Authenticate biometric to continue",ts_authenticator_device_biometrics_intro_reg:"Register biometric to continue",ts_authenticator_device_biometrics_prompt:"Follow biometric instructions",ts_authenticator_device_biometrics_cancel_cta:"Cancel biometric",ts_authenticator_questions_title_auth:"Authenticate with Security Questions",ts_authenticator_questions_title_reg:"Register Security Questions",ts_authenticator_questions_intro_auth:"Answer the question below to proceed",ts_authenticator_questions_intro_reg:"Answer at least %1$s questions to proceed.",ts_authenticator_questions_error_answer_range:"Answer must be between %1$s to %2$s characters.",ts_authenticator_questions_left:"%1$s questions answered",ts_authenticator_questions_error_answer_empty:"Please provide an answer",ts_authenticator_questions_remove_this_question_cta:"REMOVE",ts_authenticator_questions_add_question_cta:"ADD QUESTION",ts_authenticator_questions_reg_select_question:"Select Question",ts_authenticator_questions_reg_select_question_cta:"CHOOSE",ts_authenticator_questions_reg_default_answer_placeholder:"*******",ts_authenticator_voice_title_auth:"Authenticate with Voice",ts_authenticator_voice_title_reg:"Register Voice",ts_authenticator_voice_intro_auth:"Follow instructions to authenticate with your voice signature",ts_authenticator_voice_intro_reg:"Follow instructions to register your voice signature",ts_authenticator_voice_passphrase:"Hold to record and repeat the following passphrase %1$s.",ts_authenticator_voice_passphrase_subtitle:"You might be prompted to say it more than once.",ts_authenticator_voice_instructions:"Please record again.",ts_authenticator_voice_record_start:"Hold to record",ts_authenticator_voice_record_stop:"Release to stop",ts_authenticator_voice_request_audio_permission:"Recording voice requires permission to access your phone's microphone",ts_authenticator_voice_error_too_long:"The recording is too long",ts_authenticator_voice_error_too_short:"Recording too short",ts_authenticator_voice_error_too_loud:"Recording too loud",ts_authenticator_voice_error_too_weak:"Recording too weak",ts_authenticator_voice_error_too_noisy:"Recording too noisy",ts_authenticator_voice_error_invalid:"Wrong passphrase!",ts_authenticator_face_title_auth:"Authenticate with Face",ts_authenticator_face_title_reg:"Register Face",ts_authenticator_face_intro_auth:"Capture a selfie in order to proceed",ts_authenticator_face_intro_reg:"Capture a selfie in order to proceed",ts_authenticator_face_error_invalid:"Could not find a match, please try again",ts_authenticator_totp_title:"Authenticate with Soft Token",ts_authenticator_totp_targets_intro:"Please select device",ts_authenticator_totp_input_intro:"Please input code",ts_authenticator_totp_input_with_challenge_intro:"Please use challenge and input code",ts_authenticator_totp_input_with_qr_challenge_intro:"Please scan QR challenge and input code",ts_authenticator_totp_qrcode_challenge_step1_message:"Step 1: Scan this QR code using your mobile app",ts_authenticator_totp_qrcode_challenge_step2_message:"Step 2: Enter the code generated by your mobile app",ts_authenticator_totp_code_challenge_step1_message:"Step 1: Enter this key into your mobile app",ts_authenticator_totp_code_challenge_step2_message:"Step 2: Enter the code generated by your mobile app",ts_authenticator_totp_input_hint:"Insert code",ts_authenticator_totp_targets_recently_used:"Recently used: %1$s",ts_authenticator_totp_targets_current_device:"Current Device",ts_authenticator_mobile_approve_title:"Mobile Approve",ts_authenticator_mobile_approve_fetching_data:"Please wait... Fetching data",ts_authenticator_mobile_approve_send:"SEND",ts_authenticator_mobile_approve_send_to_all:"SEND TO ALL",ts_authenticator_mobile_approve_targets_intro:"Please select device",ts_authenticator_mobile_approve_targets_recently_used:"Recently used: %1$s",ts_authenticator_mobile_approve_targets_current_device:"Current Device",ts_authenticator_mobile_approve_resend_message:"Didn't get the approval request?",ts_authenticator_mobile_approve_resend_cta:"RESEND",ts_session_config_title:"Authenticator configuration",ts_session_config_intro:"Register, remove or change your authenticators.",ts_session_config_item_action_register:"REGISTER",ts_session_config_item_action_unregister:"UNREGISTER",ts_session_config_item_action_reregister:"CHANGE",ts_session_config_item_action_set_as_default:"SET AS DEFAULT",ts_session_config_item_register_result:"%1$s registered successfully",ts_session_config_item_reregister_result:"%1$s changed successfully",ts_session_config_item_unregister_result:"%1$s unregistered successfully",ts_session_config_item_default_result:"%1$s is now the default authenticator",ts_session_config_item_register_failed:"%1$s registration failed. %2$s",ts_session_config_item_reregister_failed:"%1$s change failed. %2$s",ts_session_config_item_unregister_failed:"%1$s unregistration failed. %2$s",ts_session_config_item_default_failed:"Failed to make %1$s the default authenticator. %2$s",ts_session_config_item_unregister_dialog_title:"Are your sure?",ts_session_config_item_unregister_dialog_message:"Do you want to unregister %1$s?",ts_session_config_item_unregister_dialog_cta:"UNREGISTER",ts_session_config_error_dialog_title:"Something went wrong",ts_session_totp_title:"Generate Soft Token",ts_session_totp_content:"Your code is being reset every %1$s seconds.",ts_session_totp_unbound_title:"Unbound TOTP Generation",ts_session_totp_unbound_content:"Your TOTP code has been generated",ts_session_totp_unbound_code:"Your TOTP code is: %1$s",ts_session_totp_nottl_content:"Please use this code.",ts_session_totp_provision_sa_title:"Select Authenticator for Provisioning Soft Token",ts_session_totp_provision_password_title:"Provision Soft Token With Password",ts_session_totp_provision_pattern_title:"Provision Soft Token With Pattern",ts_session_totp_provision_pin_title:"Provision Soft Token With PIN",ts_session_totp_generation_sa_title:"Generate Soft Token with Authenticator",ts_session_totp_generation_password_title:"Generate Soft Token with Password",ts_session_totp_generation_pattern_title:"Generate Soft Token with Pattern",ts_session_totp_generation_pin_title:"Generate Soft Token with PIN",ts_session_totp_generation_fingerprint_title:"Generate Soft Token with Fingerprint",ts_session_totp_generation_device_biometrics_title:"Generate Soft Token with Device Biometrics",ts_session_totp_challenge_title_list:"Soft Token with Challenge",ts_session_totp_challenge_intro_list:"Choose challenge type",ts_session_totp_challenge_title_textual:"Textual",ts_session_totp_challenge_intro_textual:"Enter the challenge to proceed",ts_session_totp_challenge_title_qr:"QR Code",ts_session_totp_challenge_intro_qr:"Scan the QR code to proceed",ts_session_approval_approve:"APPROVE",ts_session_approval_deny:"DENY",ts_session_approval_completed_title:"Success",ts_session_approval_completed_subtitle:"The request has been successfully approved. Please return to the requesting application.",ts_session_approval_completed_denied_subtitle:"The request has been successfully denied. Please return to the requesting application.",ts_session_approval_dialog_title:"Deny approval",ts_session_approval_dialog_message:"Deny approval",ts_session_approval_dialog_cta:"DENY",ts_session_approval_approve_failed:"'%1$s' failed to approve",ts_session_approval_deny_failed:"'%1$s' failed to deny",ts_session_approval_approve_failed_title:"An Error Occurred",ts_session_approval_deny_failed_title:"An Error Occurred",ts_session_approval_approve_failed_cta:"CLOSE",ts_session_approval_deny_failed_cta:"CLOSE",ts_session_approval_username:"Username",ts_session_approval_service:"Service",ts_session_approval_description:"Details",ts_session_approval_requested_device:"Requesting Device",ts_session_approval_expiry:"Expiry",ts_session_approval_requested_location:"Request Location",ts_session_approval_request_expires_time:"Your request expires in %1$s",ts_session_approval_request_has_expired:"Your request has expired",ts_session_dm_title:"Your Devices",ts_session_dm_intro:"These are the devices you've used to log into our applications. Click on a device for more information and options.",ts_session_dm_section_current:"This device",ts_session_dm_section_others:"Other devices",ts_session_dm_last_used_date:"Last used: %1$s",ts_session_dm_last_used_location:"at %1$s",ts_session_dm_details_title:"Your Device Details",ts_session_dm_details_subtitle:"Details about your device",ts_session_dm_details_current_device:"Current device",ts_session_dm_details_rename_action:"RENAME",ts_session_dm_details_remove_subtitle:"You can remove this device if you're not using it anymore.",ts_session_dm_details_remove_action:"REMOVE",ts_session_dm_details_no_other_devices_available:"No other devices available at the moment",ts_session_dm_item_action_dialog_remove_title:"Remove '%1$s'",ts_session_dm_item_action_dialog_remove_message:"Are you sure you want to remove this device?",ts_session_dm_item_action_dialog_remove_cta:"REMOVE",ts_session_dm_item_action_dialog_rename_title:"Rename '%1$s'",ts_session_dm_item_action_dialog_rename_cta:"RENAME",ts_session_dm_details_rename_input_hint:"New Device Name",ts_session_dm_item_action_rename_result_positive:"Device %1$s was renamed successfully to %2$s",ts_session_dm_item_action_rename_result_negative:"Failed to rename %1$s. %2$s",ts_session_dm_item_action_remove_result_positive:"Device %1$s was removed successfully",ts_session_dm_item_action_remove_result_negative:"Failed to remove %1$s. %2$s",ts_session_dm_error_dialog_title:"Something went wrong",ts_session_promotion_title:"Promotion",ts_session_promotion_intro:"Select authentication method to register",ts_session_promotion_skip:"SKIP",ts_session_promotion_abort:"ABORT",ts_promise_sa_title:"Verify It's You",ts_promise_sa_content:"Choose how you want to verify yourself",ts_promise_co_title_auth:"Authentication canceled!",ts_promise_co_title_reg:"Registration canceled!",ts_promise_fallback_title:"%1$s failed.",ts_promise_fallback_content:"Would you like to try a different method?",ts_promise_fallback_action_fallback:"TRY ANOTHER METHOD",ts_promise_fallback_action_menu:"CHANGE METHOD",ts_promise_fallback_action_retry:"TRY AGAIN",ts_promise_fallback_action_cancel:"CANCEL",ts_promise_co_content:"What would you like to do?",ts_promise_co_abort:"ABORT",ts_promise_co_select:"SELECT METHOD",ts_promise_co_change:"CHANGE METHOD",ts_promise_co_retry:"RETRY METHOD",ts_promise_error_default_title_auth:"Authentication failed",ts_promise_error_default_title_reg:"Registration failed",ts_promise_error_default_content_auth:"%1$s",ts_promise_error_default_content_reg:"%1$s",ts_promise_error_lock_title:"Authenticator Locked!",ts_promise_error_lock_content:"Too many failed attempts",ts_promise_invalid_authenticator_title:"%1$s invalidated",ts_promise_invalid_authenticator_content:"This authenticator has became invalid and is no longer available.",ts_promise_invalid_authenticator_cta:"CONTINUE",ts_promise_rejection_policy_title:"Error",ts_promise_rejection_policy_content:"Configuration error, please contact support",ts_promise_rejection_policy_cta:"CONTINUE",ts_promise_rejection_locked_user_title:"User Locked",ts_promise_rejection_locked_user_content:"You have been locked, please contact support",ts_promise_rejection_locked_user_cta:"CONTINUE",ts_promise_rejection_locked_device_title:"Device Locked",ts_promise_rejection_locked_device_content:"Your device has been locked, please contact support",ts_promise_rejection_locked_device_cta:"CONTINUE",ts_promise_rejection_locked_application_title:"Application Locked",ts_promise_rejection_locked_application_content:"Your application has been locked, please contact support",ts_promise_rejection_locked_application_cta:"CONTINUE",ts_promise_rejection_approval_expired_title:"Expired",ts_promise_rejection_approval_expired_content:"Request has expired, please try again",ts_promise_rejection_approval_expired_cta:"CONTINUE",ts_session_authenticator_expired_title:"%1$s Expired",ts_session_authenticator_expired_content:"Click continue to reregister",ts_promise_rejection_feature_not_supported_title:"Upgrade Required",ts_promise_rejection_feature_not_supported_content:"Your application is too old, please upgrade",ts_promise_rejection_feature_not_supported_cta:"CONTINUE",ts_promise_rejection_cannot_consume_ticket_title:"Error",ts_promise_rejection_cannot_consume_ticket_content:"Configuration error, please contact support",ts_promise_rejection_cannot_consume_ticket_cta:"CONTINUE",ts_promise_rejection_username_already_exists_title:"User Already Exists",ts_promise_rejection_username_already_exists_content:"The user %1$s already exists.",ts_promise_rejection_username_already_exists_cta:"CLOSE",ts_promise_rejection_authenticator_fatal_error_title:"An Error Occurred",ts_promise_rejection_authenticator_fatal_error_content:"Something went wrong when trying to add or verify using this method. ",ts_promise_rejection_authenticator_fatal_error_cta:"CLOSE",ts_accessibility_totp_reset:"New code is %1$s. %2$s seconds left before reset.",ts_accessibility_totp_reader:"Code is %1$s. %2$s seconds left.",ts_accessibility_totp_no_ttl:"Your code is %1$s.",ts_accessibility_configuration_cta_register:"Register %1$s",ts_accessibility_configuration_cta_unregister:"Unregister %1$s",ts_accessibility_configuration_cta_reregister:"Change %1$s",ts_accessibility_input_reader:"%1$s cells filled, %2$s cells remaining",ts_accessibility_input_pin_cell:"Cell filled",ts_accessibility_input_reset:"Cells were reset.",ts_accessibility_authenticator_list_locked:"%1$s authenticator is locked. selection disabled.",ts_accessibility_authenticator_list_disabled:"%1$s authenticator is unregistered. selection disabled.",ts_accessibility_authenticator_list_enabled:"%1$s authenticator. double tap to authenticate",ts_accessibility_authenticator_list_default:"%1$s authenticator is the Default authenticator. double tap to authenticate",ts_accessibility_hide_input_field:"Hide Input field",ts_accessibility_show_input_field:"Show Input field",ts_accessibility_back:"Back",ts_accessibility_cancel:"Cancel",ts_accessibility_password_enter_password:"Enter your new password",ts_accessibility_password_enter_password_again:"Enter your new password again",ts_accessibility_password_error_reg_no_match:"Passwords don't match. Try again",ts_plugin_dynamic_form_mandatory:"%1$s *",ts_plugin_dynamic_form_error_mandatory:"'%1$s' is mandatory!",ts_plugin_dynamic_form_error_invalid:"'%1$s' invalid value",ts_plugin_dynamic_form_error_too_long:"'%1$s' is too long",ts_plugin_dynamic_form_error_not_phone:"'%1$s' isn't a valid phone number",ts_plugin_dynamic_form_error_not_email:"'%1$s' isn't a valid Email address",ts_plugin_dynamic_form_error_else:"Something went wrong",ts_plugin_dynamic_form_table_title:"Add row",ts_plugin_dynamic_form_table_title_item:"Add row to %1$s",ts_plugin_dynamic_form_error_general:"Failed to read '%1$s' value",ts_plugin_dynamic_form_item_cta_positive:"OK",ts_plugin_dynamic_form_item_cta_cancel:"Dismiss",ts_plugin_dynamic_form_item_cta_select_all:"Select All",ts_plugin_dynamic_form_item_cta_clear_all:"Clear All",ts_plugin_dynamic_form_item_phone_prefix:"%1$s +%2$s",ts_plugin_dynamic_form_item_phone_prefix_dialog_title:"Select country",ts_session_scan_qr_title:"Scan QR",ts_session_scan_qr_hint:"No QR code detected",ts_gen_recovery:"Forgot my %1$s"},u=function(){function t(){n(this,t)}return r(t,[{key:"formatAsTwoDigits",value:function(t){return t.toLocaleString("EN",{minimumIntegerDigits:2,useGrouping:!1})}},{key:"logDateFormat",value:function(t){var e=t.getFullYear(),n=this.formatAsTwoDigits(t.getMonth()+1),o=this.formatAsTwoDigits(t.getDate()),r=this.formatAsTwoDigits(t.getHours()),i=this.formatAsTwoDigits(t.getMinutes()),s=this.formatAsTwoDigits(t.getSeconds()),a=t.getMilliseconds().toLocaleString("EN",{minimumIntegerDigits:3,useGrouping:!1});return"".concat(e,"-").concat(n,"-").concat(o," ").concat(r,":").concat(i,":").concat(s,".").concat(a)}},{key:"log",value:function(t,e,n){var o=com.ts.mobile.sdk.LogLevel[t].toUpperCase();console.log("".concat(this.logDateFormat(new Date),"\t").concat(o,"\t").concat(e,":\t").concat(n))}}]),t}();function c(t,e,n){var o;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(n=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var o=0,r={};o<arguments.length;o++){var i=arguments[o];for(var s in i)r[s]=i[s]}return r}({path:"/"},{},n)).expires){var r=new Date;r.setMilliseconds(r.getMilliseconds()+864e5*n.expires),n.expires=r}n.expires=n.expires?n.expires.toUTCString():"";try{o=JSON.stringify(e),/^[\{\[]/.test(o)&&(e=o)}catch(t){}e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var i="";for(var s in n)n[s]&&(i+="; "+s,!0!==n[s]&&(i+="="+n[s]));return document.cookie=t+"="+e+i}t||(o={});for(var a=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,c=0;c<a.length;c++){var l=a[c].split("="),p=l.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var h=l[0].replace(u,decodeURIComponent);if(p=p.replace(u,decodeURIComponent),t===h){o=p;break}t||(o[h]=p)}catch(t){}}return o}}var l={set:c,get:function(t){return c.call(c,t)},remove:function(t){c(t,"",{expires:-1})}},p=function(){function t(e){n(this,t),this._persistent=e}return r(t,[{key:"setItem",value:function(t,e){var n=btoa(e);this._persistent?l.set(t,n,{expires:365}):l.set(t,n)}},{key:"removeItem",value:function(t){l.remove(t)}},{key:"getItem",value:function(t){var e=l.get(t);return e&&(e=atob(e)),e}}]),t}(),h=function(){function t(){n(this,t),this._memStore={}}return r(t,[{key:"setItem",value:function(t,e){this._memStore[t]=e}},{key:"removeItem",value:function(t){delete this._memStore[t]}},{key:"getItem",value:function(t){return this._memStore[t]}}]),t}(),d=function(){function t(e){if(n(this,t),"undefined"!=typeof window)try{this.currentStorage=window[e],this.currentStorage.setItem("ts:test","ok"),this.currentStorage.removeItem("ts:test")}catch(t){console.warn("Failed to use browser storage. Resorting to cookies."),this.currentStorage=new p("localStorage"==e)}else this.currentStorage=new h}return r(t,[{key:"setItem",value:function(t,e){this.currentStorage.setItem(t,e)}},{key:"getItem",value:function(t){return this.currentStorage.getItem(t)}},{key:"removeItem",value:function(t){this.currentStorage.removeItem(t)}}]),t}(),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(t,e){return t(e={exports:{}},e.exports),e.exports}var g=m((function(t){!function(e,n){t.exports?t.exports=n():e.exports?e.exports=n():e.Fingerprint2=n()}(f,(function(){function t(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function e(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function n(t,e){return 32==(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])}function o(t,e){return 0==(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function r(t,e){return[t[0]^e[0],t[1]^e[1]]}function i(t){return t=r(t,[0,t[0]>>>1]),t=r(t=e(t,[4283543511,3981806797]),[0,t[0]>>>1]),r(t=e(t,[3301882366,444984403]),[0,t[0]>>>1])}function s(s,a){a=a||0;for(var u=(s=s||"").length%16,c=s.length-u,l=[0,a],p=[0,a],h=[0,0],d=[0,0],f=[2277735313,289559509],m=[1291169091,658871167],g=0;g<c;g+=16)h=[255&s.charCodeAt(g+4)|(255&s.charCodeAt(g+5))<<8|(255&s.charCodeAt(g+6))<<16|(255&s.charCodeAt(g+7))<<24,255&s.charCodeAt(g)|(255&s.charCodeAt(g+1))<<8|(255&s.charCodeAt(g+2))<<16|(255&s.charCodeAt(g+3))<<24],d=[255&s.charCodeAt(g+12)|(255&s.charCodeAt(g+13))<<8|(255&s.charCodeAt(g+14))<<16|(255&s.charCodeAt(g+15))<<24,255&s.charCodeAt(g+8)|(255&s.charCodeAt(g+9))<<8|(255&s.charCodeAt(g+10))<<16|(255&s.charCodeAt(g+11))<<24],h=n(h=e(h,f),31),l=t(l=n(l=r(l,h=e(h,m)),27),p),l=t(e(l,[0,5]),[0,1390208809]),d=n(d=e(d,m),33),p=t(p=n(p=r(p,d=e(d,f)),31),l),p=t(e(p,[0,5]),[0,944331445]);switch(h=[0,0],d=[0,0],u){case 15:d=r(d,o([0,s.charCodeAt(g+14)],48));case 14:d=r(d,o([0,s.charCodeAt(g+13)],40));case 13:d=r(d,o([0,s.charCodeAt(g+12)],32));case 12:d=r(d,o([0,s.charCodeAt(g+11)],24));case 11:d=r(d,o([0,s.charCodeAt(g+10)],16));case 10:d=r(d,o([0,s.charCodeAt(g+9)],8));case 9:d=e(d=r(d,[0,s.charCodeAt(g+8)]),m),p=r(p,d=e(d=n(d,33),f));case 8:h=r(h,o([0,s.charCodeAt(g+7)],56));case 7:h=r(h,o([0,s.charCodeAt(g+6)],48));case 6:h=r(h,o([0,s.charCodeAt(g+5)],40));case 5:h=r(h,o([0,s.charCodeAt(g+4)],32));case 4:h=r(h,o([0,s.charCodeAt(g+3)],24));case 3:h=r(h,o([0,s.charCodeAt(g+2)],16));case 2:h=r(h,o([0,s.charCodeAt(g+1)],8));case 1:h=e(h=r(h,[0,s.charCodeAt(g)]),f),l=r(l,h=e(h=n(h,31),m))}return l=t(l=r(l,[0,s.length]),p=r(p,[0,s.length])),p=t(p,l),l=t(l=i(l),p=i(p)),p=t(p,l),("00000000"+(l[0]>>>0).toString(16)).slice(-8)+("00000000"+(l[1]>>>0).toString(16)).slice(-8)+("00000000"+(p[0]>>>0).toString(16)).slice(-8)+("00000000"+(p[1]>>>0).toString(16)).slice(-8)}function a(t,e){if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e);else if(t.length===+t.length)for(var n=0,o=t.length;n<o;n++)e(t[n],n,t);else for(var r in t)t.hasOwnProperty(r)&&e(t[r],r,t)}function u(t,e){var n=[];return null==t?n:Array.prototype.map&&t.map===Array.prototype.map?t.map(e):(a(t,(function(t,o,r){n.push(e(t,o,r))})),n)}function c(t){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/fingerprintjs/fingerprintjs#upgrade-guide-from-182-to-200")}void 0===Array.isArray&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var l={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,adBlock:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},p=function(t){if(null==navigator.plugins)return t.NOT_AVAILABLE;for(var e=[],n=0,o=navigator.plugins.length;n<o;n++)navigator.plugins[n]&&e.push(navigator.plugins[n]);return h(t)&&(e=e.sort((function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}))),u(e,(function(t){var e=u(t,(function(t){return[t.type,t.suffixes]}));return[t.name,t.description,e]}))},h=function(t){for(var e=!1,n=0,o=t.plugins.sortPluginsFor.length;n<o;n++){var r=t.plugins.sortPluginsFor[n];if(navigator.userAgent.match(r)){e=!0;break}}return e},d=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},f=function(){if(!d()||!window.WebGLRenderingContext)return!1;var t=g();if(t){try{_(t)}catch(t){}return!0}return!1},m=function(){return 2<=("msWriteProfilerMark"in window)+("msLaunchUri"in navigator)+("msSaveBlob"in navigator)},g=function(){var t=document.createElement("canvas"),e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(t){}return e||null},_=function(t){var e=t.getExtension("WEBGL_lose_context");null!=e&&e.loseContext()},v=[{key:"userAgent",getData:function(t){t(navigator.userAgent)}},{key:"webdriver",getData:function(t,e){t(null==navigator.webdriver?e.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(t,e){t(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||e.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(t,e){t(window.screen.colorDepth||e.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(t,e){t(navigator.deviceMemory||e.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(t,e){t(window.devicePixelRatio||e.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(t,e){t(function(t){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:t.NOT_AVAILABLE}(e))}},{key:"screenResolution",getData:function(t,e){t(function(t){var e=[window.screen.width,window.screen.height];return t.screen.detectScreenOrientation&&e.sort().reverse(),e}(e))}},{key:"availableScreenResolution",getData:function(t,e){t(function(t){if(window.screen.availWidth&&window.screen.availHeight){var e=[window.screen.availHeight,window.screen.availWidth];return t.screen.detectScreenOrientation&&e.sort().reverse(),e}return t.NOT_AVAILABLE}(e))}},{key:"timezoneOffset",getData:function(t){t((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(t,e){window.Intl&&window.Intl.DateTimeFormat?t((new window.Intl.DateTimeFormat).resolvedOptions().timeZone||e.NOT_AVAILABLE):t(e.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(t,e){t(function(t){try{return!!window.sessionStorage}catch(e){return t.ERROR}}(e))}},{key:"localStorage",getData:function(t,e){t(function(t){try{return!!window.localStorage}catch(e){return t.ERROR}}(e))}},{key:"indexedDb",getData:function(t,e){t(function(t){if(m())return t.EXCLUDED;try{return!!window.indexedDB}catch(e){return t.ERROR}}(e))}},{key:"addBehavior",getData:function(t){t(!!window.HTMLElement.prototype.addBehavior)}},{key:"openDatabase",getData:function(t){t(!!window.openDatabase)}},{key:"cpuClass",getData:function(t,e){t(function(t){return navigator.cpuClass||t.NOT_AVAILABLE}(e))}},{key:"platform",getData:function(t,e){t(function(t){return navigator.platform?navigator.platform:t.NOT_AVAILABLE}(e))}},{key:"doNotTrack",getData:function(t,e){t(function(t){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:t.NOT_AVAILABLE}(e))}},{key:"plugins",getData:function(t,e){"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?e.plugins.excludeIE?t(e.EXCLUDED):t(function(t){var e=[];return Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?e=u(["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],(function(e){try{return new window.ActiveXObject(e),e}catch(e){return t.ERROR}})):e.push(t.NOT_AVAILABLE),navigator.plugins&&(e=e.concat(p(t))),e}(e)):t(p(e))}},{key:"canvas",getData:function(t,e){d()?t(function(t){var e=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var o=n.getContext("2d");return o.rect(0,0,10,10),o.rect(2,2,6,6),e.push("canvas winding:"+(!1===o.isPointInPath(5,5,"evenodd")?"yes":"no")),o.textBaseline="alphabetic",o.fillStyle="#f60",o.fillRect(125,1,62,20),o.fillStyle="#069",t.dontUseFakeFontInCanvas?o.font="11pt Arial":o.font="11pt no-real-font-123",o.fillText("Cwm fjordbank glyphs vext quiz, ????",2,15),o.fillStyle="rgba(102, 204, 0, 0.2)",o.font="18pt Arial",o.fillText("Cwm fjordbank glyphs vext quiz, ????",4,45),o.globalCompositeOperation="multiply",o.fillStyle="rgb(255,0,255)",o.beginPath(),o.arc(50,50,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(0,255,255)",o.beginPath(),o.arc(100,50,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(255,255,0)",o.beginPath(),o.arc(75,100,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(255,0,255)",o.arc(75,75,75,0,2*Math.PI,!0),o.arc(75,75,25,0,2*Math.PI,!0),o.fill("evenodd"),n.toDataURL&&e.push("canvas fp:"+n.toDataURL()),e}(e)):t(e.NOT_AVAILABLE)}},{key:"webgl",getData:function(t,e){f()?t(function(){function t(t){return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"}var e;if(!(e=g()))return null;try{var n=[],o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o);var r=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),o.itemSize=3,o.numItems=3;var i=e.createProgram(),s=e.createShader(e.VERTEX_SHADER);e.shaderSource(s,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),e.compileShader(s);var u=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(u,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),e.compileShader(u),e.attachShader(i,s),e.attachShader(i,u),e.linkProgram(i),e.useProgram(i),i.vertexPosAttrib=e.getAttribLocation(i,"attrVertex"),i.offsetUniform=e.getUniformLocation(i,"uniformOffset"),e.enableVertexAttribArray(i.vertexPosArray),e.vertexAttribPointer(i.vertexPosAttrib,o.itemSize,e.FLOAT,!1,0,0),e.uniform2f(i.offsetUniform,1,1),e.drawArrays(e.TRIANGLE_STRIP,0,o.numItems);try{n.push(e.canvas.toDataURL())}catch(t){}n.push("extensions:"+(e.getSupportedExtensions()||[]).join(";")),n.push("webgl aliased line width range:"+t(e.getParameter(e.ALIASED_LINE_WIDTH_RANGE))),n.push("webgl aliased point size range:"+t(e.getParameter(e.ALIASED_POINT_SIZE_RANGE))),n.push("webgl alpha bits:"+e.getParameter(e.ALPHA_BITS)),n.push("webgl antialiasing:"+(e.getContextAttributes().antialias?"yes":"no")),n.push("webgl blue bits:"+e.getParameter(e.BLUE_BITS)),n.push("webgl depth bits:"+e.getParameter(e.DEPTH_BITS)),n.push("webgl green bits:"+e.getParameter(e.GREEN_BITS)),n.push("webgl max anisotropy:"+function(t){var e=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic");if(e){var n=t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===n&&(n=2),n}return null}(e)),n.push("webgl max combined texture image units:"+e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),n.push("webgl max cube map texture size:"+e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE)),n.push("webgl max fragment uniform vectors:"+e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS)),n.push("webgl max render buffer size:"+e.getParameter(e.MAX_RENDERBUFFER_SIZE)),n.push("webgl max texture image units:"+e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),n.push("webgl max texture size:"+e.getParameter(e.MAX_TEXTURE_SIZE)),n.push("webgl max varying vectors:"+e.getParameter(e.MAX_VARYING_VECTORS)),n.push("webgl max vertex attribs:"+e.getParameter(e.MAX_VERTEX_ATTRIBS)),n.push("webgl max vertex texture image units:"+e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),n.push("webgl max vertex uniform vectors:"+e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS)),n.push("webgl max viewport dims:"+t(e.getParameter(e.MAX_VIEWPORT_DIMS))),n.push("webgl red bits:"+e.getParameter(e.RED_BITS)),n.push("webgl renderer:"+e.getParameter(e.RENDERER)),n.push("webgl shading language version:"+e.getParameter(e.SHADING_LANGUAGE_VERSION)),n.push("webgl stencil bits:"+e.getParameter(e.STENCIL_BITS)),n.push("webgl vendor:"+e.getParameter(e.VENDOR)),n.push("webgl version:"+e.getParameter(e.VERSION));try{var c=e.getExtension("WEBGL_debug_renderer_info");c&&(n.push("webgl unmasked vendor:"+e.getParameter(c.UNMASKED_VENDOR_WEBGL)),n.push("webgl unmasked renderer:"+e.getParameter(c.UNMASKED_RENDERER_WEBGL)))}catch(t){}return e.getShaderPrecisionFormat&&a(["FLOAT","INT"],(function(t){a(["VERTEX","FRAGMENT"],(function(o){a(["HIGH","MEDIUM","LOW"],(function(r){a(["precision","rangeMin","rangeMax"],(function(i){var s=e.getShaderPrecisionFormat(e[o+"_SHADER"],e[r+"_"+t])[i];"precision"!==i&&(i="precision "+i);var a=["webgl ",o.toLowerCase()," shader ",r.toLowerCase()," ",t.toLowerCase()," ",i,":",s].join("");n.push(a)}))}))}))})),n}finally{try{_(e)}catch(t){}}}()):t(e.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(t){f()?t(function(){try{var t=g(),e=t.getExtension("WEBGL_debug_renderer_info");return t.getParameter(e.UNMASKED_VENDOR_WEBGL)+"~"+t.getParameter(e.UNMASKED_RENDERER_WEBGL)}catch(t){return null}finally{try{_(t)}catch(t){}}}()):t()}},{key:"adBlock",getData:function(t){t(function(){var t=document.createElement("div");t.innerHTML="&nbsp;";var e=!(t.className="adsbox");try{document.body.appendChild(t),e=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(t)}catch(t){e=!1}return e}())}},{key:"hasLiedLanguages",getData:function(t){t(function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(t){return!0}return!1}())}},{key:"hasLiedResolution",getData:function(t){t(window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight)}},{key:"hasLiedOs",getData:function(t){t(function(){var t,e=navigator.userAgent.toLowerCase(),n=navigator.oscpu,o=navigator.platform.toLowerCase();if(t=0<=e.indexOf("windows phone")?"Windows Phone":0<=e.indexOf("windows")||0<=e.indexOf("win16")||0<=e.indexOf("win32")||0<=e.indexOf("win64")||0<=e.indexOf("win95")||0<=e.indexOf("win98")||0<=e.indexOf("winnt")||0<=e.indexOf("wow64")?"Windows":0<=e.indexOf("android")?"Android":0<=e.indexOf("linux")||0<=e.indexOf("cros")||0<=e.indexOf("x11")?"Linux":0<=e.indexOf("iphone")||0<=e.indexOf("ipad")||0<=e.indexOf("ipod")||0<=e.indexOf("crios")||0<=e.indexOf("fxios")?"iOS":0<=e.indexOf("macintosh")||0<=e.indexOf("mac_powerpc)")?"Mac":"Other",("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints)&&"Windows"!==t&&"Windows Phone"!==t&&"Android"!==t&&"iOS"!==t&&"Other"!==t&&-1===e.indexOf("cros"))return!0;if(void 0!==n){if(0<=(n=n.toLowerCase()).indexOf("win")&&"Windows"!==t&&"Windows Phone"!==t)return!0;if(0<=n.indexOf("linux")&&"Linux"!==t&&"Android"!==t)return!0;if(0<=n.indexOf("mac")&&"Mac"!==t&&"iOS"!==t)return!0;if((-1===n.indexOf("win")&&-1===n.indexOf("linux")&&-1===n.indexOf("mac"))!=("Other"===t))return!0}return 0<=o.indexOf("win")&&"Windows"!==t&&"Windows Phone"!==t||(0<=o.indexOf("linux")||0<=o.indexOf("android")||0<=o.indexOf("pike"))&&"Linux"!==t&&"Android"!==t||(0<=o.indexOf("mac")||0<=o.indexOf("ipad")||0<=o.indexOf("ipod")||0<=o.indexOf("iphone"))&&"Mac"!==t&&"iOS"!==t||!(0<=o.indexOf("arm")&&"Windows Phone"===t)&&!(0<=o.indexOf("pike")&&0<=e.indexOf("opera mini"))&&((o.indexOf("win")<0&&o.indexOf("linux")<0&&o.indexOf("mac")<0&&o.indexOf("iphone")<0&&o.indexOf("ipad")<0&&o.indexOf("ipod")<0)!=("Other"===t)||void 0===navigator.plugins&&"Windows"!==t&&"Windows Phone"!==t)}())}},{key:"hasLiedBrowser",getData:function(t){t(function(){var t,e=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(0<=e.indexOf("edge/")||0<=e.indexOf("iemobile/"))return!1;if(0<=e.indexOf("opera mini"))return!1;if(("Chrome"==(t=0<=e.indexOf("firefox/")?"Firefox":0<=e.indexOf("opera/")||0<=e.indexOf(" opr/")?"Opera":0<=e.indexOf("chrome/")?"Chrome":0<=e.indexOf("safari/")?0<=e.indexOf("android 1.")||0<=e.indexOf("android 2.")||0<=e.indexOf("android 3.")||0<=e.indexOf("android 4.")?"AOSP":"Safari":0<=e.indexOf("trident/")?"Internet Explorer":"Other")||"Safari"===t||"Opera"===t)&&"20030107"!==n)return!0;var o,r=eval.toString().length;if(37===r&&"Safari"!==t&&"Firefox"!==t&&"Other"!==t)return!0;if(39===r&&"Internet Explorer"!==t&&"Other"!==t)return!0;if(33===r&&"Chrome"!==t&&"AOSP"!==t&&"Opera"!==t&&"Other"!==t)return!0;try{throw"a"}catch(t){try{t.toSource(),o=!0}catch(t){o=!1}}return o&&"Firefox"!==t&&"Other"!==t}())}},{key:"touchSupport",getData:function(t){t(function(){var t,e=0;void 0!==navigator.maxTouchPoints?e=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(e=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),t=!0}catch(e){t=!1}return[e,t,"ontouchstart"in window]}())}},{key:"fonts",getData:function(t,e){var n=["monospace","sans-serif","serif"],o=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];function r(){var t=document.createElement("span");return t.style.position="absolute",t.style.left="-9999px",t.style.fontSize="72px",t.style.fontStyle="normal",t.style.fontWeight="normal",t.style.letterSpacing="normal",t.style.lineBreak="auto",t.style.lineHeight="normal",t.style.textTransform="none",t.style.textAlign="left",t.style.textDecoration="none",t.style.textShadow="none",t.style.whiteSpace="normal",t.style.wordBreak="normal",t.style.wordSpacing="normal",t.innerHTML="mmmmmmmmmmlli",t}function i(t){for(var e=!1,o=0;o<n.length;o++)if(e=t[o].offsetWidth!==c[n[o]]||t[o].offsetHeight!==l[n[o]])return e;return e}e.fonts.extendedJsFonts&&(o=o.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"])),o=(o=o.concat(e.fonts.userDefinedFonts)).filter((function(t,e){return o.indexOf(t)===e}));var s=document.getElementsByTagName("body")[0],a=document.createElement("div"),u=document.createElement("div"),c={},l={},p=function(){for(var t=[],e=0,o=n.length;e<o;e++){var i=r();i.style.fontFamily=n[e],a.appendChild(i),t.push(i)}return t}();s.appendChild(a);for(var h=0,d=n.length;h<d;h++)c[n[h]]=p[h].offsetWidth,l[n[h]]=p[h].offsetHeight;var f=function(){for(var t,e,i,s={},a=0,c=o.length;a<c;a++){for(var l=[],p=0,h=n.length;p<h;p++){var d=(t=o[a],e=n[p],i=void 0,(i=r()).style.fontFamily="'"+t+"',"+e,i);u.appendChild(d),l.push(d)}s[o[a]]=l}return s}();s.appendChild(u);for(var m=[],g=0,_=o.length;g<_;g++)i(f[o[g]])&&m.push(o[g]);s.removeChild(u),s.removeChild(a),t(m)},pauseBefore:!0},{key:"audio",getData:function(t,e){var n=e.audio;if(n.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return t(e.EXCLUDED);var o=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==o)return t(e.NOT_AVAILABLE);var r=new o(1,44100,44100),i=r.createOscillator();i.type="triangle",i.frequency.setValueAtTime(1e4,r.currentTime);var s=r.createDynamicsCompressor();a([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],(function(t){void 0!==s[t[0]]&&"function"==typeof s[t[0]].setValueAtTime&&s[t[0]].setValueAtTime(t[1],r.currentTime)})),i.connect(s),s.connect(r.destination),i.start(0),r.startRendering();var u=setTimeout((function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/fingerprintjs/fingerprintjs with your user agent: "'+navigator.userAgent+'".'),r.oncomplete=function(){},r=null,t("audioTimeout")}),n.timeout);r.oncomplete=function(e){var n;try{clearTimeout(u),n=e.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce((function(t,e){return t+Math.abs(e)}),0).toString(),i.disconnect(),s.disconnect()}catch(e){return void t(e)}t(n)}}},{key:"enumerateDevices",getData:function(t,e){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return t(e.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then((function(e){t(e.map((function(t){return"id="+t.deviceId+";gid="+t.groupId+";"+t.kind+";"+t.label})))})).catch((function(e){t(e)}))}}];return c.get=function(t,e){(function(t,e){var n,o;if(null!=e)for(o in e)null==(n=e[o])||Object.prototype.hasOwnProperty.call(t,o)||(t[o]=n)})(t=e?t||{}:(e=t,{}),l),t.components=t.extraComponents.concat(v);var n={data:[],addPreprocessedComponent:function(e,o){"function"==typeof t.preprocessor&&(o=t.preprocessor(e,o)),n.data.push({key:e,value:o})}},o=-1;!function r(i){if((o+=1)>=t.components.length)e(n.data);else{var s=t.components[o];if(t.excludes[s.key])r(!1);else{if(!i&&s.pauseBefore)return--o,void setTimeout((function(){r(!0)}),1);try{s.getData((function(t){n.addPreprocessedComponent(s.key,t),r(!1)}),t)}catch(i){n.addPreprocessedComponent(s.key,String(i)),r(!1)}}}}(!1)},c.getPromise=function(t){return new Promise((function(e,n){c.get(t,e)}))},c.getV18=function(t,e){return null==e&&(e=t,t={}),c.get(t,(function(n){for(var o=[],r=0;r<n.length;r++){var i=n[r];if(i.value===(t.NOT_AVAILABLE||"not available"))o.push({key:i.key,value:"unknown"});else if("plugins"===i.key)o.push({key:"plugins",value:u(i.value,(function(t){var e=u(t[2],(function(t){return t.join?t.join("~"):t})).join(",");return[t[0],t[1],e].join("::")}))});else if(-1!==["canvas","webgl"].indexOf(i.key)&&Array.isArray(i.value))o.push({key:i.key,value:i.value.join("~")});else if(-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(i.key)){if(!i.value)continue;o.push({key:i.key,value:1})}else i.value?o.push(i.value.join?{key:i.key,value:i.value.join(";")}:i):o.push({key:i.key,value:i.value})}var a=s(u(o,(function(t){return t.value})).join("~~~"),31);e(a,o)}))},c.x64hash128=s,c.VERSION="2.1.5",c}))})),_=m((function(t,n){
/*!@license
     * UAParser.js v0.7.28
     * Lightweight JavaScript-based User-Agent string parser
     * https://github.com/faisalman/ua-parser-js
     *
     * Copyright ?? 2012-2021 Faisal Salman <f@faisalman.com>
     * Licensed under MIT License
     */
!function(o,r){var i="model",s="name",a="type",u="vendor",c="version",l="mobile",p="tablet",h="smarttv",d={extend:function(t,e){var n={};for(var o in t)e[o]&&e[o].length%2==0?n[o]=e[o].concat(t[o]):n[o]=t[o];return n},has:function(t,n){return"string"===e(t)&&-1!==n.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"===e(t)?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t,n){return t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),"undefined"===e(n)?t:t.substring(0,255)}},f={rgx:function(t,n){for(var o,r,i,s,a,u,c=0;c<n.length&&!a;){var l=n[c],p=n[c+1];for(o=r=0;o<l.length&&!a;)if(a=l[o++].exec(t))for(i=0;i<p.length;i++)u=a[++r],"object"===e(s=p[i])&&s.length>0?2==s.length?"function"==e(s[1])?this[s[0]]=s[1].call(this,u):this[s[0]]=s[1]:3==s.length?"function"!==e(s[1])||s[1].exec&&s[1].test?this[s[0]]=u?u.replace(s[1],s[2]):void 0:this[s[0]]=u?s[1].call(this,u,s[2]):void 0:4==s.length&&(this[s[0]]=u?s[3].call(this,u.replace(s[1],s[2])):void 0):this[s]=u||void 0;c+=2}},str:function(t,n){for(var o in n)if("object"===e(n[o])&&n[o].length>0){for(var r=0;r<n[o].length;r++)if(d.has(n[o][r],t))return"?"===o?void 0:o}else if(d.has(n[o],t))return"?"===o?void 0:o;return t}},m={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},g={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[s,"Chrome"]],[/(?:edge|edgios|edga|edg)\/([\w\.]+)/i],[c,[s,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[s,c],[/opios[\/\s]+([\w\.]+)/i],[c,[s,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[c,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,c],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[c,[s,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[c,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[s,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[c,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],c],[/focus\/([\w\.]+)/i],[c,[s,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[c,[s,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[c,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[s,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[s,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[c,[s,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],c],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[s,c],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[s],[/;fbav\/([\w\.]+);/i],[c,[s,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[s,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[s,c],[/\bgsa\/([\w\.]+)\s.*safari\//i],[c,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[c,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],c],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[c,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,c],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[c,[s,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[c,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[c,f.str,m.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[s,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],c],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[c,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[i,[u,"Samsung"],[a,p]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[i,[u,"Samsung"],[a,l]],[/\((ip(?:hone|od)[\s\w]*);/i],[i,[u,"Apple"],[a,l]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[u,"Apple"],[a,p]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[i,[u,"Huawei"],[a,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[i,[u,"Huawei"],[a,l]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[i,/_/g," "],[u,"Xiaomi"],[a,l]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[i,/_/g," "],[u,"Xiaomi"],[a,p]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[i,[u,"OPPO"],[a,l]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[i,[u,"Vivo"],[a,l]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[i,[u,"Realme"],[a,l]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[i,[u,"Motorola"],[a,l]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[u,"Motorola"],[a,p]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[i,[u,"LG"],[a,p]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[i,[u,"LG"],[a,l]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[i,[u,"Lenovo"],[a,p]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[i,/_/g," "],[u,"Nokia"],[a,l]],[/droid.+;\s(pixel\sc)[\s)]/i],[i,[u,"Google"],[a,p]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[i,[u,"Google"],[a,l]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[u,"Sony"],[a,l]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[i,"Xperia Tablet"],[u,"Sony"],[a,p]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[i,[u,"OnePlus"],[a,l]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[i,[u,"Amazon"],[a,p]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[i,"Fire Phone"],[u,"Amazon"],[a,l]],[/\((playbook);[\w\s\),;-]+(rim)/i],[i,u,[a,p]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[i,[u,"BlackBerry"],[a,l]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[i,[u,"ASUS"],[a,p]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[i,[u,"ASUS"],[a,l]],[/(nexus\s9)/i],[i,[u,"HTC"],[a,p]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[u,[i,/_/g," "],[a,l]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[u,"Acer"],[a,p]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[i,[u,"Meizu"],[a,l]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,i,[a,l]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[u,i,[a,p]],[/\s(surface\sduo)\s/i],[i,[u,"Microsoft"],[a,p]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[i,[u,"Fairphone"],[a,l]],[/\s(u304aa)\sbuild/i],[i,[u,"AT&T"],[a,l]],[/sie-(\w*)/i],[i,[u,"Siemens"],[a,l]],[/[;\/]\s?(rct\w+)\sbuild/i],[i,[u,"RCA"],[a,p]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[i,[u,"Dell"],[a,p]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[i,[u,"Verizon"],[a,p]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[i,[u,"Barnes & Noble"],[a,p]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[i,[u,"NuVision"],[a,p]],[/;\s(k88)\sbuild/i],[i,[u,"ZTE"],[a,p]],[/;\s(nx\d{3}j)\sbuild/i],[i,[u,"ZTE"],[a,l]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[i,[u,"Swiss"],[a,l]],[/[;\/]\s?(zur\d{3})\sbuild/i],[i,[u,"Swiss"],[a,p]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[i,[u,"Zeki"],[a,p]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[u,"Dragon Touch"],i,[a,p]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[i,[u,"Insignia"],[a,p]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[i,[u,"NextBook"],[a,p]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[u,"Voice"],i,[a,l]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[u,"LvTel"],i,[a,l]],[/;\s(ph-1)\s/i],[i,[u,"Essential"],[a,l]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[i,[u,"Envizen"],[a,p]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[i,[u,"MachSpeed"],[a,p]],[/[;\/]\s?tu_(1491)\sbuild/i],[i,[u,"Rotor"],[a,p]],[/(shield[\w\s]+)\sbuild/i],[i,[u,"Nvidia"],[a,p]],[/(sprint)\s(\w+)/i],[u,i,[a,l]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[u,"Microsoft"],[a,l]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[u,"Zebra"],[a,p]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[u,"Zebra"],[a,l]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[u,i,[a,"console"]],[/droid.+;\s(shield)\sbuild/i],[i,[u,"Nvidia"],[a,"console"]],[/(playstation\s[345portablevi]+)/i],[i,[u,"Sony"],[a,"console"]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[i,[u,"Microsoft"],[a,"console"]],[/smart-tv.+(samsung)/i],[u,[a,h]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[u,"Samsung"],[a,h]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[u,"LG"],[a,h]],[/(apple)\s?tv/i],[u,[i,"Apple TV"],[a,h]],[/crkey/i],[[i,"Chromecast"],[u,"Google"],[a,h]],[/droid.+aft([\w])(\sbuild\/|\))/i],[i,[u,"Amazon"],[a,h]],[/\(dtv[\);].+(aquos)/i],[i,[u,"Sharp"],[a,h]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,d.trim],[i,d.trim],[a,h]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[a,h]],[/((pebble))app\/[\d\.]+\s/i],[u,i,[a,"wearable"]],[/droid.+;\s(glass)\s\d/i],[i,[u,"Google"],[a,"wearable"]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[i,[u,"Zebra"],[a,"wearable"]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[u,[a,"embedded"]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[i,[a,l]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[i,[a,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[a,d.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[u,"Generic"]],[/(phone)/i],[[a,l]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[s,[c,f.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[c,f.str,m.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[s,"Mac OS"],[c,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[s,c],[/\(bb(10);/i],[c,[s,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[c,[s,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[s,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[s,c],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],c],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[s,c]]},_=function t(n,r){if("object"===e(n)&&(r=n,n=void 0),!(this instanceof t))return new t(n,r).getResult();var i=n||(void 0!==o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),s=r?d.extend(g,r):g;return this.getBrowser=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,i,s.browser),t.major=d.major(t.version),t},this.getCPU=function(){var t={architecture:void 0};return f.rgx.call(t,i,s.cpu),t},this.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return f.rgx.call(t,i,s.device),t},this.getEngine=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,i,s.engine),t},this.getOS=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,i,s.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(t){return i="string"===e(t)&&t.length>255?d.trim(t,255):t,this},this.setUA(i),this};_.VERSION="0.7.28",_.BROWSER={NAME:s,MAJOR:"major",VERSION:c},_.CPU={ARCHITECTURE:"architecture"},_.DEVICE={MODEL:i,VENDOR:u,TYPE:a,CONSOLE:"console",MOBILE:l,SMARTTV:h,TABLET:p,WEARABLE:"wearable",EMBEDDED:"embedded"},_.ENGINE={NAME:s,VERSION:c},_.OS={NAME:s,VERSION:c},t.exports&&(n=t.exports=_),n.UAParser=_;var v=void 0!==o&&(o.jQuery||o.Zepto);if(v&&!v.ua){var y=new _;v.ua=y.getResult(),v.ua.get=function(){return y.getUA()},v.ua.set=function(t){y.setUA(t);var e=y.getResult();for(var n in e)v.ua[n]=e[n]}}}("object"===("undefined"==typeof window?"undefined":e(window))?window:f)})),v=_.UAParser,y=Object.freeze({__proto__:null,default:_,__moduleExports:_,UAParser:v}),A=void 0,b=void 0;function S(t){var e={allow:!1,timeout:4e3,maximumAge:18e4},n=void 0,o=function(){n=void 0},r=function(t,e){var n={};for(var o in e=e||{},t=t||{})n[o]=t[o];for(var o in e)n[o]=e[o];return n},i=function(e,n,o){if(A)d(e,o);else{var r={excludes:{userAgent:!0,screenResolution:!0,fonts:!0,fontsFlash:!0,plugins:!0,colorDepth:!0,webdriver:!0,audio:!0,deviceMemory:!0,enumerateDevices:!0,timezone:!0,webglVendorAndRenderer:!0}};t.largeData||(r.excludes.canvas=!0,r.excludes.webgl=!0),n.getV18(r,(function(t,n){var r=s(n);A={id:t,details:r},d(e,o)}))}},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=t||[];for(var n={},o=0;o<t.length;o++){var r=t[o],i=r.key;e&&(i=a(i)),n[i]=r.value}return n},a=function(t){return t.replace(/[\w]([A-Z])/g,(function(t){return t[0]+"_"+t[1]})).toLowerCase()},u=function(e,n,o){if(b)d(e,o);else{var r={excludes:{}};t.largeData||(r.excludes.canvas=!0,r.excludes.webgl=!0),t.deviceFingerprint||(r.excludes.screenResolution=!0,r.excludes.fonts=!0,r.excludes.fontsFlash=!0,r.excludes.plugins=!0,r.excludes.colorDepth=!0,r.excludes.webdriver=!0,r.excludes.audio=!0,r.excludes.deviceMemory=!0,r.excludes.enumerateDevices=!0,r.excludes.timezone=!0,r.excludes.webglVendorAndRenderer=!0),n.get(r,(function(t){b=s(t,!0),d(e,o)}))}},c=function(e,o){n=void 0;var r=t.location;if(!r.allow)return h(!1),void d(e,o);if(l(navigator.geolocation)||"function"!=typeof navigator.geolocation.getCurrentPosition)return h(!1),void d(e,o);var i=setTimeout((function(){s({code:3})}),r.timeout),s=function(t){clearTimeout(i),h(!0,void 0,void 0,p(t.code)),d(e,o)};navigator.geolocation.getCurrentPosition((function(t){clearTimeout(i),h(!0,t.coords.latitude,t.coords.longitude),d(e,o)}),s,r)},l=function(t){return null==t},p=function(t){return 1===t?"permission_denied":2===t?"position_unavailable":3===t?"timeout":"unknown"};function h(t,e,o,r){n={enabled:t||!1,lat:e,lng:o,error:r}}var d=function(t,e){if(!(l(b)||l(A)||l(n))){var r={metadata:{timestamp:Date.now()},content:{device_details:f(A,e),location:n},fp2:b};o(),t(r)}},f=function(t,e){var n={device_id:t.id},o=t.details,r=(new e.UAParser).setUA(navigator.userAgent).getResult();return n.os_type=r.os.name,n.os_version=r.os.version,n.device_model=r.browser.name+" "+r.browser.version,n.device_platform=o.navigator_platform,n.tampered=function(t){return t&&(t.has_lied_browser||t.has_lied_language||t.has_lied_os||t.has_lied_resolution)}(o),n.timezone_offset=o.timezone_offset,n};return(t=t||{}).location=r(e,t.location),o(),{get:function(t){i(t,g,y),u(t,g,y),c(t,y)}}}function I(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function C(t,e,n,o,r,i){return I((s=I(I(e,t),I(o,i)))<<(a=r)|s>>>32-a,n);var s,a}function k(t,e,n,o,r,i,s){return C(e&n|~e&o,t,e,r,i,s)}function E(t,e,n,o,r,i,s){return C(e&o|n&~o,t,e,r,i,s)}function w(t,e,n,o,r,i,s){return C(e^n^o,t,e,r,i,s)}function R(t,e,n,o,r,i,s){return C(n^(e|~o),t,e,r,i,s)}function P(t,e){var n,o,r,i,s;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var a=1732584193,u=-271733879,c=-1732584194,l=271733878;for(n=0;n<t.length;n+=16)o=a,r=u,i=c,s=l,a=k(a,u,c,l,t[n],7,-680876936),l=k(l,a,u,c,t[n+1],12,-389564586),c=k(c,l,a,u,t[n+2],17,606105819),u=k(u,c,l,a,t[n+3],22,-1044525330),a=k(a,u,c,l,t[n+4],7,-176418897),l=k(l,a,u,c,t[n+5],12,1200080426),c=k(c,l,a,u,t[n+6],17,-1473231341),u=k(u,c,l,a,t[n+7],22,-45705983),a=k(a,u,c,l,t[n+8],7,1770035416),l=k(l,a,u,c,t[n+9],12,-1958414417),c=k(c,l,a,u,t[n+10],17,-42063),u=k(u,c,l,a,t[n+11],22,-1990404162),a=k(a,u,c,l,t[n+12],7,1804603682),l=k(l,a,u,c,t[n+13],12,-40341101),c=k(c,l,a,u,t[n+14],17,-1502002290),a=E(a,u=k(u,c,l,a,t[n+15],22,1236535329),c,l,t[n+1],5,-165796510),l=E(l,a,u,c,t[n+6],9,-1069501632),c=E(c,l,a,u,t[n+11],14,643717713),u=E(u,c,l,a,t[n],20,-373897302),a=E(a,u,c,l,t[n+5],5,-701558691),l=E(l,a,u,c,t[n+10],9,38016083),c=E(c,l,a,u,t[n+15],14,-660478335),u=E(u,c,l,a,t[n+4],20,-405537848),a=E(a,u,c,l,t[n+9],5,568446438),l=E(l,a,u,c,t[n+14],9,-1019803690),c=E(c,l,a,u,t[n+3],14,-187363961),u=E(u,c,l,a,t[n+8],20,1163531501),a=E(a,u,c,l,t[n+13],5,-1444681467),l=E(l,a,u,c,t[n+2],9,-51403784),c=E(c,l,a,u,t[n+7],14,1735328473),a=w(a,u=E(u,c,l,a,t[n+12],20,-1926607734),c,l,t[n+5],4,-378558),l=w(l,a,u,c,t[n+8],11,-2022574463),c=w(c,l,a,u,t[n+11],16,1839030562),u=w(u,c,l,a,t[n+14],23,-35309556),a=w(a,u,c,l,t[n+1],4,-1530992060),l=w(l,a,u,c,t[n+4],11,1272893353),c=w(c,l,a,u,t[n+7],16,-155497632),u=w(u,c,l,a,t[n+10],23,-1094730640),a=w(a,u,c,l,t[n+13],4,681279174),l=w(l,a,u,c,t[n],11,-358537222),c=w(c,l,a,u,t[n+3],16,-722521979),u=w(u,c,l,a,t[n+6],23,76029189),a=w(a,u,c,l,t[n+9],4,-640364487),l=w(l,a,u,c,t[n+12],11,-421815835),c=w(c,l,a,u,t[n+15],16,530742520),a=R(a,u=w(u,c,l,a,t[n+2],23,-995338651),c,l,t[n],6,-198630844),l=R(l,a,u,c,t[n+7],10,1126891415),c=R(c,l,a,u,t[n+14],15,-1416354905),u=R(u,c,l,a,t[n+5],21,-57434055),a=R(a,u,c,l,t[n+12],6,1700485571),l=R(l,a,u,c,t[n+3],10,-1894986606),c=R(c,l,a,u,t[n+10],15,-1051523),u=R(u,c,l,a,t[n+1],21,-2054922799),a=R(a,u,c,l,t[n+8],6,1873313359),l=R(l,a,u,c,t[n+15],10,-30611744),c=R(c,l,a,u,t[n+6],15,-1560198380),u=R(u,c,l,a,t[n+13],21,1309151649),a=R(a,u,c,l,t[n+4],6,-145523070),l=R(l,a,u,c,t[n+11],10,-1120210379),c=R(c,l,a,u,t[n+2],15,718787259),u=R(u,c,l,a,t[n+9],21,-343485551),a=I(a,o),u=I(u,r),c=I(c,i),l=I(l,s);return[a,u,c,l]}function D(t){var e,n="",o=32*t.length;for(e=0;e<o;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function T(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var o=8*t.length;for(e=0;e<o;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function F(t){var e,n,o="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),o+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return o}function L(t){return unescape(encodeURIComponent(t))}function x(t){return function(t){return D(P(T(t),8*t.length))}(L(t))}function O(t,e){return function(t,e){var n,o,r=T(t),i=[],s=[];for(i[15]=s[15]=void 0,r.length>16&&(r=P(r,8*t.length)),n=0;n<16;n+=1)i[n]=909522486^r[n],s[n]=1549556828^r[n];return o=P(i.concat(T(e)),512+8*e.length),D(P(s.concat(o),640))}(L(t),L(e))}function q(t,e,n){return e?n?O(e,t):F(O(e,t)):n?x(t):F(x(t))}var N=function(){function t(){n(this,t),this.locales={}}return r(t,[{key:"getString",value:function(t,e){var n=e||"en-US",o=this.locales[n];return o&&o.hasOwnProperty(t)?o[t]:t}},{key:"addDictionary",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=this.locales[e]||{},o=Object.assign(n,t);this.locales[e]=o}}]),t}(),U=function(){function t(e,o){n(this,t),this.navi=navigator,this.opType=e,this.options=o}return r(t,[{key:"b64Encode",value:function(t){for(var e="",n=new Uint8Array(t),o=n.byteLength,r=0;r<o;r++)e+=String.fromCharCode(n[r]);return window.btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},{key:"b64Decode",value:function(t){for(var e=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,""),n=window.atob(e),o=n.length,r=new Uint8Array(o),i=0;i<o;i++)r[i]=n.charCodeAt(i);return r.buffer}},{key:"publicKeyCredentialToJSON",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;if(t instanceof ArrayBuffer)return this.b64Encode(t);if(e<=0)return t;if(t instanceof Array){var n=[],o=!0,r=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(o=(s=a.next()).done);o=!0){var u=s.value;n.push(this.publicKeyCredentialToJSON(u),e-1)}}catch(t){r=!0,i=t}finally{try{o||null==a.return||a.return()}finally{if(r)throw i}}return n}if(t instanceof Object){var c={};for(var l in t)"function"!=typeof t[l]&&(c[l]=this.publicKeyCredentialToJSON(t[l],e-1));return c}return t}},{key:"execute",value:function(){var t,e=this,n=JSON.parse(JSON.stringify(this.options));switch(this.opType){case com.ts.mobile.sdkhost.Fido2CredentialsOpType.Create:n.publicKey.challenge=this.b64Decode(n.publicKey.challenge),n.publicKey.user.id=this.b64Decode(n.publicKey.user.id),n.publicKey.excludeCredentials.map((function(t){return t.id=e.b64Decode(t.id),t})),t=this.navi.credentials.create(n).then((function(t){t.clientExtensionResults=t.getClientExtensionResults();var n=t.response&&t.response.getTransports&&t.response.getTransports(),o=e.publicKeyCredentialToJSON(t);return n&&n.length>0&&(o.response.transports=n),o}));break;case com.ts.mobile.sdkhost.Fido2CredentialsOpType.Get:n.publicKey.challenge=this.b64Decode(n.publicKey.challenge);var o=!0,r=!1,i=void 0;try{for(var s,a=n.publicKey.allowCredentials[Symbol.iterator]();!(o=(s=a.next()).done);o=!0){var u=s.value;u.id=this.b64Decode(u.id)}}catch(t){r=!0,i=t}finally{try{o||null==a.return||a.return()}finally{if(r)throw i}}t=this.navi.credentials.get(n).then((function(t){return t.clientExtensionResults=t.getClientExtensionResults(),e.publicKeyCredentialToJSON(t)}))}return t=t.catch((function(t){throw M.indexOf(t.name)>-1?new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.UserCanceled,"Received FIDO2 cancellation request from platform; Error: ".concat(t)):t}))}}]),t}(),M=["NotAllowedError","AbortError"],K=function(){function t(e,o,r,i,s){n(this,t),this._tag=e,this._keyClass=o,this._protection=r,this._keyData=i,this._keyStore=s}return r(t,[{key:"getKeyClass",value:function(){return this._keyClass}},{key:"getTag",value:function(){return this._tag}},{key:"getBioProtected",value:function(){return this._protection}},{key:"setBiometricPromptInfo",value:function(t,e,n){}},{key:"signHex",value:function(t){return this._keyStore.signWithKeyPair(this._tag,this._keyClass,t)}},{key:"encrypt",value:function(t){throw new Error("Method not implemented.")}},{key:"decrypt",value:function(t){throw new Error("Method not implemented.")}},{key:"unwrapAsymmetricKeyPairFromPrivateKeyHex",value:function(t,e){throw new Error("Method not implemented.")}},{key:"unwrapSymmetricKeyHex",value:function(t,e){throw new Error("Method not implemented.")}},{key:"wrapSymmetricKey",value:function(t){throw new Error("Method not implemented.")}},{key:"publicKeyToJson",value:function(){return this._keyData}},{key:"closeKeyPair",value:function(){throw new Error("Method not implemented.")}}]),t}(),B=function(){function t(e){n(this,t),this._host=e}return r(t,[{key:"generateKeyPair",value:function(t,e,n,o){var r=this,i=this.keyGenParamsForKeyClass(e);return this.generateKeyPairInternal(t,i,e,n,o).catch((function(i){if(r._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","Failed to generate key pair: ".concat(i)),i instanceof DOMException&&"DataCloneError"===i.name){var s=r.fallbackKeyGenParamsForKeyClass(e);return r.generateKeyPairInternal(t,s,e,n,o)}throw r._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","Failed to generate key pair: ".concat(i)),com.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(i)}))}},{key:"generateKeyPairInternal",value:function(t,e,n,o,r){var s=this;return new Promise((function(r,a){e||r(null),s.promiseLikeToPromise(crypto.subtle.generateKey(e.params,!1,s.keyUsagesForKeyClass(n))).then((function(u){return s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","key pair generated, now will validate private key is not exportable."),new Promise((function(t,e){s.promiseLikeToPromise(crypto.subtle.exportKey("pkcs8",u.privateKey)).then((function(t){var e="generated exportable private key";s._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",e);var n=new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,e),o={};throw o[com.ts.mobile.sdkhost.ErrorDataInternalError]=com.ts.mobile.sdkhost.InternalErrorCouldNotGenerateSecureKey,com.ts.mobile.sdk.impl.AuthenticationErrorImpl.augmentErrorData(n,o)})).catch((function(n){if(n instanceof com.ts.mobile.sdk.impl.AuthenticationErrorImpl&&e(n),!(n instanceof DOMException)||n instanceof DOMException&&"InvalidAccessError"!==n.name){var o="failed to verify private key is not exportable";s._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",o);var r=new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,o),i={};i[com.ts.mobile.sdkhost.ErrorDataInternalError]=com.ts.mobile.sdkhost.InternalErrorCouldNotGenerateSecureKey,e(com.ts.mobile.sdk.impl.AuthenticationErrorImpl.augmentErrorData(r,i))}t(!0)}))})).then((function(r){return s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","generate key pair success"),s.promiseLikeToPromise(crypto.subtle.exportKey("spki",u.publicKey)).then((function(r){s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","export key pair success");var c=s._db.transaction("keystore","readwrite");c.oncomplete=function(t){s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","object store transaction complete")},c.onerror=function(t){var e="object store transaction failed: ".concat(c.error.message);s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",e),a(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,e))};var l=c.objectStore("keystore");try{var p=l.add({tag:t,key:u.privateKey});return s.promiseRequestResult(p).then((function(a){s._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","add key pair success");var u=btoa(String.fromCharCode.apply(String,i(new Uint8Array(r))));return s.savePublicKeyData(t,u,e.keyType),new K(t,n,o,{type:e.keyType,key:u},s)}))}catch(t){throw s._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to add record to db: ".concat(t)),t}}))})).catch((function(t){throw s._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to generate key pair: ".concat(t)),t})).then(r,a)}))}))}},{key:"getKeyPair",value:function(t,e,n){var o=this.getPublicKeyData(t);return o?new K(t,e,n,{type:o.keyType,key:o.keyData},this):null}},{key:"deleteKeyPair",value:function(t){delete this._publicKeyDataCache[t],this._host.writeStorageKey("xmkeystore",this._publicKeyDataCache)}},{key:"signWithKeyPair",value:function(t,e,n){var o=this;return new Promise((function(e,r){var i=o._db.transaction("keystore");i.oncomplete=function(t){o._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","object store transaction complete")},i.onerror=function(t){var e="object store transaction failed: ".concat(i.error.message);o._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",e),r(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,e))};var s=i.objectStore("keystore").get(t);o.promiseRequestResult(s).then((function(t){o._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","get key pair success");var i=new Uint8Array(com.ts.mobile.sdk.util.hexToBytes(n)),s=t.key.algorithm.name;o.promiseLikeToPromise(crypto.subtle.sign({name:s,hash:"SHA-256"},t.key,i)).then((function(t){if("ECDSA"===s){var n=o.convertSignatureToDERHex(new Uint8Array(t));e(n)}else if("RSASSA-PKCS1-v1_5"===s)e(o.toHexString(t));else{var i="invalid signing key algorithm";o._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",i),r(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,i))}}))}))})).catch((function(t){throw o._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to sign with key pair: ".concat(t)),com.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))}},{key:"initialize",value:function(){var t=this;return new Promise((function(e,n){var o=function(){try{t._publicKeyDataCache=t._host.readStorageKey("xmkeystore"),e(!0)}catch(e){var o="failed to fetch public key data cache: ".concat(e);t._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",o),n(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,o))}},r=indexedDB.open("com.ts.mobile.sdk.key-store",1);r.onupgradeneeded=function(e){t._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","indexedDB upgrade or create required"),t._db=r.result,t._db.createObjectStore("keystore",{keyPath:"tag"}),o()},r.onsuccess=function(e){t._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","indexedDB opened successfully"),t._db=r.result,o()},r.onerror=function(e){var o="failed to open indexedDB: ".concat(r.error.message);t._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",o),n(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,o))}}))}},{key:"promiseRequestResult",value:function(t){return new Promise((function(e,n){t.onsuccess=function(n){e(t.result)},t.onerror=function(e){n(t.error)}}))}},{key:"promiseLikeToPromise",value:function(t){return new Promise((function(e,n){t.then(e,n)}))}},{key:"keyUsagesForKeyClass",value:function(t){switch(t){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return["decrypt","encrypt"];default:return["sign"]}}},{key:"keyGenParamsForKeyClass",value:function(t){switch(t){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return null;default:return{keyType:"ec",params:{name:"ECDSA",namedCurve:"P-384"}}}}},{key:"fallbackKeyGenParamsForKeyClass",value:function(t){switch(t){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return null;default:return{keyType:"rsapkcs",params:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"}}}}},{key:"getPublicKeyData",value:function(t){return this._publicKeyDataCache[t]}},{key:"savePublicKeyData",value:function(t,e,n){this._publicKeyDataCache[t]={keyType:n,keyData:e},this._host.writeStorageKey("xmkeystore",this._publicKeyDataCache)}},{key:"convertSignatureToDERHex",value:function(t){for(var e=Array.prototype.map.call(t,(function(t){return("00"+t.toString(16)).slice(-2)})).join(""),n=e.substring(0,96),o=e.substring(96),r=!0,i=!0;0===n.indexOf("00");)n=n.substring(2),r=!1;for(r&&parseInt(n.substring(0,2),16)>127&&(n="00"+n);0===o.indexOf("00");)o=o.substring(2),i=!1;i&&parseInt(o.substring(0,2),16)>127&&(o="00"+o);var s=function(t){return("00"+(t.length/2).toString(16)).slice(-2).toString()},a="02"+s(n)+n+"02"+s(o)+o;return"30"+s(a)+a}},{key:"toHexString",value:function(t){return Array.prototype.map.call(new Uint8Array(t),(function(t){return("00"+t.toString(16)).slice(-2)})).join("")}}],[{key:"isIndexedDBSupported",value:function(){return!!(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB)}}]),t}(),H=function(){function t(){n(this,t)}return r(t,null,[{key:"isWebCryptoSupported",value:function(){if(!window.crypto||!window.crypto.subtle)return!1;var t=(new v).setUA(navigator.userAgent).getBrowser(),e=t.name,n=t.major,o=t.minor||0;return"Chrome"===e&&n>=45||"Safari"===e&&n>=11||"Mobile Safari"===e&&(n>=12||11==n&&o>=3)||"Edge"===e&&n>=79||"Firefox"===e&&n>=34}},{key:"isIndexedDBAvailable",value:function(){return new Promise((function(t){try{var e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(e){var n=e.open("capability-test"),o=setTimeout((function(){n.onsuccess=n.onerror=null,t(!1)}),4e3);n.onerror=function(){clearTimeout(o),t(!1)},n.onsuccess=function(){clearTimeout(o),e.deleteDatabase("capability-test"),t(!0)}}else t(!1)}catch(e){t(!1)}}))}},{key:"collect",value:function(){return new Promise((function(e){t.isIndexedDBAvailable().then((function(n){e({indexedDB:n,webCrypto:t.isWebCryptoSupported()})}))}))}}]),t}().collect(),j=function(){function t(){n(this,t),this.logLevel=com.ts.mobile.sdk.LogLevel.Error,this.collectionResultsPromise=null,this.internalLogger=new u,this.externalLogger=null,this.cachedFidoMfuvaSupported=null,this.localizer=new N,this.browserCapabilities=null,window.__XMSDK_PLUGINS={},this.localizer.addDictionary(a)}return r(t,[{key:"initialize",value:function(t){var e=this;return this.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","initialize with collectors [".concat(t,"]")),this._localStorage=new d("localStorage"),this._sessionStorage=new d("sessionStorage"),H.then((function(n){return e.browserCapabilities=n,e._enabledCollectors=t,"true"!==e.queryHostInfo(com.ts.mobile.sdkhost.HostInformationKey.PersistentKeysSupported)||(e.keyStore=new B(e),e.keyStore.initialize())}))}},{key:"setLogLevel",value:function(t){this.logLevel=t}},{key:"log",value:function(t,e,n){t<=this.logLevel&&this.internalLogger.log(t,e,n),this.externalLogger&&this.externalLogger.log(t,e,n)}},{key:"readStorageKey",value:function(t){return JSON.parse(this._localStorage.getItem(t)||"{}")}},{key:"writeStorageKey",value:function(t,e){this._localStorage.setItem(t,JSON.stringify(e))}},{key:"deleteStorageKey",value:function(t){this._localStorage.removeItem(t)}},{key:"readSessionStorageKey",value:function(t){return JSON.parse(this._sessionStorage.getItem(t)||"{}")}},{key:"writeSessionStorageKey",value:function(t,e){this._sessionStorage.setItem(t,JSON.stringify(e))}},{key:"deleteSessionStorageKey",value:function(t){this._sessionStorage.removeItem(t)}},{key:"promiseCollectionResult",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!=n?(this.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() override collectors"),t=n):t=this._enabledCollectors;var o={location:{allow:t.indexOf(com.ts.mobile.sdk.CollectorType.Location)>=0,timeout:4e3,maximumAge:18e4},deviceFingerprint:t.indexOf(com.ts.mobile.sdk.CollectorType.DeviceFingerprint)>=0,largeData:t.indexOf(com.ts.mobile.sdk.CollectorType.LargeData)>=0},r=new Promise((function(n,r){e.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() invoked with collectors: [".concat(t,"]")),S(o).get((function(t){e.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() completed"),n(t)}))}));return Promise.all([r]).then((function(t){var e=Object.assign(t[0]);return e.toJson=function(){return e},e}))}},{key:"calcHexStringEncodedMd5Hash",value:function(t){return q(com.ts.mobile.sdk.util.hexToAscii(t))}},{key:"generateRandomHexString",value:function(t){var e=new Uint8Array(t);(window.crypto||window.msCrypto).getRandomValues(e);for(var n="",o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],r=0;r<e.length;r++){n+=o[15&e[r]]}return n}},{key:"queryHostInfo",value:function(t){switch(t){case com.ts.mobile.sdkhost.HostInformationKey.Version:return"7.0.0";case com.ts.mobile.sdkhost.HostInformationKey.Platform:return"web";case com.ts.mobile.sdkhost.HostInformationKey.FingerprintSupported:return"false";case com.ts.mobile.sdkhost.HostInformationKey.HostProvidedFeatures:return"";case com.ts.mobile.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported:case com.ts.mobile.sdkhost.HostInformationKey.ImageAcquitisionSupported:return"false";case com.ts.mobile.sdkhost.HostInformationKey.AudioAcquitisionSupported:return"true";case com.ts.mobile.sdkhost.HostInformationKey.PersistentKeysSupported:return this.browserCapabilities&&this.browserCapabilities.indexedDB&&this.browserCapabilities.webCrypto?"true":"false";case com.ts.mobile.sdkhost.HostInformationKey.DyadicPresent:return"false";case com.ts.mobile.sdkhost.HostInformationKey.Fido2ClientPresent:return navigator.credentials&&window.PublicKeyCredential?"true":"false";case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsSupported:case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation:case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsUsesSign:return"false";case com.ts.mobile.sdkhost.HostInformationKey.DevicePersistenceMode:return"persistent";default:throw new Error("Info key is unsupported: ".concat(t))}}},{key:"queryAsyncHostInfo",value:function(t){var e=this;return new Promise((function(n,o){switch(t){case com.ts.mobile.sdkhost.AsyncHostInformationKey.Fido2UserVerifyingPlatformAuthenticatorAvailable:if(e.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable invoked"),null!=e.cachedFidoMfuvaSupported)e.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable returning cached result"),n(e.cachedFidoMfuvaSupported?"true":"false");else{e.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable evaluating");var r=window.PublicKeyCredential;(r?r.isUserVerifyingPlatformAuthenticatorAvailable().catch((function(t){return!1})):Promise.resolve(!1)).then((function(t){e.cachedFidoMfuvaSupported=t,n(t?"true":"false")}))}break;default:e.log(com.ts.mobile.sdk.LogLevel.Debug,"not-implemented","queryAsyncHostInfo not implemented for key \n                            [".concat(com.ts.mobile.sdkhost.AsyncHostInformationKey[t],"] in tarsus-web")),o("Info key is unsupported: ".concat(t))}}))}},{key:"setExternalLogger",value:function(t){this.externalLogger=t}},{key:"getCurrentTime",value:function(){return Date.now()}},{key:"createDelayedPromise",value:function(t){return new Promise((function(e){setTimeout((function(){return e(t)}),t)}))}},{key:"calcHexStringEncodedHmacSha1HashWithHexEncodedKey",value:function(t,e){return this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","calcHexStringEncodedHmacSha1HashWithHexEncodedKey not implemented for tarsus-web"),null}},{key:"generatePbkdf2HmacSha1HexString",value:function(t,e,n,o){return Promise.reject("generatePbkdf2HmacSha1HexString not implemented for tarsus-web")}},{key:"fidoClientXact",value:function(t,e,n,o){return Promise.reject("fidoClientXact not implemented for tarsus-web")}},{key:"fido2CredentialsOp",value:function(t,e,n,o,r){return new U(o,r).execute()}},{key:"generateKeyPair",value:function(t,e,n,o){return this.keyStore.generateKeyPair(t,e,n,o)}},{key:"getKeyPair",value:function(t,e,n){return this.keyStore.getKeyPair(t,e,n)}},{key:"deleteKeyPair",value:function(t){this.keyStore.deleteKeyPair(t)}},{key:"importSymmetricKey",value:function(t,e,n,o){return this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","importSymmetricKey not implemented for tarsus-web"),null}},{key:"calcHexStringEncodedSha256Hash",value:function(t){var e=com.ts.mobile.sdk.util.hexToAscii(t);return sha256(com.ts.mobile.sdk.util.toUTF8Array(e))}},{key:"calcHexStringEncodedSha512Hash",value:function(t){throw this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","calcHexStringEncodedSha512Hash not implemented for tarsus-web"),new Error("Method not implemented.")}},{key:"generateHexSeededKeyPairExternalRepresentation",value:function(t,e){return Promise.reject("Method not implemented.")}},{key:"generateKeyPairExternalRepresentation",value:function(t){return Promise.reject("Method not implemented.")}},{key:"importVolatileKeyPair",value:function(t,e){throw new Error("Method not implemented.")}},{key:"importVolatileSymmetricKey",value:function(t,e){throw new Error("Method not implemented.")}},{key:"loadPlugin",value:function(t){var e=window.__XMSDK_PLUGINS[t];return e?(this.log(com.ts.mobile.sdk.LogLevel.Debug,"plugins","Found defined plugin "+t),Promise.resolve(e)):(this.log(com.ts.mobile.sdk.LogLevel.Error,"plugins","Could not find defined plugin "+t),Promise.reject(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.AppImplementation,"Could not find defined plugin "+t)))}},{key:"dyadicRefreshToken",value:function(t){throw new Error("Method not implemented.")}},{key:"dyadicEnroll",value:function(t,e){return Promise.reject("Method not implemented.")}},{key:"dyadicSign",value:function(t){return Promise.reject("Method not implemented.")}},{key:"dyadicDelete",value:function(){return Promise.reject("Method not implemented.")}},{key:"setDebugIndicatorVisible",value:function(t){t?this.debugIndicator||(this.debugIndicator=document.createElement("div"),Object.assign(this.debugIndicator.style,{position:"absolute",top:"5px",left:"5px",background:"black",opacity:"0.7",color:"white",borderRadius:"10px",padding:"12px",fontFamily:"sans-serif"}),this.debugIndicator.innerText="Transmit SDK: Journey is being debugged.",document.body.appendChild(this.debugIndicator)):this.debugIndicator&&(this.debugIndicator.remove(),this.debugIndicator=null)}},{key:"importVolatileKeyPairFromPublicKeyHex",value:function(t,e){throw new Error("Method not implemented.")}},{key:"getString",value:function(t,e){return this.localizer.getString(t,e)}},{key:"getPreferredLocale",value:function(){var t=window.navigator,e=window.navigator.languages?window.navigator.languages[0]:null;return e=e||t.language||t.browserLanguage||t.userLanguage}},{key:"transformApiPath",value:function(t){return t}},{key:"getUIStyles",value:function(){return"{}"}}]),t}();!function(t){!function(t){!function(t){!function(t){!function(t){var n={},o=function(){function t(t){t?(this._reading=!0,this._root=t):(this._reading=!1,this._root={}),this._currentContainer=this._root,this._otherContainerStack=[]}return Object.defineProperty(t.prototype,"serializedContent",{get:function(){return this._root},enumerable:!1,configurable:!0}),t.prototype.enterContainer=function(t){var n=this._currentContainer[t];if(this._reading||n||(n={},this._currentContainer[t]=n),"object"!=e(n))throw new Error("Attempt to enter non-container "+t);this._otherContainerStack.push(this._currentContainer),this._currentContainer=n},t.prototype.leaveContainer=function(){this._currentContainer=this._otherContainerStack.pop()},t.prototype.writePrimitive=function(t,e){this._currentContainer[t]=e},t.prototype.readPrimitive=function(t){return this._currentContainer[t]},t.prototype.writeObject=function(t,e){if(null!==e){var n=e.constructor.___serializationTag;if(!n)throw new Error("Invalid typetag for object passed to writeObject. Did you forget to decorate object with @Serializable?");this.enterContainer(t),this.writePrimitive("type",n),this.enterContainer("content"),e.serializeTo(this),this.leaveContainer(),this.leaveContainer()}else this.writePrimitive(t,null)},t.prototype.readObject=function(t,e){return this.internalReadObject(t,e)},t.prototype.readNonNullObject=function(t,e){var n=this.internalReadObject(t,e);if(!n)throw new Error("Invalid null object encountered");return n},t.prototype.internalReadObject=function(t,e){var o,r;if("string"==typeof t?(r=t,o=null):(o=t,r=e),null===this.readPrimitive(r))return null;this.enterContainer(r);var i=this.readPrimitive("type"),s=n[i];if(!s)throw new Error("Invalid class tag encountered in archive "+i);this.enterContainer("content");var a=new s(this);if(this.leaveContainer(),o&&!(a instanceof o))throw new Error("Expected subclass of "+o+"; found "+s);return this.leaveContainer(),a},t}();t.SerializationContext=o,t.Serializable=function(t){return function(e){n[t]=e,e.___serializationTag=t}}}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Hide=0]="Hide",t[t.Action=1]="Action",t[t.Cancel=2]="Cancel",t[t.Custom=3]="Custom"}(t.ActionEscapeOptionPresentation||(t.ActionEscapeOptionPresentation={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.__tarsusInterfaceName="InputResponseType",t}();t.InputResponseType=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.__tarsusInterfaceName="AuthenticationActionParameter",t}();t.AuthenticationActionParameter=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var W,V=f&&f.__extends||(W=function(t,e){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getAuthenticatorInput=function(){return this._authenticatorInput},n.prototype.setAuthenticatorInput=function(t){this._authenticatorInput=t},n.prototype.getSelectedTargets=function(){return this._selectedTargets},n.prototype.setSelectedTargets=function(t){this._selectedTargets=t},n.createAuthenticatorInput=function(e){return t.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createAuthenticatorInput(e)},n.createTargetSelectionRequest=function(e){return t.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createTargetSelectionRequest(e)},n.createTargetsSelectionRequest=function(e){return t.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createTargetsSelectionRequest(e)},n.__tarsusInterfaceName="TargetBasedAuthenticatorInput",n}(e.InputResponseType);e.TargetBasedAuthenticatorInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="OtpInput",e}(t.InputResponseType);t.OtpInput=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createSuccessResponse=function(e){return t.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createSuccessResponse(e)},n.createdFailedResponse=function(e,n){return t.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createdFailedResponse(e,n)},n.createFailedResponseWithServerProvidedStatus=function(e){return t.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createFailedResponseWithServerProvidedStatus(e)},n.__tarsusInterfaceName="PlaceholderInputResponse",n}(e.InputResponseType);e.PlaceholderInputResponse=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.__tarsusInterfaceName="PushRequestPayload",t}();t.PushRequestPayload=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createWithUserId=function(e){return t.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithUserId(e)},n.createWithUserTicket=function(e){return t.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithUserTicket(e)},n.createWithJsonPayload=function(e){return t.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithJsonPayload(e)},n.__tarsusInterfaceName="MobileApprovePushRequestPayload",n}(e.PushRequestPayload);e.MobileApprovePushRequestPayload=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createSecurityQuestionAnswersInputResponse=function(e){return t.ts.mobile.sdk.impl.SecurityQuestionInputResponseImpl.createSecurityQuestionAnswersInputResponse(e)},n.__tarsusInterfaceName="SecurityQuestionInputResponse",n}(e.InputResponseType);e.SecurityQuestionInputResponse=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getAnswerText=function(){return this._answerText},e.createWithText=function(e){return t.ts.mobile.sdk.impl.SecurityQuestionAnswerImpl.createWithText(e)},e.__tarsusInterfaceName="SecurityQuestionAnswer",e}();e.SecurityQuestionAnswer=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getQuestion=function(){return this._question},e.prototype.getAnswer=function(){return this._answer},e.prototype.getIsRemoved=function(){return this._isRemoved},e.createAnswerToQuestion=function(e,n){return t.ts.mobile.sdk.impl.SecurityQuestionAndAnswerImpl.createAnswerToQuestion(e,n)},e.createAnswerRemovalRequest=function(e){return t.ts.mobile.sdk.impl.SecurityQuestionAndAnswerImpl.createAnswerRemovalRequest(e)},e.__tarsusInterfaceName="SecurityQuestionAndAnswer",e}();e.SecurityQuestionAndAnswer=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getFlowId=function(){return this._flowId},t.prototype.setFlowId=function(t){this._flowId=t},t.__tarsusInterfaceName="JourneyInvocationOptions",t}();t.JourneyInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.createEscapeRequest=function(e){return t.ts.mobile.tarsusplugin.impl.TotpProvisionResultImpl.createEscapeRequest(e)},e.__tarsusInterfaceName="TotpProvisionResult",e}();e.TotpProvisionResult=n}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getAssertionData=function(){return this._assertionData},e.prototype.setAssertionData=function(t){this._assertionData=t},e.prototype.getStoredData=function(){return this._storedData},e.prototype.setStoredData=function(t){this._storedData=t},e.__tarsusInterfaceName="TotpProvisionOutput",e}(t.TotpProvisionResult);t.TotpProvisionOutput=e}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e){this._stepTag=t,this._passphraseText=e}return t.prototype.getStepTag=function(){return this._stepTag},t.prototype.getAcquisitionChallenges=function(){return[]},t.prototype.getPassphraseText=function(){return this._passphraseText},t.__tarsusInterfaceName="AudioAcquisitionStepDescription",t}();t.AudioAcquisitionStepDescriptionImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getTarget=function(){return this._target},n.create=function(e){return t.ts.mobile.sdk.impl.AuthenticationActionParameterTargetSelectionImpl.create(e)},n.__tarsusInterfaceName="AuthenticationActionParameterTargetSelection",n}(e.AuthenticationActionParameter);e.AuthenticationActionParameterTargetSelection=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(e){var n=t.call(this)||this;return n._target=e,n}return V(e,t),e.create=function(t){return new e(t)},e.__tarsusInterfaceName="AuthenticationActionParameterTargetSelection",e}(t.AuthenticationActionParameterTargetSelection);e.AuthenticationActionParameterTargetSelectionImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getErrorCode=function(){return this._errorCode},e.prototype.getMessage=function(){return this._message},e.prototype.getData=function(){return this._data},e.createApplicationGeneratedGeneralError=function(e,n){return t.ts.mobile.sdk.impl.AuthenticationErrorImpl.createApplicationGeneratedGeneralError(e,n)},e.createApplicationGeneratedCommunicationError=function(e,n){return t.ts.mobile.sdk.impl.AuthenticationErrorImpl.createApplicationGeneratedCommunicationError(e,n)},e.__tarsusInterfaceName="AuthenticationError",e}();e.AuthenticationError=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var G=f&&f.__assign||function(){return(G=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e,n){var r=o.call(this)||this;return r._errorCode=t,r._message=e,r._data=n||{},r._data.public_properties||(r._data=G(G({},r._data),{public_properties:{}})),r}return V(r,o),r.errorForServerResponse=function(t){var n={server_error_code:t.error_code,server_error_message:t.error_message,server_error_data:t.data},o=t.error_message||"Internal error",i=e.AuthenticationErrorCode.Internal;switch(t.error_code){case 2009:i=e.AuthenticationErrorCode.DeviceNotFound;break;case 28:var s=new r(e.AuthenticationErrorCode.InvalidIdToken,o);return s.setPublicProperty(e.AuthenticationErrorProperty.InvalidIdTokenErrorReason,e.AuthenticationErrorPropertySymbol.InvalidIdTokenErrorReasonBadToken),s;case e.core.Protocol.ServerResponseErrorCode.UserIdTokenExpired:return(s=new r(e.AuthenticationErrorCode.InvalidIdToken,o)).setPublicProperty(e.AuthenticationErrorProperty.InvalidIdTokenErrorReason,e.AuthenticationErrorPropertySymbol.InvalidIdTokenErrorReasonExpiredToken),s;case 3001:case 3002:i=e.AuthenticationErrorCode.InvalidDeviceBinding;break;case 4e3:case 4002:i=e.AuthenticationErrorCode.ControlFlowExpired;break;case 4005:case 4006:i=e.AuthenticationErrorCode.SessionRequired;break;case 6001:case 6002:i=e.AuthenticationErrorCode.ApprovalWrongState}return new r(i,o,n)},r.createApplicationGeneratedGeneralError=function(t,n){return new r(e.AuthenticationErrorCode.Internal,t,n)},r.createApplicationGeneratedCommunicationError=function(t,n){return new r(e.AuthenticationErrorCode.Communication,t,n)},r.errorForSessionRejectionFailureData=function(t){var n=e.AuthenticationErrorCode.PolicyRejection,o="Session rejected by server.",i={failure_data:t};if(t&&t.source)switch(t.reason&&t.reason.type){case e.core.Protocol.FailureReasonType.ApprovalExpired:n=e.AuthenticationErrorCode.ApprovalWrongState,o="Approval expired.",i.approval_state="expired"}return new r(n,o,i)},r.errorForHostInternalBiometricErrorData=function(o,r){var i;switch(o[t.sdkhost.ErrorDataInternalError]){case t.sdkhost.InternalErrorBiometricInvalidated:i=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.AuthenticatorInvalidated,r+" registration invalidated.");break;case t.sdkhost.InternalErrorWrongBiometric:i=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.InvalidInput,"Invalid "+r+" was input.");break;case t.sdkhost.InternalErrorBiometricNotConfigured:(i=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.AuthenticatorExternalConfigError,r+" not configured on this device.")).setPublicProperty(e.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,e.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled);break;case t.sdkhost.InternalErrorBiometricOsLockTemporary:(i=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.AuthenticatorExternalConfigError,r+" authentication is temporarily locked by the OS.")).setPublicProperty(e.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,e.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary);break;case t.sdkhost.InternalErrorBiometricOsLockPermanent:(i=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.AuthenticatorExternalConfigError,r+" authentication is permanently locked by the OS.")).setPublicProperty(e.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,e.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent);break;default:i=null}return i},r.errorForHostInternalErrorData=function(o){var r;switch(o[t.sdkhost.ErrorDataInternalError]){case t.sdkhost.InternalErrorCouldNotGenerateSecureKey:(r=new n.AuthenticationErrorImpl(e.AuthenticationErrorCode.AuthenticatorExternalConfigError,"Failed to generate secure key.")).setPublicProperty(e.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,e.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure);break;default:r=null}return r},r.prototype.setPublicProperty=function(t,n){this._data.public_properties[e.AuthenticationErrorProperty[t]]=n},r.prototype.getPublicProperty=function(t){return this._data.public_properties[e.AuthenticationErrorProperty[t]]},r.prototype.getPublicBooleanProperty=function(t){var n=this.getPublicProperty(t);if(n&&"boolean"!=typeof n)throw new r(e.AuthenticationErrorCode.AppImplementation,"type of property "+e.AuthenticationErrorProperty[t]+" is not 'boolean'");return n},r.prototype.getPublicNumberProperty=function(t){var n=this.getPublicProperty(t);if(n&&"number"!=typeof n)throw new r(e.AuthenticationErrorCode.AppImplementation,"type of property "+e.AuthenticationErrorProperty[t]+" is not 'number'");return n},r.prototype.getPublicStringProperty=function(t){var n=this.getPublicProperty(t);if(n&&"string"!=typeof n)throw new r(e.AuthenticationErrorCode.AppImplementation,"type of property "+e.AuthenticationErrorProperty[t]+" is not 'string'");return n},r.prototype.getPublicSymbolicProperty=function(t){var n=this.getPublicProperty(t);if(n&&!e.AuthenticationErrorProperty[t])throw new r(e.AuthenticationErrorCode.AppImplementation,"type of property "+e.AuthenticationErrorProperty[t]+" is not 'AuthenticationErrorPropertySymbol'");return n},r.prototype.toString=function(){return"AuthenticationError<"+e.AuthenticationErrorCode[this._errorCode]+", "+this._message+", "+JSON.stringify(this._data)+">"},r.errorForAssertionResponse=function(t){var n;switch(t.assertion_error_code){case e.core.Protocol.AssertionErrorCode.FailedAssertion:n=e.AuthenticationErrorCode.InvalidInput;break;case e.core.Protocol.AssertionErrorCode.MethodLocked:n=e.AuthenticationErrorCode.AuthenticatorLocked;break;case e.core.Protocol.AssertionErrorCode.HistoryRepeat:n=e.AuthenticationErrorCode.RegisteredSecretAlreadyInHistory;break;default:n=e.AuthenticationErrorCode.Internal}var o={assertion_error_code:t.assertion_error_code,additional_data:t.data};return new r(n,t.assertion_error_message||"Assertion error code "+t.assertion_error_code,o)},r.appImplementationError=function(t){return new r(e.AuthenticationErrorCode.AppImplementation,t)},r.errorForTransportResponse=function(t){return new r(e.AuthenticationErrorCode.Communication,"HTTP response error",{status:t.getStatus(),body:t.getBodyJson()})},r.ensureAuthenticationError=function(t){if(r.dynamicCast(t))return t;var n={js_error_message:t.toString()};return t.stack&&(n.js_error_stack=t.stack),new r(e.AuthenticationErrorCode.Internal,"Internal error occurred ("+t.toString()+")",n)},r.augmentErrorData=function(t,e){var n,o={},i=t.getData();if(i)for(n in i)o[n]=i[n];for(n in e)o[n]=e[n];return new r(t.getErrorCode(),t.getMessage(),o)},r.dynamicCast=function(t){return void 0!==t.getErrorCode&&void 0!==t.getMessage&&void 0!==t.getData},r}(e.AuthenticationError);n.AuthenticationErrorImpl=o}(e.impl||(e.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e){this._authenticator=t,this._suggestedParams=e}return t.prototype.getAuthenticator=function(){return this._authenticator},t.prototype.getSuggestedParameters=function(){return this._suggestedParams},t}();t.AuthenticationOptionImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n,o){this._appData=n||null,this._token=t||null,this._internalData=o||null,this._deviceId=e||null}return t.prototype.getToken=function(){return this._token||""},t.prototype.getDeviceId=function(){return this._deviceId||""},t.prototype.getData=function(){return this._appData||{}},t.prototype.getInternalData=function(){return this._internalData},t.fromCflowServerResponse=function(e,n){return new t(e.token,n,e.application_data,e.data)},t}();t.AuthenticationResultImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getResultType=function(){return this._resultType},e.prototype.setResultType=function(t){this._resultType=t},e.prototype.getSelectedAuthenticator=function(){return this._selectedAuthenticator},e.prototype.setSelectedAuthenticator=function(t){this._selectedAuthenticator=t},e.prototype.getSelectedAuthenticationParameters=function(){return this._selectedAuthenticationParameters},e.prototype.setSelectedAuthenticationParameters=function(t){this._selectedAuthenticationParameters=t},e.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},e.prototype.setActionEscapeRequest=function(t){this._actionEscapeRequest=t},e.createAbortRequest=function(){return t.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createAbortRequest()},e.createEscapeRequest=function(e,n){return t.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createEscapeRequest(e,n)},e.createSelectionRequest=function(e){return t.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createSelectionRequest(e)},e.createParameterizedSelectionRequest=function(e,n){return t.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createParameterizedSelectionRequest(e,n)},e.__tarsusInterfaceName="AuthenticatorSelectionResult",e}();e.AuthenticatorSelectionResult=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createAbortRequest=function(){var e=new n;return e.setResultType(t.AuthenticatorSelectionResultType.Abort),e},n.createSelectionRequest=function(e){var o=new n;return o.setResultType(t.AuthenticatorSelectionResultType.SelectAuthenticator),o.setSelectedAuthenticator(e),o},n.createEscapeRequest=function(e,o){var r=new n;return r._resultType=t.AuthenticatorSelectionResultType.Escape,r._actionEscapeRequest=new t.ActionEscapeRequest,r._actionEscapeRequest._escapeOption=e,r._actionEscapeRequest._escapeParameters=o,r},n}(t.AuthenticatorSelectionResult);e.AuthenticatorSelectionResultImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t){this._acquisitionChallenges=t}return t.prototype.getStepTag=function(){return"imageAcquisition"},t.prototype.getAcquisitionChallenges=function(){return this._acquisitionChallenges},t.__tarsusInterfaceName="CameraAcquisitionStepDescription",t}();t.CameraAcquisitionStepDescriptionImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getLocalEnrollmentKeySizeInBytes=function(){return this._localEnrollmentKeySizeInBytes},e.prototype.getLocalEnrollmentKeyIterationCount=function(){return this._localEnrollmentKeyIterationCount},e.prototype.setLocalEnrollmentKeyIterationCount=function(t){this._localEnrollmentKeyIterationCount=t},e.create=function(e){return t.ts.mobile.sdk.impl.ClientCryptoSettingsImpl.create(e)},e.__tarsusInterfaceName="ClientCryptoSettings",e}();e.ClientCryptoSettings=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setLocalEnrollmentKeyIterationCount(t),n._localEnrollmentKeySizeInBytes=32,n},e}(t.ClientCryptoSettings);e.ClientCryptoSettingsImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(t,e){this._description=t,this._menuItemOptions=e||{}}return e.prototype.getDescription=function(){return this._description},e.prototype.getAvailableActions=function(){var e=this,n=[];switch(this._description.getRegistrationStatus()){case t.AuthenticatorRegistrationStatus.Registered:n=[t.AuthenticatorConfigurationAction.Reregister,t.AuthenticatorConfigurationAction.Unregister];break;case t.AuthenticatorRegistrationStatus.Unregistered:case t.AuthenticatorRegistrationStatus.LocallyInvalid:n=[t.AuthenticatorConfigurationAction.Register]}return n.filter((function(n){return n==t.AuthenticatorConfigurationAction.Reregister&&!e._menuItemOptions.hide_reregister||n==t.AuthenticatorConfigurationAction.Register&&!e._menuItemOptions.hide_register||n==t.AuthenticatorConfigurationAction.Unregister&&!e._menuItemOptions.hide_unregister}))},e}();e.ConfigurableAuthenticatorImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getUserChoice=function(){return this._userChoice},e.prototype.setUserChoice=function(t){this._userChoice=t},e.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},e.prototype.setActionEscapeRequest=function(t){this._actionEscapeRequest=t},e.create=function(e){return t.ts.mobile.sdk.impl.ConfirmationInputImpl.create(e)},e.createEscapeRequest=function(e,n){return t.ts.mobile.sdk.impl.ConfirmationInputImpl.createEscapeRequest(e,n)},e.__tarsusInterfaceName="ConfirmationInput",e}();e.ConfirmationInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.create=function(t){var e=new n;return e.setUserChoice(t),e},n.createEscapeRequest=function(e,o){var r=new n,i=new t.ActionEscapeRequest;return i.setEscapeOption(e),i.setEscapeParameters(o),r.setActionEscapeRequest(i),r},n}(t.ConfirmationInput);e.ConfirmationInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getRequestType=function(){return this._requestType},e.prototype.setRequestType=function(t){this._requestType=t},e.create=function(e){return t.ts.mobile.sdk.impl.ControlRequestImpl.create(e)},e.__tarsusInterfaceName="ControlRequest",e}();e.ControlRequest=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setRequestType(t),n},e}(t.ControlRequest);e.ControlRequestImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPrompt=function(){return this._prompt},n.prototype.setPrompt=function(t){this._prompt=t},n.prototype.getTitle=function(){return this._title},n.prototype.setTitle=function(t){this._title=t},n.prototype.getSubtitle=function(){return this._subtitle},n.prototype.setSubtitle=function(t){this._subtitle=t},n.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},n.prototype.setCancelButtonTitle=function(t){this._cancelButtonTitle=t},n.create=function(e){return t.ts.mobile.sdk.impl.DeviceBiometricsInputImpl.create(e)},n.createFull=function(e,n,o,r){return t.ts.mobile.sdk.impl.DeviceBiometricsInputImpl.createFull(e,n,o,r)},n.__tarsusInterfaceName="DeviceBiometricsInput",n}(e.InputResponseType);e.DeviceBiometricsInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return t&&n.setPrompt(t),n},e}(t.DeviceBiometricsInput);e.DeviceBiometricsInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e){this._id=t,this._name=e}return t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._name},t}();t.DeviceGroupImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(t){this.updateFromServer(t)}return n.prototype.getDeviceHwId=function(){return this._id},n.prototype.getName=function(){return this._name?this._name:this._model+" "+this._osType+" "+this._osVersion},n.prototype.getStatus=function(){return this._status},n.prototype.getLastAccess=function(){return this._lastAccess},n.prototype.getLastAccessLocation=function(){return this._lastAccessLocation},n.prototype.getLastAccessLocationAttributes=function(){return this._lastAccessLocationAttributes},n.prototype.getRegistered=function(){return this._registered},n.prototype.getModel=function(){return this._model},n.prototype.getOsType=function(){return this._osType},n.prototype.getOsVersion=function(){return this._osVersion},n.prototype.getUseCount=function(){return this._useCount},n.prototype.getIsCurrent=function(){return this._isCurrent},n.prototype.getDeviecId=function(){return this._id},n.prototype.setStatus=function(t){this._status=t},n.prototype.setName=function(t){this._name=t},n.prototype.forceCurrent=function(){this._isCurrent=!0},n.prototype.updateFromServer=function(n){switch(this._model=t.core.DeviceModelConverter.getDeviceModel(n.device_model,n.os_type),this._name=n.name,this._lastAccess=Date.parse(n.last_access),this._registered=Date.parse(n.registered),this._osType=t.core.DeviceModelConverter.getOsName(n.os_type),this._osVersion=n.os_version,this._useCount=n.use_count,this._isCurrent=n.cur_device,this._id=n.device_id,n.status){case t.core.Protocol.DeviceStatusServerFormat.Disabled:this._status=t.DeviceStatus.Disabled;break;case t.core.Protocol.DeviceStatusServerFormat.LongInactivity:this._status=t.DeviceStatus.LongInactivity;break;case t.core.Protocol.DeviceStatusServerFormat.NoRecentActivity:this._status=t.DeviceStatus.NoRecentActivity;break;case t.core.Protocol.DeviceStatusServerFormat.RecentlyUsed:this._status=t.DeviceStatus.RecentlyUsed;break;case t.core.Protocol.DeviceStatusServerFormat.Removed:this._status=t.DeviceStatus.Removed;break;default:throw new e.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown device status "+n.status)}if(n.last_access_location){var o=new t.GeoLocation;o.longitude=n.last_access_location.lng,o.latitude=n.last_access_location.lat,this._lastAccessLocation=o,this._lastAccessLocationAttributes=new e.LocationAttributesImpl(n.last_access_location)}},n}();e.DeviceInfoImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.getOsName=function(t){var e=t;switch(t){case"iPhone":case"iPad":e="iOS"}return e},t.getDeviceModel=function(t,e){var n=t;if("iPhone"==e)switch(t){case"i386":case"x86_64":n="Simulator";break;case"iPod1,1":case"iPod2,1":case"iPod3,1":case"iPod4,1":case"iPod7,1":n="iPod Touch";break;case"iPhone1,1":case"iPhone1,2":case"iPhone2,1":n="iPhone";break;case"iPad1,1":n="iPad";break;case"iPad2,1":n="iPad 2";break;case"iPad3,1":n="iPad";break;case"iPhone3,1":case"iPhone3,3":n="iPhone 4";break;case"iPhone4,1":n="iPhone 4S";break;case"iPhone5,1":case"iPhone5,2":n="iPhone 5";break;case"iPad3,4":n="iPad";break;case"iPad2,5":n="iPad Mini";break;case"iPhone5,3":case"iPhone5,4":n="iPhone 5c";break;case"iPhone6,1":case"iPhone6,2":n="iPhone 5s";break;case"iPhone7,1":n="iPhone 6 Plus";break;case"iPhone7,2":n="iPhone 6";break;case"iPhone8,1":n="iPhone 6S";break;case"iPhone8,2":n="iPhone 6S Plus";break;case"iPhone8,4":n="iPhone SE";break;case"iPhone9,1":case"iPhone9,3":n="iPhone 7";break;case"iPhone9,2":case"iPhone9,4":n="iPhone 7 Plus";break;case"iPhone10,1":case"iPhone10,4":n="iPhone 8";break;case"iPhone10,2":case"iPhone10,5":n="iPhone 8 Plus";break;case"iPhone10,3":case"iPhone10,6":n="iPhone X";break;case"iPad4,1":case"iPad4,2":n="iPad Air";break;case"iPad4,4":case"iPad4,5":case"iPad4,7":n="iPad Mini";break;case"iPad6,7":case"iPad6,8":n='iPad Pro (12.9")';break;case"iPad6,3":case"iPad6,4":n='iPad Pro (9.7")';break;case"iPhone11,2":n="iPhone XS";break;case"iPhone11,6":case"iPhone11,4":n="iPhone XS Max";break;case"iPhone11,8":n="iPhone XR";break;case"iPad6,7":case"iPad6,8":n='iPad Pro (12.9")';break;case"iPad6,11":case"iPad6,12":n="iPad (2017)";break;case"iPad7,1":case"iPad7,2":n="iPad Pro 2nd Gen";break;case"iPad7,3":case"iPad7,4":n='iPad Pro (10.5")';break;case"iPad7,5":case"iPad7,6":n="iPad";break;case"iPad8,1":case"iPad8,2":case"iPad8,3":case"iPad8,4":n='iPad Pro (11")';break;case"iPad8,5":case"iPad8,6":case"iPad8,7":case"iPad8,8":n='iPad Pro (12.9")';break;case"iPad8,9":case"iPad8,10":n='iPad Pro (11")';break;case"iPad8,11":case"iPad8,12":n='iPad Pro (12.9")';break;case"iPad11,1":case"iPad11,2":n="iPad mini";break;case"iPad11,3":case"iPad11,4":n="iPad Air";break;case"iPad11,6":case"iPad11,7":n="iPad";break;case"iPad13,1":case"iPad13,2":n="iPad Air";break;case"iPad13,4":case"iPad13,5":case"iPad13,6":case"iPad13,7":n='iPad Pro (11")';break;case"iPad13,8":case"iPad13,9":case"iPad13,10":case"iPad13,11":n='iPad Pro (12.9")';break;case"iPhone12,1":n="iPhone 11";break;case"iPhone12,3":n="iPhone 11 Pro";break;case"iPhone12,5":n="iPhone 11 Pro Max";break;case"iPhone12,8":n="iPhone SE 2nd Gen";break;case"iPhone13,1":n="iPhone 12 Mini";break;case"iPhone13,2":n="iPhone 12";break;case"iPhone13,3":n="iPhone 12 Pro";break;case"iPhone13,4":n="iPhone 12 Pro Max"}return n},t}();t.DeviceModelConverter=e}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Password=0]="Password",t[t.Fingerprint=1]="Fingerprint",t[t.Pincode=2]="Pincode",t[t.Pattern=3]="Pattern",t[t.Otp=4]="Otp",t[t.Face=5]="Face",t[t.Voice=6]="Voice",t[t.Eye=7]="Eye",t[t.Emoji=8]="Emoji",t[t.Questions=9]="Questions",t[t.FaceID=10]="FaceID",t[t.Generic=11]="Generic",t[t.MobileApprove=12]="MobileApprove",t[t.Totp=13]="Totp",t[t.DeviceBiometrics=14]="DeviceBiometrics",t[t.Fido2=15]="Fido2"}(t.AuthenticatorType||(t.AuthenticatorType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.RedirectTypeBind=0]="RedirectTypeBind",t[t.RedirectTypeAuthenticate=1]="RedirectTypeAuthenticate",t[t.RedirectTypeBindOrAuthenticate=2]="RedirectTypeBindOrAuthenticate",t[t.RedirectTypeInvokePolicy=3]="RedirectTypeInvokePolicy"}(t.RedirectType||(t.RedirectType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n,o;e.AuthTypeData={password:{authTypeEnum:t.AuthenticatorType.Password,authTypeName:"Password"},fingerprint:{authTypeEnum:t.AuthenticatorType.Fingerprint,authTypeName:"Fingerprint"},pin:{authTypeEnum:t.AuthenticatorType.Pincode,authTypeName:"PIN"},pin_centralized:{authTypeEnum:t.AuthenticatorType.Pincode,authTypeName:"PIN"},pattern:{authTypeEnum:t.AuthenticatorType.Pattern,authTypeName:"Pattern"},pattern_centralized:{authTypeEnum:t.AuthenticatorType.Pattern,authTypeName:"Pattern"},otp:{authTypeEnum:t.AuthenticatorType.Otp,authTypeName:"OTP"},face:{authTypeEnum:t.AuthenticatorType.Face,authTypeName:"Face"},face_server:{authTypeEnum:t.AuthenticatorType.Face,authTypeName:"Face"},voice_server:{authTypeEnum:t.AuthenticatorType.Voice,authTypeName:"Voice"},eye:{authTypeEnum:t.AuthenticatorType.Eye,authTypeName:"Eye"},emoji:{authTypeEnum:t.AuthenticatorType.Emoji,authTypeName:"Emoji"},question:{authTypeEnum:t.AuthenticatorType.Questions,authTypeName:"Questions"},face_id:{authTypeEnum:t.AuthenticatorType.FaceID,authTypeName:"FaceID"},mobile_approve:{authTypeEnum:t.AuthenticatorType.MobileApprove,authTypeName:"MobileApprove"},totp:{authTypeEnum:t.AuthenticatorType.Totp,authTypeName:"Totp"},device_biometrics:{authTypeEnum:t.AuthenticatorType.DeviceBiometrics,authTypeName:"DeviceBiometrics"},fido2:{authTypeEnum:t.AuthenticatorType.Generic,authTypeName:"FIDO2Authenticator"}},function(t){t.Closed="closed"}(e.SessionStateChangeState||(e.SessionStateChangeState={})),e.flowIdHeaderName="flow_id",function(t){t.Pending="pending",t.Completed="completed",t.Rejected="rejected"}(e.AuthSessionState||(e.AuthSessionState={})),function(t){t.LOGINS="frequency_logins",t.DAYS="frequency_days"}(e.PromotionStrategyFrequency||(e.PromotionStrategyFrequency={})),function(t){t.Numeric="numeric",t.Alphanumeric="alphanumeric",t.Binary="binary"}(e.QrCodeFormatType||(e.QrCodeFormatType={})),function(t){t.Alphanumeric="alphanumeric",t.QrCode="qrcode"}(e.TicketIdFormatType||(e.TicketIdFormatType={})),function(t){t.ApprovalApprove="approval_approve"}(e.FailureSourceTransactionType||(e.FailureSourceTransactionType={})),function(t){t.AutoExecute="auto_execute",t.AssertionRejected="assertion_rejected",t.Policy="policy",t.Locked="locked",t.ApprovalExpired="approval_expired"}(e.FailureReasonType||(e.FailureReasonType={})),function(t){t.DefaultAuthenticator="default",t.AuthenticatorMenu="menu",t.FirstAuthenticator="first"}(e.AuthMenuPresentationMode||(e.AuthMenuPresentationMode={})),function(t){t.Registered="registered",t.Registering="registering",t.Unregistered="unregistered"}(e.AuthenticationMethodStatus||(e.AuthenticationMethodStatus={})),function(t){t.Validate="validate",t.Generate="generate"}(e.AuthenticationMethodOtpState||(e.AuthenticationMethodOtpState={})),function(t){t.None="none",t.Sms="sms",t.Email="email",t.Voice="voice",t.Push="push_notification"}(e.AuthenticationMethodOtpChannelType||(e.AuthenticationMethodOtpChannelType={})),function(t){t.Numeric="numeric",t.QrCode="qrcode",t.External="external",t.Unknown=""}(e.OtpFormatType||(e.OtpFormatType={})),function(t){t.WaitForApproval="wait_for_approval",t.WaitForAuthenticate="wait_for_authenticate"}(e.AuthenticationMethodMobileApproveState||(e.AuthenticationMethodMobileApproveState={})),function(t){t.AlphaNumeric="alpha_numeric",t.Numeric="numeric",t.QrCode="qrcode"}(e.TotpChallengeFormatType||(e.TotpChallengeFormatType={})),function(t){t.SelectTargets="select_targets",t.Validate="validate",t.Generate="generate"}(e.AuthenticationMethodTotpState||(e.AuthenticationMethodTotpState={})),function(t){t.RedirectTypeNameBind="bind",t.RedirectTypeNameAuthenticate="auth",t.RedirectTypeNameBindOrAuthenticate="bind_or_auth",t.RedirectTypeNameInvokePolicy="invoke"}(o=e.RedirectTypeName||(e.RedirectTypeName={})),e.RedirectTypeMap=((n={})[o.RedirectTypeNameBind]=t.RedirectType.RedirectTypeBind,n[o.RedirectTypeNameAuthenticate]=t.RedirectType.RedirectTypeAuthenticate,n[o.RedirectTypeNameBindOrAuthenticate]=t.RedirectType.RedirectTypeBindOrAuthenticate,n[o.RedirectTypeNameInvokePolicy]=t.RedirectType.RedirectTypeInvokePolicy,n),function(t){t[t.EncryptionStateError=23]="EncryptionStateError",t[t.UserIdTokenExpired=29]="UserIdTokenExpired",t[t.DeviceKeyExpired=2017]="DeviceKeyExpired"}(e.ServerResponseErrorCode||(e.ServerResponseErrorCode={})),function(t){t[t.NotRegistered=1]="NotRegistered",t[t.InvalidAction=2]="InvalidAction",t[t.BadConfig=3]="BadConfig",t[t.BadFch=4]="BadFch",t[t.FailedAssertion=5]="FailedAssertion",t[t.MethodLocked=6]="MethodLocked",t[t.DataMissing=7]="DataMissing",t[t.Internal=9]="Internal",t[t.HistoryRepeat=11]="HistoryRepeat",t[t.ExternalProcessPending=13]="ExternalProcessPending",t[t.MustRegister=14]="MustRegister",t[t.NotFinished=16]="NotFinished",t[t.MissingQuestions=17]="MissingQuestions",t[t.RepeatCurrentStep=18]="RepeatCurrentStep",t[t.FailOver=19]="FailOver",t[t.AssertionContainerNotComplete=20]="AssertionContainerNotComplete",t[t.AckRequired=22]="AckRequired"}(e.AssertionErrorCode||(e.AssertionErrorCode={})),function(t){t.Pending="pending",t.Approved="approved",t.Denied="declined",t.Expired="expired"}(e.ServerResponseDataApprovalsApprovalStatus||(e.ServerResponseDataApprovalsApprovalStatus={})),function(t){t.RecentlyUsed="recently_used",t.NoRecentActivity="no_recent_activity",t.LongInactivity="long_inactivity",t.Disabled="disabled",t.Removed="removed"}(e.DeviceStatusServerFormat||(e.DeviceStatusServerFormat={})),function(t){t.ErrorReasonAttestationReverificationFailed="attestation_verification_failed",t.ErrorReasonCredentialFiltered="credential_filtered"}(e.ServerResponseDataErrorReasonReasons||(e.ServerResponseDataErrorReasonReasons={})),function(t){t.Active="active",t.Disabled="disabled"}(e.CollectorState||(e.CollectorState={}))}(e.Protocol||(e.Protocol={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._styleSheet=n.merge.apply(n,t),this.replaceRefValues()}return n.prototype.getMatchingStyle=function(e){var n=this;if(null!=this._styleSheet.styles){var o={};return this._styleSheet.styles.forEach((function(t){var r=n.matchStyle(e,t);o=G(G({},o),r)})),new t.impl.UIStyleImpl(o)}return t.impl.UIStyleImpl.emptyStyle()},n.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={styles:[],values:{}};return t.forEach((function(t){var e;(e=n.styles).push.apply(e,t.styles),n.values=G(G({},n.values),t.values)})),n},n.prototype.matchStyle=function(t,e){return e.rule.tags.every((function(e){return t.indexOf(e)>-1}))?e.properties:{}},n.prototype.replaceRefValues=function(){var t=this;null!=this._styleSheet.values&&this._styleSheet.styles&&this._styleSheet.styles.forEach((function(e){e.properties=t.replaceStyleProperties(e.properties)}))},n.prototype.replaceRef=function(t){return e.Protocol.isRefType(t)?this._styleSheet.values[t.ref]:t},n.prototype.replaceStyleProperties=function(t){var e=t;for(var n in t)e[n]=this.replaceRef(t[n]);return e},n}();e.UIStyleSheets=n}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n={hide:t.ActionEscapeOptionPresentation.Hide,action:t.ActionEscapeOptionPresentation.Action,cancel:t.ActionEscapeOptionPresentation.Cancel,custom:t.ActionEscapeOptionPresentation.Custom},o=function(){function t(t){this._id=t.id,this._displayName=t.display_name,this._presentation=n[t.presentation]}return t.prototype.getId=function(){return this._id},t.prototype.getDisplayName=function(){return this._displayName},t.prototype.getPresentation=function(){return this._presentation},t}();e.EscapeOptionImpl=o}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getDisplayName=function(){return this._displayName},n.prototype.setDisplayName=function(t){this._displayName=t},n.create=function(e){return t.ts.mobile.sdk.impl.Fido2InputResponseImpl.create(e)},n.__tarsusInterfaceName="Fido2InputResponse",n}(e.InputResponseType);e.Fido2InputResponse=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setDisplayName(t),n},e}(t.Fido2InputResponse);e.Fido2InputResponseImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPrompt=function(){return this._prompt},n.prototype.setPrompt=function(t){this._prompt=t},n.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},n.prototype.setCancelButtonTitle=function(t){this._cancelButtonTitle=t},n.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},n.prototype.setFallbackButtonTitle=function(t){this._fallbackButtonTitle=t},n.prototype.getFallbackControlRequestType=function(){return this._fallbackControlRequestType},n.prototype.setFallbackControlRequestType=function(t){this._fallbackControlRequestType=t},n.create=function(e){return t.ts.mobile.sdk.impl.FingerprintInputImpl.create(e)},n.createFallbackEnabledPrompt=function(e,n,o){return t.ts.mobile.sdk.impl.FingerprintInputImpl.createFallbackEnabledPrompt(e,n,o)},n.__tarsusInterfaceName="FingerprintInput",n}(e.InputResponseType);e.FingerprintInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.create=function(t){var e=new n;return t&&e.setPrompt(t),e},n.createFallbackEnabledPrompt=function(e,o,r){var i=new n;return e&&i.setPrompt(e),o&&i.setFallbackButtonTitle(o),r?i.setFallbackControlRequestType(r):i.setFallbackControlRequestType(t.ControlRequestType.SelectMethod),i},n}(t.FingerprintInput);e.FingerprintInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getJsonData=function(){return this._jsonData},e.prototype.setJsonData=function(t){this._jsonData=t},e.prototype.getControlRequest=function(){return this._controlRequest},e.prototype.setControlRequest=function(t){this._controlRequest=t},e.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},e.prototype.setActionEscapeRequest=function(t){this._actionEscapeRequest=t},e.createFormInputSubmissionRequest=function(e){return t.ts.mobile.sdk.impl.FormInputImpl.createFormInputSubmissionRequest(e)},e.createFormCancellationRequest=function(){return t.ts.mobile.sdk.impl.FormInputImpl.createFormCancellationRequest()},e.createEscapeRequest=function(e,n){return t.ts.mobile.sdk.impl.FormInputImpl.createEscapeRequest(e,n)},e.__tarsusInterfaceName="FormInput",e}();e.FormInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createFormInputSubmissionRequest=function(e){var o=new n;return o.setJsonData(e),o.setControlRequest(t.FormControlRequest.Submit),o},n.createFormCancellationRequest=function(){var e=new n;return e.setControlRequest(t.FormControlRequest.Abort),e},n.createEscapeRequest=function(e,o){var r=new n,i=new t.ActionEscapeRequest;return i.setEscapeOption(e),i.setEscapeParameters(o),r.setActionEscapeRequest(i),r.setControlRequest(t.FormControlRequest.Escape),r},n}(t.FormInput);e.FormInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){};t.GeoLocation=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getResponse=function(){return this._response},e.prototype.setResponse=function(t){this._response=t},e.prototype.getControlRequest=function(){return this._controlRequest},e.prototype.setControlRequest=function(t){this._controlRequest=t},e.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},e.prototype.setActionEscapeRequest=function(t){this._actionEscapeRequest=t},e.createControlResponse=function(e){return t.ts.mobile.sdk.impl.InputOrControlResponseImpl.createControlResponse(e)},e.createEscapeResponse=function(e,n){return t.ts.mobile.sdk.impl.InputOrControlResponseImpl.createEscapeResponse(e,n)},e.createInputResponse=function(e){return t.ts.mobile.sdk.impl.InputOrControlResponseImpl.createInputResponse(e)},e.__tarsusInterfaceName="InputOrControlResponse",e}();e.InputOrControlResponse=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createControlResponse=function(t){var e=new n;return e.setControlRequest(t),e},n.createInputResponse=function(t){var e=new n;return e.setResponse(t),e},n.createEscapeResponse=function(e,o){var r=new n;return r._actionEscapeRequest=new t.ActionEscapeRequest,r._actionEscapeRequest._escapeOption=e,r._actionEscapeRequest._escapeParameters=o,r},n.prototype.isControlRequest=function(){return!!this._controlRequest},n}(t.InputOrControlResponse);e.InputOrControlResponseImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getContinueProcessing=function(){return this._continueProcessing},e.prototype.setContinueProcessing=function(t){this._continueProcessing=t},e.create=function(e){return t.ts.mobile.sdk.impl.JsonDataProcessingResultImpl.create(e)},e.__tarsusInterfaceName="JsonDataProcessingResult",e}();e.JsonDataProcessingResult=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setContinueProcessing(t),n},e}(t.JsonDataProcessingResult);e.JsonDataProcessingResultImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t){this.city=t.city,this.state=t.state,this.country=t.country}return t.prototype.getCity=function(){return this.city},t.prototype.getCountry=function(){return this.country},t.prototype.getState=function(){return this.state},t}();t.LocationAttributesImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(t){this._deviceInfo=new e.DeviceInfoImpl(t)}return n.prototype.getInfo=function(){return this._deviceInfo},n.prototype.getAvailableActions=function(){if(this._deviceInfo.getStatus()==t.DeviceStatus.Removed)return[];var e=[t.DeviceManagementAction.Rename];return this._deviceInfo.getIsCurrent()||e.push(t.DeviceManagementAction.Remove),e},n}();e.ManagedDeviceImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(n){switch(this._approval=new e.MobileApprovalImpl(n),this._approval.getStatus()){case t.MobileApprovalStatus.Pending:this._availableActions=[t.MobileApprovalAction.Approve,t.MobileApprovalAction.Deny];break;default:this._availableActions=[]}}return n.prototype.getApproval=function(){return this._approval},n.prototype.getAvailableActions=function(){return this._availableActions},n}();e.ManagedMobileApprovalImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(n){if(this._originDevice=null,this._approvalId=n.approval_id,this._source=n.source,this._title=n.title,this._details=n.details,this._creationTime=n.create,this._finishTime=n.finish,this._expiresAt=n.create+1e3*n.expiry_in,this._originAppId=n.origin_app_id,this._customParams=n.custom_params,n.origin_device&&(this._originDevice=t.TargetDeviceDetailsImpl.fromServerFormat(n.origin_device)),n.location){var o=new t.GeoLocation;o.longitude=n.location.lng,o.latitude=n.location.lat,this._location=o}switch(n.status){case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Approved:this._status=t.MobileApprovalStatus.Approved;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Denied:this._status=t.MobileApprovalStatus.Denied;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Expired:this._status=t.MobileApprovalStatus.Expired;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Pending:this._status=t.MobileApprovalStatus.Pending;break;default:throw new e.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown approval status "+n.status)}}return n.prototype.getApprovalId=function(){return this._approvalId},n.prototype.getSource=function(){return this._source},n.prototype.getTitle=function(){return this._title},n.prototype.getDetails=function(){return this._details},n.prototype.getCreationTime=function(){return this._creationTime},n.prototype.getFinishTime=function(){return this._finishTime},n.prototype.getExpiresAt=function(){return this._expiresAt},n.prototype.getOriginAppId=function(){return this._originAppId},n.prototype.getOriginDevice=function(){return this._originDevice},n.prototype.getLocation=function(){return this._location},n.prototype.getCustomParams=function(){return this._customParams},n.prototype.getStatus=function(){return this._status},n.prototype.isExpired=function(){return this._status==t.MobileApprovalStatus.Expired},n.prototype.updateStatus=function(t){this._status=t},n}();e.MobileApprovalImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="MobileApproveInput",e}(t.InputResponseType);t.MobileApproveInput=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPollingTimeout=function(){return this._pollingTimeout},n.prototype.setPollingTimeout=function(t){this._pollingTimeout=t},n.createRequestPollingInput=function(){return t.ts.mobile.sdk.impl.MobileApproveInputRequestPollingImpl.createRequestPollingInput()},n.createRequestLongPollingInput=function(e){return t.ts.mobile.sdk.impl.MobileApproveInputRequestPollingImpl.createRequestLongPollingInput(e)},n.__tarsusInterfaceName="MobileApproveInputRequestPolling",n}(e.MobileApproveInput);e.MobileApproveInputRequestPolling=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createRequestPollingInput=function(){var t=new e;return t.setPollingTimeout(0),t},e.createRequestLongPollingInput=function(t){var n=new e;return n.setPollingTimeout(t),n},e}(t.MobileApproveInputRequestPolling);e.MobileApproveInputRequestPollingImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(t,e,n){this.value=t,this.format=e,this.alt=n}return e.prototype.getValue=function(){return this.value},e.prototype.getFormat=function(){return this.format},e.prototype.getQrAlternativeRepresentation=function(){return this.alt},e.createFromServerFormat=function(n){var o=t.OtpFormatImpl.fromAssertionFormat(n.format),r=null;return(n.alt||[]).forEach((function(t){"qr_text"===t.type&&(r=t.value)})),new e(n.value,o,r)},e}();e.MobileApproveOtpImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e,n;e=t.impl||(t.impl={}),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.userId=function(){return this._userId},e.prototype.title=function(){return this._title},e.prototype.body=function(){return this._body},e.prototype.source=function(){return this._source},e.prototype.ticket=function(){return this._ticket},e.createWithUserId=function(t){var n=new e;return n._userId=t,n},e.createWithUserTicket=function(t){var n=new e;return n._userId=t,n},e.createWithJsonPayload=function(t){var n=t,o=new e;return o._userId=n.user_id,o._title=n.body,o._body=n.details,o._source=n.source,o},e}(t.MobileApprovePushRequestPayload),e.MobileApprovePushRequestPayloadImpl=n}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPrompt=function(){return this._prompt},n.prototype.setPrompt=function(t){this._prompt=t},n.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},n.prototype.setCancelButtonTitle=function(t){this._cancelButtonTitle=t},n.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},n.prototype.setFallbackButtonTitle=function(t){this._fallbackButtonTitle=t},n.prototype.getFallbackControlRequestType=function(){return this._fallbackControlRequestType},n.prototype.setFallbackControlRequestType=function(t){this._fallbackControlRequestType=t},n.create=function(e){return t.ts.mobile.sdk.impl.NativeFaceInputImpl.create(e)},n.createFallbackEnabledPrompt=function(e,n,o){return t.ts.mobile.sdk.impl.NativeFaceInputImpl.createFallbackEnabledPrompt(e,n,o)},n.__tarsusInterfaceName="NativeFaceInput",n}(e.InputResponseType);e.NativeFaceInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.create=function(t){var e=new n;return t&&e.setPrompt(t),e},n.createFallbackEnabledPrompt=function(e,o,r){var i=new n;return e&&i.setPrompt(e),o&&i.setFallbackButtonTitle(o),r?i.setFallbackControlRequestType(r):i.setFallbackControlRequestType(t.ControlRequestType.SelectMethod),i},n}(t.NativeFaceInput);e.NativeFaceInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function e(){}return e.fromAssertionFormat=function(e){switch(e.type){case t.core.Protocol.OtpFormatType.Numeric:return new n(e.length);case t.core.Protocol.OtpFormatType.QrCode:return new o;case t.core.Protocol.OtpFormatType.External:return new i(e.data);default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid format type encountered: "+e.type)}},e}();t.OtpFormatImpl=e;var n=function(){function t(t){this._length=t}return t.prototype.getOtpLength=function(){return this._length},t.prototype.getType=function(){return r.Numeric},t.__tarsusInterfaceName="OtpFormatNumeric",t}();t.OtpFormatNumericImpl=n;var o=function(){function t(){}return t.prototype.getType=function(){return r.QrCode},t.__tarsusInterfaceName="OtpFormatQr",t}();t.OtpFormatQrImpl=o;var r,i=function(){function t(t){this._data=t}return t.prototype.getData=function(){return this._data},t.prototype.getType=function(){return r.External},t.__tarsusInterfaceName="OtpFormatExternal",t}();t.OtpFormatExternalImpl=i,function(t){t[t.Numeric=0]="Numeric",t[t.QrCode=1]="QrCode",t[t.External=2]="External"}(r=t.OtpFormatType||(t.OtpFormatType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getOtp=function(){return this._otp},n.prototype.setOtp=function(t){this._otp=t},n.createOtpSubmission=function(e){return t.ts.mobile.sdk.impl.OtpInputOtpSubmissionImpl.createOtpSubmission(e)},n.__tarsusInterfaceName="OtpInputOtpSubmission",n}(e.OtpInput);e.OtpInputOtpSubmission=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createOtpSubmission=function(t){var n=new e;return n.setOtp(t),n},e}(t.OtpInputOtpSubmission);e.OtpInputOtpSubmissionImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createOtpResendRequest=function(){return t.ts.mobile.sdk.impl.OtpInputRequestResendImpl.createOtpResendRequest()},n.__tarsusInterfaceName="OtpInputRequestResend",n}(e.OtpInput);e.OtpInputRequestResend=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createOtpResendRequest=function(){return new e},e}(t.OtpInputRequestResend);e.OtpInputRequestResendImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="OtpPushRequestPayload",e}(t.PushRequestPayload);t.OtpPushRequestPayload=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e,n;e=t.impl||(t.impl={}),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.userId=function(){return this._userId},e.prototype.title=function(){return this._title},e.prototype.body=function(){return this._body},e.createWithJsonPayload=function(t){var n=t,o=new e;return o._userId=n.user_id,o._title=n.title,o._body=n.body,o},e}(t.OtpPushRequestPayload),e.OtpPushRequestPayloadImpl=n}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPassword=function(){return this._password},n.prototype.setPassword=function(t){this._password=t},n.create=function(e){return t.ts.mobile.sdk.impl.PasswordInputImpl.create(e)},n.__tarsusInterfaceName="PasswordInput",n}(e.InputResponseType);e.PasswordInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setPassword(t),n},e}(t.PasswordInput);e.PasswordInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPatternDescription=function(){return this._patternDescription},n.prototype.setPatternDescription=function(t){this._patternDescription=t},n.create=function(e){return t.ts.mobile.sdk.impl.PatternInputImpl.create(e)},n.__tarsusInterfaceName="PatternInput",n}(e.InputResponseType);e.PatternInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return V(o,n),o.create=function(t){var e=new o;return e.setPatternDescription(t),e},o.validateFormat=function(t){return null!=t.getPatternDescription().match(/^(r:[0-9]+,c:[0-9]+)+$/)},o.getPatternLength=function(n){if(o.validateFormat(n))return n.getPatternDescription().match(/r/g).length;throw new e.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern input.")},o}(t.PatternInput);e.PatternInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPin=function(){return this._pin},n.prototype.setPin=function(t){this._pin=t},n.create=function(e){return t.ts.mobile.sdk.impl.PinInputImpl.create(e)},n.__tarsusInterfaceName="PinInput",n}(e.InputResponseType);e.PinInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setPin(t),n},e}(t.PinInput);e.PinInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createSuccessResponse=function(e){var n=new t.PlaceholderAuthSuccessResponse;return n.setPlaceholderToken(e),n},n.createdFailedResponse=function(e,n){var o=new t.PlaceholderAuthFailureResponse;return o.setFailureError(n),o.setExpired(e.getExpired()),o.setLocked(e.getLocked()),o.setRegistered(e.getRegistered()),o.setRegistrationStatus(e.getRegistrationStatus()),o},n.createFailedResponseWithServerProvidedStatus=function(e){var n=new t.PlaceholderAuthFailureWithServerProvidedStatusResponse;return n.setFailureError(e),n},n}(t.PlaceholderInputResponse);e.PlaceholderInputResponseImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){};function n(t){return!!t.createContinuation}t.Continuation=e,t.IsResumableProcess=n;var o=function(){function t(t,e){this._ctxt=t}return Object.defineProperty(t.prototype,"rtContext",{get:function(){return this._ctxt},enumerable:!1,configurable:!0}),t.prototype.resume=function(t,e){return t instanceof s?(this._currentStep=t.currentStepContinuation.createResumableProcess(this),this.pumpSteps(this._currentStep.resume(t.currentStepContinuation,e))):Promise.reject("Attempt to resume a MultiStageResumableProcess with a bad continuation class.")},t.prototype.startWithStage=function(t){return this._currentStep=t,this.pumpSteps(t.run())},t.prototype.pumpSteps=function(t){var e=this;return t.then((function(t){return i(t)?(e._currentStep=t,e.pumpSteps(t.run())):t}))},t}();t.MultiStageResumableProcess=o;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e}(e);function i(t){return n(t)&&t.run}t.ResumableProcessStageContinuation=r,t.IsResumableProcessStage=i;var s=function(e){function n(n){var o=e.call(this)||this;return n instanceof t.SerializationContext?o.serializeFrom(n):o._currentStepContinuation=n._currentStep.createContinuation(),o}return V(n,e),n.prototype.serializeTo=function(t){t.writeObject("currentStepContinuation",this._currentStepContinuation)},n.prototype.serializeFrom=function(t){this._currentStepContinuation=t.readNonNullObject("currentStepContinuation")},Object.defineProperty(n.prototype,"currentStepContinuation",{get:function(){return this._currentStepContinuation},enumerable:!1,configurable:!0}),n}(e);t.MultiStageResumableProcessContinuation=s}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){function e(t,e){this._controlFlowProcessor=t,this._action=e,this._sdk=this._controlFlowProcessor._sdk,this._uiHandler=this._controlFlowProcessor._uiHandler,this._clientContext=this._controlFlowProcessor._clientContext}return e.prototype.cancelRun=function(){},e.prototype.policyAction=function(){return this._policyAction||(this._policyAction=t.impl.PolicyActionImpl.fromServerAction(this._controlFlowProcessor,this._action)),this._policyAction},e.prototype.processEscapeRequest=function(e){var n=this;return new Promise((function(o,r){var i=e.getEscapeOption().getId();n._sdk.log(t.LogLevel.Debug,(function(){return"Processing escape reques "+i}));for(var s=n._policyAction.getEscapeOptions(),a=!1,u=0;u<s.length;u++)if(s[u].getId()===i){a=!0;break}a?n.sendAssertionEscapeRequest(e).then(o,r):r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to invoke an invalid escape option "+i))}))},e.prototype.sendPollingRequest=function(e,n){var o=this._controlFlowProcessor.createPollingRequest(e,n);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(o).then((function(t){return t.data})))},e.prototype.sendAssertionRequest=function(e,n,o){var r=this._controlFlowProcessor.createAssertionRequest(this._action,e,n,o);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(r).then((function(e){if(!e.data)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Communication,"Invalid response to assertion.",{responseBody:JSON.stringify(e)});return e.data})))},e.prototype.sendErrorReportAssertionRequest=function(t){var e={client_error:t};return this.sendAssertionRequest("report_error",e)},e.prototype.sendAssertionEscapeRequest=function(e){var n=this._controlFlowProcessor.createAssertionRequest(this._action,"escape",{escape_id:e.getEscapeOption().getId(),escape_params:e.getEscapeParameters()});return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(n).then((function(e){if(!e.data)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Communication,"Invalid response to assertion.",{responseBody:JSON.stringify(e)});return e.data})))},e}();e.ActionDriver=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){};e.ResumableProcessActionDriverRuntimeContext=n;var o=function(e){function n(n){var o=e.call(this)||this;return n instanceof t.SerializationContext?o.serializeFrom(n):o._actionData=n,o}return V(n,e),n.prototype.serializeTo=function(t){t.writePrimitive("actionData",this._actionData)},n.prototype.serializeFrom=function(t){this._actionData=t.readPrimitive("actionData")},Object.defineProperty(n.prototype,"actionData",{get:function(){return this._actionData},enumerable:!1,configurable:!0}),n}(t.Continuation);e.ResumableProcessActionContinuation=o;var r=function(t){function e(e,r){return e instanceof n&&(e=e.controlFlowProcessor),r instanceof o&&(r=r.actionData),t.call(this,e,r)||this}return V(e,t),e}(e.ActionDriver);e.ResumableProcessActionDriver=r}(t.actiondrivers||(t.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var z=f&&f.__decorate||function(t,n,o,r){var i,s=arguments.length,a=s<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,o,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(a=(s<3?i(a):s>3?i(n,o,a):i(n,o))||a);return s>3&&a&&Object.defineProperty(n,o,a),a},J=f&&f.__metadata||function(t,n){if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)};!function(t){!function(t){!function(t){var e;(function(t){var n=function(){};t.ControlFlowProcessorRuntimeContext=n;var o=function(){function n(n,o,r,i,s){if(n instanceof t.SerializationContext)this.serializeFrom(n);else{if(!(o&&r&&void 0!==i&&s))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid arguments passed to ControlFlowProcessorContinuation ctor");this._initiatingRequest=n,this._initialCflowResponse=o,this._controlFlow=r,this._currentControlFlowStep=i,this._actionContinuation=s.createContinuation()}}return Object.defineProperty(n.prototype,"initiatingRequest",{get:function(){return this._initiatingRequest},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"initialCflowResponse",{get:function(){return this._initialCflowResponse},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controlFlow",{get:function(){return this._controlFlow},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentControlFlowStep",{get:function(){return this._currentControlFlowStep},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"actionContinuation",{get:function(){return this._actionContinuation},enumerable:!1,configurable:!0}),n.prototype.createResumableProcess=function(t){return new r(t)},n.prototype.serializeTo=function(t){t.writeObject("intiatingRequest",this._initiatingRequest),t.writePrimitive("initialCflowResponse",this._initialCflowResponse),t.writePrimitive("controlFlow",this._controlFlow),t.writePrimitive("currentControlFlowStep",this._currentControlFlowStep),t.writeObject("actionContinuation",this._actionContinuation)},n.prototype.serializeFrom=function(e){this._initiatingRequest=e.readObject(t.SessionExchangeRequest,"intiatingRequest"),this._initialCflowResponse=e.readPrimitive("initialCflowResponse"),this._controlFlow=e.readPrimitive("controlFlow"),this._currentControlFlowStep=e.readPrimitive("currentControlFlowStep"),this._actionContinuation=e.readNonNullObject("actionContinuation")},n=z([t.Serializable("ControlFlowProcessorContinuation"),J("design:paramtypes",[Object,Object,Array,Number,t.actiondrivers.ResumableProcessActionDriver])],n)}(),r=function(){function r(t,e,o,r){if(this._cancelled=!1,!(t instanceof n)){var i=t;(t=new n).sdk=i,t.cflowRequestContext=r||null,t.clientContext=o,t.session=e,t.uiHandler=i.currentUiHandler}this._sdk=t.sdk,this._session=t.session,this._uiHandler=t.uiHandler,this._clientContext=t.clientContext,this._requestContext=t.cflowRequestContext}return r.findByClientContext=function(t){var e=r._allRunningControlFlows.filter((function(e){return e._clientContext==t}));return e.length?e[0]:null},r.prototype.createContinuation=function(){if(this._cancelled)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Cannot create continuation for cancelled control flow");if(!this._currentActionDriver)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Cannot create continuation for control flow without current action");if(this._currentActionDriver instanceof t.actiondrivers.ResumableProcessActionDriver)return new o(this._initiatingRequest,this._initialCflowResponse,this._controlFlow,this._currentControlFlowStep,this._currentActionDriver);throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Cannot create continuation for control flow running current action "+this._currentActionDriver._action.type)},Object.defineProperty(r.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"initiatingRequest",{get:function(){return this._initiatingRequest},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"requestContext",{get:function(){return this._requestContext},enumerable:!1,configurable:!0}),r.prototype.cancelFlow=function(){this._cancelled=!0,this._currentActionDriver&&this._currentActionDriver.cancelRun(),this._uiHandler.controlFlowCancelled(this._clientContext)},r.prototype.startControlFlow=function(n){var o,r=this;if(this._cancelled)return this.createExternalCancellationRejectionPromise();var i=null;return n instanceof t.SessionExchangeRequest?(i=n,o=e.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,this._session.performSessionExchange(n))):o=this._session.processInlineResponse(n),o.then((function(t){return r._initialCflowResponse=t.data,r._initiatingRequest=i,r.executeControlFlow(r._initialCflowResponse)}))},r.prototype.resume=function(n,r){var i=this;return new Promise((function(s,a){if(!(n instanceof o))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid continuation type provided to resume()");i._initiatingRequest=n.initiatingRequest,i._initialCflowResponse=n.initialCflowResponse,i._controlFlow=n.controlFlow,i._currentControlFlowStep=n.currentControlFlowStep;var u=new t.actiondrivers.ResumableProcessActionDriverRuntimeContext;u.controlFlowProcessor=i;var c=n.actionContinuation.createResumableProcess(u);i._currentActionDriver=c,c.resume(n.actionContinuation,r).then((function(t){return i.executeControlFlow(t)})).then(s,a)}))},Object.defineProperty(r.prototype,"challenge",{get:function(){return this._initialCflowResponse&&this._initialCflowResponse.challenge||null},enumerable:!1,configurable:!0}),r.prototype.executeControlFlow=function(t){var e=this;return new Promise((function(n,o){r._allRunningControlFlows.push(e),e._uiHandler.controlFlowStarting(e._clientContext),e.processSingleStepExchange(t).then((function(t){return e._uiHandler.controlFlowEnded(null,e._clientContext),t}),(function(t){throw e._uiHandler.controlFlowEnded(t,e._clientContext),t})).finally((function(){var t=r._allRunningControlFlows.indexOf(e);r._allRunningControlFlows.splice(t,1)})).then(n,o)}))},r.prototype.processSingleStepExchange=function(n){var o,r=this;return n.control_flow&&(this._controlFlow=n.control_flow,this._currentControlFlowStep=0,this._sdk.log(e.LogLevel.Debug,(function(){return"Got ControlFlow with "+r._controlFlow.length+" steps."}))),n.data&&n.data.json_data?(this._sdk.log(e.LogLevel.Debug,(function(){return"Got a JSON data attachment on control flow response. Processing."})),o=t.actiondrivers.ActionDriverJsonData.handleJsonDataByUiHandler(this._uiHandler,n,n.data.json_data,null,this._clientContext)):o=Promise.resolve(n),o.then((function(o){switch(n.state){case t.Protocol.AuthSessionState.Pending:return r._sdk.log(e.LogLevel.Debug,(function(){return"Execute step "+r._currentControlFlowStep+"."})),(i=r._controlFlow[r._currentControlFlowStep])?r._cancelled?r.createExternalCancellationRejectionPromise():r.promiseCancellableSingleActionProcessing(i).then((function(t){return r._currentControlFlowStep++,r.processSingleStepExchange(t)})):(r._sdk.log(e.LogLevel.Error,(function(){return"Step "+r._currentControlFlowStep+" nonexisting."})),Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Session state is pending but no control flow.")));case t.Protocol.AuthSessionState.Rejected:r._sdk.log(e.LogLevel.Debug,(function(){return"Handle control flow rejection."}));var i=r._controlFlow&&r._controlFlow[r._currentControlFlowStep]||null;return r._uiHandler.handlePolicyRejection(n.rejection_data&&n.rejection_data.title||null,n.rejection_data&&n.rejection_data.text||null,n.rejection_data&&n.rejection_data.button_text||null,n.failure_data,i?e.impl.PolicyActionImpl.fromServerAction(r,i):e.impl.PolicyActionImpl.createPseudoAction(r._sdk,"rejection"),r._clientContext).then((function(t){if(-1!=t.getUserChoice())throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"ConfirmationInput.getUserChoice must be set to -1.");throw e.impl.AuthenticationErrorImpl.errorForSessionRejectionFailureData(n.failure_data)}));case t.Protocol.AuthSessionState.Completed:return r._sdk.log(e.LogLevel.Debug,(function(){return"Handle control flow completion."})),Promise.resolve(e.impl.AuthenticationResultImpl.fromCflowServerResponse(n,r._session.deviceId()))}}))},r.prototype.promiseCancellableSingleActionProcessing=function(n){var o=this,r=t.actiondrivers.ActionDrivers[n.type];if(!r)return Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Don't know how to handle action.",{actionType:n.type}));var i=new r(this,n);return this._currentActionDriver=i,this._uiHandler.controlFlowActionStarting(i.policyAction(),this._clientContext),i.run().then((function(t){return o._uiHandler.controlFlowActionEnded(null,i.policyAction(),o._clientContext),t}),(function(t){var r=e.impl.AuthenticationErrorImpl.augmentErrorData(t,{});throw r.setPublicProperty(e.AuthenticationErrorProperty.AuthenticationErrorFailingActionType,n.type),o._uiHandler.controlFlowActionEnded(r,i.policyAction(),o._clientContext),r})).finally((function(){o._currentActionDriver=null}))},r.prototype.createAssertionRequest=function(n,o,r,i){var s;if(!this.challenge)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to create an assertion request without an initial control flow request.");var a={action:n.type,assert:o||"action",assertion_id:n.assertion_id,fch:this.challenge};if(r&&(a.data=r),i){var u=a;for(var c in i)u[c]=i[c]}return new t.SessionExchangeRequest("POST","auth/assert",a,[],null===(s=this.requestContext)||void 0===s?void 0:s.getFlowId())},r.prototype.createPollingRequest=function(e,n){var o,r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),r.polling_timeout=n,new t.SessionExchangeRequest("POST","auth/poll",r,[],null===(o=this.requestContext)||void 0===o?void 0:o.getFlowId())},r.prototype.createExternalCancellationRejectionPromise=function(){return Promise.reject(this.createExternalCancellationError())},r.prototype.createExternalCancellationError=function(){return new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.UserCanceled,"Operation cancelled by user.",{control_flow_external_cancellation:!0})},r.prototype.generateDebugPin=function(){var e=this;return new Promise((function(n,o){var r=new t.SessionExchangeRequest("POST","auth/create_debug_token",{},[]);e._session.performSessionExchange(r).then((function(t){return t.data.debug_pin})).then(n,o)}))},r._allRunningControlFlows=[],r}();t.ControlFlowProcessor=r})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.impl||(o.impl={}),n=function(){function t(t,n,o,r,i,s){void 0===r&&(r=!1),void 0===i&&(i=null),void 0===s&&(s=null),this._isPseudoAction=!1,this._escapeOptions=[],this._actionType=n,this._isPseudoAction=r,this._actionLocalStrings=i,this._actionLocalStyles=s,this._uiContextImpl=new e.UIContextImpl(t,this._actionLocalStrings||void 0,this._actionLocalStyles),this._controlFlow=o}return t.prototype.getIsPseudoAction=function(){return this._isPseudoAction},t.prototype.getActionType=function(){return this._actionType},t.prototype.getAltLabel=function(){return""},t.prototype.getUiContext=function(){return this._uiContextImpl},t.prototype.getEscapeOptions=function(){return this._escapeOptions},t.prototype.escapeOptionById=function(t){var n=null;if(this._escapeOptions.forEach((function(e){e.getId()===t&&(n=e)})),!n)throw new e.AuthenticationErrorImpl(o.AuthenticationErrorCode.AppImplementation,"Invalid escape ID "+t+" for this action.");return n},Object.defineProperty(t.prototype,"controlFlow",{get:function(){return this._controlFlow},enumerable:!1,configurable:!0}),t.fromServerAction=function(n,o){var r=new t(n.sdk,o.type,n,!1,o.strings,o.styles);return o.escapes&&(r._escapeOptions=o.escapes.map((function(t){return new e.EscapeOptionImpl(t)}))),r},t.createPseudoAction=function(e,n){return new t(e,n,null,!0)},t}(),e.PolicyActionImpl=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getControlRequest=function(){return this._controlRequest},e.prototype.setControlRequest=function(t){this._controlRequest=t},e.prototype.getSelectedAuthenticator=function(){return this._selectedAuthenticator},e.prototype.setSelectedAuthenticator=function(t){this._selectedAuthenticator=t},e.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},e.prototype.setActionEscapeRequest=function(t){this._actionEscapeRequest=t},e.createControlResponse=function(e){return t.ts.mobile.sdk.impl.PromotionInputImpl.createControlResponse(e)},e.createEscapeRequest=function(e,n){return t.ts.mobile.sdk.impl.PromotionInputImpl.createEscapeRequest(e,n)},e.createAuthenticatorDescription=function(e){return t.ts.mobile.sdk.impl.PromotionInputImpl.createAuthenticatorDescription(e)},e.__tarsusInterfaceName="PromotionInput",e}();e.PromotionInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.isControlRequest=function(){return!(void 0===this._controlRequest||null===this._controlRequest)},n.createControlResponse=function(t){var e=new n;return e.setControlRequest(t),e},n.createAuthenticatorDescription=function(t){var e=new n;return e.setSelectedAuthenticator(t),e},n.createEscapeRequest=function(e,o){var r=new n;return r._actionEscapeRequest=new t.ActionEscapeRequest,r._actionEscapeRequest._escapeOption=e,r._actionEscapeRequest._escapeParameters=o,r},n}(t.PromotionInput);e.PromotionInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function e(){}return e.fromAssertionFormat=function(e){switch(e){case t.core.Protocol.QrCodeFormatType.Numeric:return t.QrCodeFormat.Numeric;case t.core.Protocol.QrCodeFormatType.Alphanumeric:return t.QrCodeFormat.Alphanumeric;case t.core.Protocol.QrCodeFormatType.Binary:return t.QrCodeFormat.Binary;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid qr code format type encountered: "+e.type)}},e}();t.QrCodeFormatImpl=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getQrCode=function(){return this._qrCode},e.prototype.getQrCodeFormat=function(){return this._qrCodeFormat},e.createQrCodeResult=function(e,n){return t.ts.mobile.sdk.impl.QrCodeResultImpl.createQrCodeResult(e,n)},e.__tarsusInterfaceName="QrCodeResult",e}();e.QrCodeResult=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createQrCodeResult=function(t,n){var o=new e;return o._qrCode=t,o._qrCodeFormat=n,o},e}(t.QrCodeResult);e.QrCodeResultImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getRedirectResponse=function(){return this._redirectResponse},e.prototype.setRedirectResponse=function(t){this._redirectResponse=t},e.prototype.getAdditionalParametersOverride=function(){return this._additionalParametersOverride},e.prototype.setAdditionalParametersOverride=function(t){this._additionalParametersOverride=t},e.create=function(e){return t.ts.mobile.sdk.impl.RedirectInputImpl.create(e)},e.__tarsusInterfaceName="RedirectInput",e}();e.RedirectInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setRedirectResponse(t),n},e}(t.RedirectInput);e.RedirectInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getServerAddress=function(){return this._serverAddress},e.prototype.setServerAddress=function(t){this._serverAddress=t},e.prototype.getRealm=function(){return this._realm},e.prototype.setRealm=function(t){this._realm=t},e.prototype.getAppId=function(){return this._appId},e.prototype.setAppId=function(t){this._appId=t},e.prototype.getTokenName=function(){return this._tokenName},e.prototype.setTokenName=function(t){this._tokenName=t},e.prototype.getToken=function(){return this._token},e.prototype.setToken=function(t){this._token=t},e.prototype.getCryptoMode=function(){return this._cryptoMode},e.prototype.setCryptoMode=function(t){this._cryptoMode=t},e.create=function(e,n,o,r){return t.ts.mobile.sdk.impl.SDKConnectionSettingsImpl.create(e,n,o,r)},e.createWithCryptoMode=function(e,n,o,r,i){return t.ts.mobile.sdk.impl.SDKConnectionSettingsImpl.createWithCryptoMode(e,n,o,r,i)},e.__tarsusInterfaceName="SDKConnectionSettings",e}();e.SDKConnectionSettings=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.create=function(e,n,o,r){return this.createWithCryptoMode(e,n,o,r,t.ConnectionCryptoMode.None)},n.createWithCryptoMode=function(t,e,o,r,i){var s=new n;return s.setServerAddress(t),s.setAppId(e),s.setTokenName(o),s.setToken(r),s.setCryptoMode(i),s},n.prototype.setSendFlowIdAsHttpHeader=function(t){this.sendFlowIdAsHttpHeader=t},n.prototype.shouldSendFlowIdAsHttpHeader=function(){return this.sendFlowIdAsHttpHeader},n}(t.SDKConnectionSettings);e.SDKConnectionSettingsImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getQrCodeResult=function(){return this._qrCodeResult},n.prototype.setQrCodeResult=function(t){this._qrCodeResult=t},n.createScanQrCodeInput=function(e){return t.ts.mobile.sdk.impl.ScanQrCodeInputImpl.createScanQrCodeInput(e)},n.__tarsusInterfaceName="ScanQrCodeInput",n}(e.InputResponseType);e.ScanQrCodeInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createScanQrCodeInput=function(t){var n=new e;return n.setQrCodeResult(t),n},e}(t.ScanQrCodeInput);e.ScanQrCodeInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createAnswerToQuestion=function(t,n){var o=new e;return o._question=t,o._answer=n,o._isRemoved=!1,o},e.createAnswerRemovalRequest=function(t){var n=new e;return n._question=t,n._isRemoved=!0,n},e}(t.SecurityQuestionAndAnswer);e.SecurityQuestionAndAnswerImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createWithText=function(t){var n=new e;return n._answerText=t,n},e}(t.SecurityQuestionAnswer);e.SecurityQuestionAnswerImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._id=t,this._text=e,this._registered=n}return t.prototype.getSecurityQuestionId=function(){return this._id},t.prototype.getSecurityQuestionText=function(){return this._text},t.prototype.getAnswered=function(){return this._registered},t.__tarsusInterfaceName="SecurityQuestion",t}();t.SecurityQuestionImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createSecurityQuestionAnswersInputResponse=function(e){var n=new t.SecurityQuestionAnswersInputResponse;return n._answers=e,n},n}(t.SecurityQuestionInputResponse);e.SecurityQuestionInputResponseImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getStepTag=function(){return"question"},t.prototype.getSecurityQuestions=function(){return this._securityQuestions},t.prototype.getMinAnswersNeeded=function(){return this._minAnswers},t.prototype.getMaxAnswerLength=function(){return this._maxAnswerLength},t.prototype.getMinAnswerLength=function(){return this._minAnswerLength},t.createForAuthQuestion=function(e){var n=new t;return n._minAnswers=1,n._securityQuestions=[e],n._maxAnswerLength=-1,n._minAnswerLength=-1,n},t.createForRegistrationQuestions=function(e,n,o,r){var i=new t;return i._minAnswers=n,i._securityQuestions=e,i._maxAnswerLength=o,i._minAnswerLength=r,i},t.__tarsusInterfaceName="SecurityQuestionStepDescription",t}();t.SecurityQuestionStepDescriptionImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){var e="undefined"!=typeof window?window:e;e.com=t}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t){this._hex=t.hex||"",t.alpha&&(this._hex=this._hex.slice(0,1)+this.convertAlpha(t.alpha)+this._hex.slice(1))}return t.prototype.getHexValue=function(){return this._hex},t.prototype.convertAlpha=function(t){return Math.ceil(255*t).toString(16)},t}();t.TSColorImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(e,n){var o=t.call(this)||this;return n&&(o._selectedTargets=n),e&&(o._authenticatorInput=e),o}return V(e,t),e.createAuthenticatorInput=function(t){return new e(t,null)},e.createTargetSelectionRequest=function(t){return new e(null,[t])},e.createTargetsSelectionRequest=function(t){return new e(null,t)},e}(t.TargetBasedAuthenticatorInput);e.TargetBasedAuthenticatorInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function e(e,n,o,r,i,s,a){this._deviceId=e,this._model=t.core.DeviceModelConverter.getDeviceModel(n,i),this._isCurrentDevice=r,this._osType=t.core.DeviceModelConverter.getOsName(i),this._osVersion=s,this._lastAccessed=o,this._alias=a}return e.prototype.getDeviceId=function(){return this._deviceId},e.prototype.getModel=function(){return this._model},e.prototype.getLastAccessed=function(){return this._lastAccessed},e.prototype.getIsCurrent=function(){return this._isCurrentDevice},e.prototype.getOsType=function(){return this._osType},e.prototype.getOsVersion=function(){return this._osVersion},e.prototype.getAlias=function(){return this._alias},e.prototype.describe=function(){var t=new Date(this._lastAccessed).toLocaleDateString();return""+(this._alias?this._alias+" : ":"")+this._model+" last accessed on "+t},e.fromServerFormat=function(t){return new e(t.device_id,t.model,t.last_access,t.current_device,t.os_type,t.os_version,t.alias||null)},e}();t.TargetDeviceDetailsImpl=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.createPollRequest=function(){return t.ts.mobile.sdk.impl.TicketWaitInputImpl.createPollRequest()},n.createLongPollRequest=function(e){return t.ts.mobile.sdk.impl.TicketWaitInputImpl.createLongPollRequest(e)},n.__tarsusInterfaceName="TicketWaitInput",n}(e.InputResponseType);e.TicketWaitInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getPollingTimeout=function(){return this._pollingTimeout},e.prototype.setPollingTimeout=function(t){this._pollingTimeout=t},e.__tarsusInterfaceName="TicketWaitInputPollRequest",e}(t.TicketWaitInput);t.TicketWaitInputPollRequest=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createPollRequest=function(){var t=new o;return t.setPollingTimeout(0),t},e.createLongPollRequest=function(t){var e=new o;return e.setPollingTimeout(t),e},e}(t.TicketWaitInput);e.TicketWaitInputImpl=n;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="TicketWaitInputPollRequest",e}(t.TicketWaitInputPollRequest);e.TicketWaitInputPollRequestImpl=o}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Qr=0]="Qr",t[t.Alphanumeric=1]="Alphanumeric"}(t.TicketIdFormat||(t.TicketIdFormat={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(t){this._ticketId=t}return e.prototype.getFormat=function(){switch(this._ticketId.format){case t.core.Protocol.TicketIdFormatType.Alphanumeric:return t.TicketIdFormat.Alphanumeric;case t.core.Protocol.TicketIdFormatType.QrCode:default:return t.TicketIdFormat.Qr}},e.prototype.getValue=function(){return this._ticketId.value},e.prototype.getValueAltRepresentation=function(){return this._ticketId.alt},e}();e.TicketIdImpl=n;var o=function(){function t(t){this._title=t.title,this._text=t.text,this._ticketId=t.ticket_id?new n(t.ticket_id):null}return t.prototype.getTitle=function(){return this._title},t.prototype.getText=function(){return this._text},t.prototype.getTicketId=function(){return this._ticketId},t}();e.TicketWaitingInformationImpl=o}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function e(){}return e.fromAssertionFormat=function(e){switch(e.type){case t.core.Protocol.TotpChallengeFormatType.Numeric:return new o;case t.core.Protocol.TotpChallengeFormatType.QrCode:return new i;case t.core.Protocol.TotpChallengeFormatType.AlphaNumeric:return new n;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid format type encountered: "+e.type)}},e}();t.TotpChallengeFormatImpl=e;var n=function(){function t(){}return t.prototype.getType=function(){return r.AlphaNumeric},t.__tarsusInterfaceName="TotpChallengeFormatAlphaNumeric",t}();t.TotpChallengeFormatAlphaNumericImpl=n;var o=function(){function t(){}return t.prototype.getType=function(){return r.Numeric},t.__tarsusInterfaceName="TotpChallengeFormatNumeric",t}();t.TotpChallengeFormatNumericImpl=o;var r,i=function(){function t(){}return t.prototype.getType=function(){return r.QrCode},t.__tarsusInterfaceName="TotpChallengeFormatQr",t}();t.TotpChallengeFormatQrImpl=i,function(t){t[t.AlphaNumeric=0]="AlphaNumeric",t[t.Numeric=1]="Numeric",t[t.QrCode=2]="QrCode"}(r=t.TotpChallengeFormatType||(t.TotpChallengeFormatType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getChallenge=function(){return this._challenge},n.prototype.setChallenge=function(t){this._challenge=t},n.create=function(e){return t.ts.mobile.sdk.impl.TotpChallengeInputImpl.create(e)},n.__tarsusInterfaceName="TotpChallengeInput",n}(e.InputResponseType);e.TotpChallengeInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setChallenge(t),n},e}(t.TotpChallengeInput);e.TotpChallengeInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.createTotpGenerationRequest=function(e,n,o){var r=new t;return r.setUserId(e.userHandle),r.setChallenge(n),r.setGeneratorName(o),r},t.prototype.getChallenge=function(){return this._challenge},t.prototype.getGeneratorName=function(){return this._generatorName},t.prototype.setGeneratorName=function(t){this._generatorName=t},t.prototype.setChallenge=function(t){this._challenge=t},t.prototype.setUserId=function(t){this._userId=t},t.prototype.getUserId=function(){return this._userId},t.prototype.setUserHandleType=function(t){this._userHandleType=t},t.prototype.getUserHandleType=function(){return this._userHandleType},t}();t.TotpGenerationRequestImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="TotpInput",e}(t.InputResponseType);t.TotpInput=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getCode=function(){return this._code},n.prototype.setCode=function(t){this._code=t},n.createTotpCodeSubmission=function(e){return t.ts.mobile.sdk.impl.TotpInputCodeSubmissionImpl.createTotpCodeSubmission(e)},n.__tarsusInterfaceName="TotpInputCodeSubmission",n}(e.TotpInput);e.TotpInputCodeSubmission=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.createTotpCodeSubmission=function(t){var n=new e;return n.setCode(t),n},e}(t.TotpInputCodeSubmission);e.TotpInputCodeSubmissionImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(){}return e.createEscapeRequest=function(e){var n=new t.TotpProvisionEscapeRequest;return n.setEscapeRequest(e),n},e}();e.TotpProvisionResultImpl=n}(t.impl||(t.impl={}))}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var Q=f&&f.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};!function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._components=t}return t.prototype.toString=function(){return this._components.map((function(t){return t.replace(/([\\.])/g,(function(t){return"\\"+("."==t?"p":t)}))})).join(".")},t.fromString=function(e){return new(t.bind.apply(t,Q([void 0],e.split("."))))},t.prototype.concat=function(e){return new(t.bind.apply(t,Q([void 0],this._components.concat(e._components))))},t.prototype.component=function(t){return this._components[t]},t}();t.TarsusKeyPath=e;var n=function(){function t(t){this._host=t}return t.prototype.readStorageKey=function(t){return this._host.readStorageKey(t.toString())},t.prototype.writeStorageKey=function(t,e){this._host.writeStorageKey(t.toString(),e)},t.prototype.deleteStorageKey=function(t){this._host.deleteStorageKey(t.toString())},t.prototype.readSessionStorageKey=function(t){return this._host.readSessionStorageKey(t.toString())},t.prototype.writeSessionStorageKey=function(t,e){this._host.writeSessionStorageKey(t.toString(),e)},t.prototype.deleteSessionStorageKey=function(t){this._host.deleteSessionStorageKey(t.toString())},t.prototype.generateKeyPair=function(t,e,n,o){return this._host.generateKeyPair(t.toString(),e,n,o)},t.prototype.generateKeyPairExternalRepresentation=function(t){return this._host.generateKeyPairExternalRepresentation(t)},t.prototype.generateHexSeededKeyPairExternalRepresentation=function(t,e,n,o){return this._host.generateHexSeededKeyPairExternalRepresentation(t,e,n,o)},t.prototype.getKeyPair=function(t,e,n){return this._host.getKeyPair(t.toString(),e,n)},t.prototype.deleteKeyPair=function(t){this._host.deleteKeyPair(t.toString())},t.prototype.importVolatileSymmetricKey=function(t,e){return this._host.importVolatileSymmetricKey(t,e)},t.prototype.importVolatileKeyPair=function(t,e){return this._host.importVolatileKeyPair(t,e)},t.prototype.importVolatileKeyPairFromPublicKeyHex=function(t,e){return this._host.importVolatileKeyPairFromPublicKeyHex(t,e)},t.prototype.generatePbkdf2HmacSha1HexString=function(t,e,n,o){return this._host.generatePbkdf2HmacSha1HexString(t,e,n,o)},t.prototype.calcHexStringEncodedSha256Hash=function(t){return this._host.calcHexStringEncodedSha256Hash(t)},t.prototype.calcHexStringEncodedSha512Hash=function(t){return this._host.calcHexStringEncodedSha512Hash(t)},t.prototype.generateRandomHexString=function(t){return this._host.generateRandomHexString(t)},t.prototype.queryHostInfo=function(t){return this._host.queryHostInfo(t)},t.prototype.queryAsyncHostInfo=function(t){return this._host.queryAsyncHostInfo(t)},t.prototype.calcHexStringEncodedHmacSha1HashWithHexEncodedKey=function(t,e){return this._host.calcHexStringEncodedHmacSha1HashWithHexEncodedKey(t,e)},t.prototype.getCurrentTime=function(){return this._host.getCurrentTime()},t.prototype.createDelayedPromise=function(t){return this._host.createDelayedPromise(t)},t.prototype.fido2CredentialsOp=function(t,e,n,o,r){return this._host.fido2CredentialsOp(t,e,n,o,r)},t.prototype.dyadicEnroll=function(t,e){return this._host.dyadicEnroll(t,e)},t.prototype.dyadicSign=function(t,e){return this._host.dyadicSign(t,e)},t.prototype.dyadicDelete=function(t){return this._host.dyadicDelete(t)},t.prototype.dyadicRefreshToken=function(t){return this._host.dyadicRefreshToken(t)},t.prototype.log=function(t,e,n){return this._host.log(t,e,n)},t.prototype.setDebugIndicatorVisible=function(t){this._host.setDebugIndicatorVisible(t)},t.prototype.getUIStyles=function(){return this._host.getUIStyles()},t.prototype.getString=function(t,e){return this._host.getString(t,e)},t.prototype.loadPlugin=function(t){return this._host.loadPlugin(t)},t}();t.TarsusHostServices=n}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t){this._strings=t}return Object.defineProperty(t.prototype,"strings",{get:function(){return this._strings},enumerable:!1,configurable:!0}),t.prototype.getString=function(t){return this._strings?this._strings[t]:null},t}();t.ClientStrings=e}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.impl||(o.impl={}),n=function(){function t(t,e,n){this._sdk=t,this._contextLocalStrings=e||null,this._contextStylesheetJson=n||null}return t.prototype.getString=function(t){return this.internalFormatString(t,null)},t.prototype.formatString=function(t,e){return this.internalFormatString(t,e)},t.prototype.internalFormatString=function(t,e){var n;return null==(n=this.resolveStringKey(t))?t:e&&e.length>0?this.format(n,e):n},t.prototype.resolveStringKey=function(t){var e;if(null!=(e=this._contextLocalStrings&&this._contextLocalStrings[t]))return e;var n=this._sdk.uiAssetsData;return n?n.getString(t):(this._sdk.log(o.LogLevel.Warning,(function(){return"Attempt to get string value without initialized asset data."})),null)},t.prototype.format=function(t,e){var n=this,o=t;return o&&(o=o.replace(/%(\d+)\$s/g,(function(t,o){var r=+o-1;return n.stringForIndex(r,e,t)}))),o},t.prototype.stringForIndex=function(t,e,n){return t>=0&&t<e.length?e[t]:n},t.prototype.getStyle=function(t){return this._contextStylesheet||(this._contextStylesheet=this._contextStylesheetJson?this._sdk.uiAssetsData.getUiStylesheetsWithOverrides(this._contextStylesheetJson):this._sdk.uiAssetsData.uiStylesheets),this._contextStylesheet.getMatchingStyle(t)},t}(),e.UIContextImpl=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(n){var o=new n.core.TarsusKeyPath("currentSession"),r=new n.core.TarsusKeyPath("continuations","default_cflow"),i=(new n.core.TarsusKeyPath("flow_id"),function(){function i(){this.mandatoryCollectors=[n.CollectorType.DeviceDetails,n.CollectorType.ExternalSDKDetails,n.CollectorType.HWAuthenticators,n.CollectorType.LocalEnrollments,n.CollectorType.Capabilities,n.CollectorType.DeviceFingerprint],this.mandatoryCollectorsForAnonymous=[n.CollectorType.DeviceDetails],this.uiAssetsDownloadMode=n.UIAssetsDownloadMode.DownloadOnInit,this._wasLocaleSet=!1}return i.prototype.pushRequestPayloadFromJSON=function(t){var e=t.push_type;switch(e){case"otp_notification":return n.impl.OtpPushRequestPayloadImpl.createWithJsonPayload(t);case"approval":return n.impl.MobileApprovePushRequestPayloadImpl.createWithJsonPayload(t)}throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Payload with type "+e+" isn't recognized")},Object.defineProperty(i.prototype,"apiLevel",{get:function(){if(null==this._apiLevel)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Attempt to access uninitialized API level");return this._apiLevel},enumerable:!1,configurable:!0}),i.prototype.setTarsusHost=function(t){this._nativeHost=t,this.host=new n.core.TarsusHostServices(t),this.setLogLevel(n.LogLevel.Debug),this.pluginManager=new n.core.TarsusPluginManager(this),this.enabledCollectors=[n.CollectorType.Accounts,n.CollectorType.DeviceDetails,n.CollectorType.Contacts,n.CollectorType.Owner,n.CollectorType.Software,n.CollectorType.Location,n.CollectorType.Bluetooth,n.CollectorType.ExternalSDKDetails,n.CollectorType.HWAuthenticators,n.CollectorType.Capabilities,n.CollectorType.LargeData,n.CollectorType.LocalEnrollments,n.CollectorType.DeviceFingerprint,n.CollectorType.AppPermissions],this._enabledCollectorsAnonymous=null,this.currentPersistUserData=!0},Object.defineProperty(i.prototype,"enabledCollectorsAnonymous",{get:function(){return null==this._enabledCollectorsAnonymous?this.apiLevel<11?(this.log(n.LogLevel.Debug,(function(){return"enabledCollectorsAnonymous() returning regular collectors"})),this.enabledCollectors):(this.log(n.LogLevel.Debug,(function(){return"enabledCollectorsAnonymous() returning mandatory collectors for anonymous only"})),this.mandatoryCollectorsForAnonymous):(this.log(n.LogLevel.Debug,(function(){return"enabledCollectorsAnonymous() returning collectors set by the customer"})),this._enabledCollectorsAnonymous)},enumerable:!1,configurable:!0}),i.prototype.setUiAssetsDownloadMode=function(t){this.uiAssetsDownloadMode=t},i.prototype.setLocale=function(t){var e=this;if((this.log(n.LogLevel.Debug,(function(){return"Start setLocale with locale "+t})),t&&""!=t)&&(this._wasLocaleSet=!0,(this.uiAssetsData&&this.uiAssetsData.locale)!=t||this.uiAssetsData.isServerClientStringsEmpty()))return this.log(n.LogLevel.Debug,(function(){return"Updating locale to "+t})),this.uiAssetsDownloadMode!==n.UIAssetsDownloadMode.Disable?this.loadUiAssetsFromServer(t).then((function(t){return Promise.resolve(t)})).catch((function(o){return e.log(n.LogLevel.Warning,(function(){return"Error loading locale from server; using empty locale "+t})),e.uiAssetsData=new n.core.UIAssetsData(e,t),Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))})):(this.uiAssetsData=new n.core.UIAssetsData(this,t),Promise.resolve(!0));return Promise.resolve(!1)},i.prototype.setConnectionSettings=function(t){this.connectionSettings=t},i.prototype.setClientCryptoSettings=function(t){this.cryptoSettings=t},i.prototype.setEnabledCollectors=function(t){this.enabledCollectors=t,this.addMandatoryCollectorsIfNeeded()},i.prototype.setEnabledCollectorsForAnonymousJourneys=function(t){this.log(n.LogLevel.Debug,(function(){return"Overriding collectors for anonymous"})),this._enabledCollectorsAnonymous=t,this.addMandatoryCollectorsForAnonymousIfNeeded()},i.prototype.setLogLevel=function(t){this._logLevel=t,this._nativeHost.setLogLevel(this._logLevel)},i.prototype.setExternalLogger=function(t){this._nativeHost.setExternalLogger(t)},i.prototype.setTransportProvider=function(t){this.transportProvider=t},i.prototype.setUiHandler=function(t){this.currentUiHandler=t},i.prototype.setPushToken=function(t){this._lastReceivedPushToken=t},i.prototype.setPersistUserData=function(t){this.currentPersistUserData=t},i.prototype.setInvalidUserRecordRecoveryMode=function(t){if(null!=this.invalidUserRecoveryMode&&this.invalidUserRecoveryMode!=t)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Duplicate invocation of setInvalidUserRecordRecoveryMode.");this.invalidUserRecoveryMode=t},i.prototype.setClientApiLevel=function(e){if(null!=this._apiLevel&&this._apiLevel!=e)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Duplicate invocation of setClientApiLevel.");if(e>t.ts.mobile.sdk.core.API_LEVEL)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"This SDK does not support API level "+this.apiLevel+".");this._apiLevel=e},Object.defineProperty(i.prototype,"currentSession",{get:function(){return this._currentSession},enumerable:!1,configurable:!0}),i.prototype.installPlugin=function(t,e){this.pluginManager.installPlugin(t,e)},i.prototype.initialize=function(){var t=this;return new Promise((function(e,r){if(!t.host)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without host.");if(!t.connectionSettings)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without connection settings.");if(!t.transportProvider)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without transport provider.");t.cryptoSettings||(t.cryptoSettings=n.ClientCryptoSettings.create(1e4)),t.applyConfigurationDefaultsAndLogConfiguration(),t._nativeHost.initialize(t.allCollectorsSet()).then((function(e){var r=null;if(!t._wasLocaleSet){var i=t._nativeHost.getPreferredLocale(),s=t.getFullLocale(i);t.uiAssetsDownloadMode===n.UIAssetsDownloadMode.DownloadOnInit?r=t.setLocale(s).catch((function(){return!1})):t.uiAssetsData=new n.core.UIAssetsData(t,s)}return r=r||Promise.resolve(!0),Promise.all([t.pluginManager.initializePlugins(),r]).then((function(){var e=t.host.readSessionStorageKey(o);if(e){t.log(n.LogLevel.Info,(function(){return"Loading existing session from session store"}));try{t._currentSession=n.core.Session.fromJson(t,e),t.log(n.LogLevel.Debug,(function(){return"Loaded existing session for user "+(t._currentSession.user&&t._currentSession.user.displayName)}))}catch(e){t.log(n.LogLevel.Warning,(function(){return"Failed to load existing session from session store. Discarding existing session "+e+"."}))}}return!0}))})).then(e,r)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.getUsersInfo=function(){var t=[];return n.core.User.iterateUsers(this,(function(e){t.push(n.impl.UserInfoImpl.createWithUser(e))})),t},i.prototype.getUserInfo=function(t){var e=n.core.User.findUser(this,t);if(!e)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.UserNotFound,"Attempt to call getUserInfo with a non existing user.");return n.impl.UserInfoImpl.createWithUser(e)},i.prototype.isBoundForUser=function(t){var e=n.core.User.findUser(this,t);return!(!e||!e.deviceBound)},i.prototype.getBoundUserIds=function(){var t=[];return n.core.User.iterateUsers(this,(function(e){e.userId&&e.deviceBound&&t.push(e.userId)})),t},i.prototype.getKnownUserIds=function(){var t=[];return n.core.User.iterateUsers(this,(function(e){e.userId&&(e.hasLoggedIn||e.deviceBound)&&t.push(e.userId)})),t},i.prototype.logout=function(){var t=this;return new Promise((function(e,o){if(t._currentSession)if(t._currentSession.canTerminate()){var r,i=t._currentSession.createLogoutRequest(),s=t._currentSession;t._currentSession=null,t.saveCurrentSession(),s.invalidated?(t.log(n.LogLevel.Info,(function(){return"Logging out with an invalidated session; not issuing server request."})),r=Promise.resolve(!0)):r=s.performSessionExchange(i).then((function(t){return Promise.resolve(!0)})),r.then((function(t){return n.core.Session.notifySessionObserversOnMainSessionLogout(s),t})).then(e,o)}else o(new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to logout with a locked session."));else o(new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"No logged in user."))})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.isTotpProvisionedForUser=function(t,e){var o=n.core.User.findUser(this,t);if(!o)return this.log(n.LogLevel.Error,(function(){return"Can not find user record for <"+t+">"})),!1;var r=new n.core.LocalSession(this,o);return n.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(o,this,r).isTotpProvisionedForGenerator(e||n.core.totp.TotpPropertiesProcessor.BACKWARD_COMPATIBILITY_DEFAULT_GENERATOR)},i.prototype.getVersionInfo=function(){return this._versionInfo||(this._versionInfo=new n.impl.VersionInfoImpl(this.host.queryHostInfo(e.sdkhost.HostInformationKey.Platform),this.host.queryHostInfo(e.sdkhost.HostInformationKey.Version))),this._versionInfo},i.prototype.resolveUserForBind=function(t){var e=n.core.User.findUser(this,t);return e||(this.log(n.LogLevel.Debug,(function(){return"bind: Creating new user "+t})),e=n.core.User.createUserWithUserId(this,t)),e},i.prototype.resumableControlFlowRequestRuntimeContext=function(t){var e=this;return{clientContext:t,sdk:this,sdkSessionManagementServices:new(function(){function t(){}return t.prototype.setCurrentSession=function(t){e._currentSession=t},Object.defineProperty(t.prototype,"lastReceivedPushToken",{get:function(){return e._lastReceivedPushToken},enumerable:!1,configurable:!0}),t.prototype.saveCurrentSession=function(){e.saveCurrentSession()},t}()),uiHandler:this.currentUiHandler}},i.prototype.internalBind=function(t,e,o,r){return this.log(n.LogLevel.Debug,(function(){return"Bind for user "+(t.userId||t.idToken)})),new n.core.BindControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(o),this.getOrGenerateFlowId(r)).run(t,e)},i.prototype.bind=function(t,e,n){return this.bindWithOptions(t,e,n,null)},i.prototype.bindWithOptions=function(t,e,o,r){var i=this;return new Promise((function(n,s){var a=i.resolveUserForBind(t);return i.internalBind(a,e,o,r).then(n,s)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.deviceSupportsCryptoBinding=function(){return"true"==this.host.queryHostInfo(e.sdkhost.HostInformationKey.PersistentKeysSupported)},i.prototype.resolveUserForAuthenticate=function(t,e){var o=n.core.User.findUserWithType(this,t,e);if(!o){if(e!==n.UserHandleType.UserId)throw e===n.UserHandleType.IdToken?new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with ID Token that is not provisioned on this device.",{uid_token:t}):new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Unsupported user handle type",{user_handle_type:e});this.log(n.LogLevel.Debug,(function(){return"authenticate: Creating new user "+t})),o=n.core.User.createUserWithUserId(this,t)}return o},i.prototype.internalAuthenticate=function(t,e,o,r,i){var s=this;return this.log(n.LogLevel.Debug,(function(){return"Authenticate for user "+(t.userId||t.idToken)+" with policy "+e})),new n.core.AuthenticateControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(r),this.getOrGenerateFlowId(i)).run(t,e,o).catch((function(e){return s.applyInvalidUserRecordRecovery(t.userHandle,n.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},i.prototype.authenticate=function(t,e,n,o){return this.authenticateWithOptions(t,e,n,o,null)},i.prototype.authenticateWithOptions=function(t,e,o,r,i){try{var s=this.resolveUserForAuthenticate(t,n.UserHandleType.UserId);return this.internalAuthenticate(s,e,o,r,i)}catch(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}},i.prototype.authenticateWithIdToken=function(t,e,n,o){return this.authenticateWithIdTokenWithOptions(t,e,n,o,null)},i.prototype.authenticateWithIdTokenWithOptions=function(t,e,o,r,i){try{var s=this.resolveUserForAuthenticate(t,n.UserHandleType.IdToken);return this.internalAuthenticate(s,e,o,r,i)}catch(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}},i.prototype.invokePolicy=function(t,e,n){return this.invokePolicyWithOptions(t,e,n,null)},i.prototype.invokePolicyWithOptions=function(t,e,o,r){return this.log(n.LogLevel.Debug,(function(){return"Invoke policy "+t+" for current session."})),new n.core.InvokePolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(o),this.getOrGenerateFlowId(r)).run(t,e)},i.prototype.startTotpSessionForUser=function(t,e,o,r){var i=this;return o=o||n.core.totp.TotpPropertiesProcessor.BACKWARD_COMPATIBILITY_DEFAULT_GENERATOR,this.log(n.LogLevel.Debug,(function(){return"Start TOTP session for user "+t+", generator "+o})),new Promise((function(s,a){i.ensureConfigured(),i.log(n.LogLevel.Debug,(function(){return"Get TOTP data for <"+t+", "+o+">"}));var u=n.core.User.findUser(i,t);if(!u)throw i.log(n.LogLevel.Error,(function(){return"Can not find user record for <"+t+">"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Can not find user <"+t+">");var c=new n.core.LocalSession(i,u);n.core.totp.TotpPropertiesProcessor.createWithUserHandle(t,i,c,r).runCodeGenerationSession(o,e,r,i.currentUiHandler).then(s,a)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.totpGenerationRequestForUserFromCanonicalString=function(t,e){this.ensureConfigured(),this.log(n.LogLevel.Debug,(function(){return"Get TOTP request for <"+t+">"}));var o=n.core.User.findUser(this,t);if(!o)throw this.log(n.LogLevel.Error,(function(){return"Can not find user record for <"+t+">"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Can not find user <"+t+">");var r=new n.core.LocalSession(this,o);return n.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(o,this,r).totpRequestFromCanonicalString(e)},i.prototype.startTotpSessionWithRequest=function(t,e){var o=this;return new Promise((function(r,i){o.ensureConfigured(),o.log(n.LogLevel.Debug,(function(){return"Start TOTP session for user "+t.getUserId()+", generator "+t.getGeneratorName()}));var s=n.core.User.findUser(o,t.getUserId());if(!s)throw o.log(n.LogLevel.Error,(function(){return"Can not find user record for <"+t.getUserId()+">"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Can not find user <"+t.getUserId()+">");var a=new n.core.LocalSession(o,s);n.core.totp.TotpPropertiesProcessor.createWithUserHandle(t.getUserId(),o,a,e).runCodeGenerationSessionWithRequest(t,e,o.currentUiHandler).then(r,i)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.startDeviceManagementSession=function(t){var e=this;return new Promise((function(o,r){e.ensureConfigured(),e.runWithCurrentSession((function(o){return e.log(n.LogLevel.Debug,(function(){return"User in current session: "+o.user.displayName})),new n.core.DeviceManagementSessionProcessor(e,o,t).run()})).then((function(t){switch(t){case n.core.DeviceManagementSessionProcessorReturnReason.CurrentDeviceDeleted:var o=e._currentSession&&e._currentSession.user;return e.log(n.LogLevel.Debug,(function(){return"Invalidating current session after deletion of current device."})),e._currentSession=null,e.saveCurrentSession(),o?(e.log(n.LogLevel.Debug,(function(){return"Clearing data for current user ("+o.displayName+") after deletion of current device."})),e.clearDataForUser(o.userHandle)):e.log(n.LogLevel.Warning,(function(){return"No current user after deletion of current device; not clearing sesison."})),!0;case n.core.DeviceManagementSessionProcessorReturnReason.FinishSession:return!0}})).then(o,r)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.startAuthenticationConfiguration=function(t){var e=this;return this.log(n.LogLevel.Debug,(function(){return"Start authentication configuration for current session"})),new Promise((function(o,r){e.ensureConfigured(),e.runWithCurrentSession((function(o){return e.log(n.LogLevel.Debug,(function(){return"User in current session: "+o.user.displayName})),new n.core.AuthenticationConfigurationSessionProcessor(e,o,t).run()})).then(o,r)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.startAuthenticationConfigurationWithToken=function(t,e){var o=this;return this.log(n.LogLevel.Debug,(function(){return"Start approval for provided session token"})),new Promise((function(r,i){o.ensureConfigured(),o.runWithCurrentSession((function(r){return o.log(n.LogLevel.Debug,(function(){return"User in current session: "+r.user.displayName})),new n.core.AuthenticationConfigurationSessionProcessor(o,r,e,t).run()})).then(r,i)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.startApprovalsSessionForCurrentSession=function(t){var e=this;return this.log(n.LogLevel.Debug,(function(){return"Start approval for current session"})),new Promise((function(o,r){e.ensureConfigured(),e.runWithCurrentSession((function(o){return e.log(n.LogLevel.Debug,(function(){return"User in current session: "+o.user.displayName})),new n.core.ApprovalSessionProcessor(e,o,t).run()})).then(o,r)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.startApprovalsSessionForPushedRequest=function(t,e){return this.startApprovalsSessionForPushedRequestWithOptions(t,e,null)},i.prototype.startApprovalsSessionForPushedRequestWithOptions=function(t,e,o){var r=this;return this.log(n.LogLevel.Debug,(function(){return"Start approval for push request"})),new Promise((function(o,i){if(r.ensureConfigured(),!t.userId())return t.ticket()?void i(new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Mobile approval push by ticket not yet implemented.")):void i(new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Unknown mobile approval push request."));r.log(n.LogLevel.Debug,(function(){return"startApprovalsSessionForPushedRequest with userid "+t.userId()}));var s=r.lookupBoundUser(t.userId()),a=new n.core.Session(r,s);new n.core.ApprovalSessionProcessor(r,a,e).run().then(o,i)})).catch((function(t){return Promise.reject(n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.invokeAnonymousPolicy=function(t,e,n){return this.invokeAnonymousPolicyWithOptions(t,e,n,null)},i.prototype.invokeAnonymousPolicyWithOptions=function(t,e,o,r){return this.log(n.LogLevel.Debug,(function(){return"Start anonymous policy "+t})),new n.core.InvokeAnonymousPolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(o),this.getOrGenerateFlowId(r)).run(t,e)},i.prototype.invokeAnonymousPolicyWithInlineInvokeResponse=function(t,e){return this.log(n.LogLevel.Debug,(function(){return"Start anonymous policy with inline server response"})),new n.core.InvokeAnonymousPolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(e),t.flow_id).run(t.inline_invoke_response)},i.prototype.cancelCurrentRunningControlFlow=function(){this.log(n.LogLevel.Debug,(function(){return"Cancel current running control flow requested."})),this._currentSession?this._currentSession.cancelCurrentControlFlow():this.log(n.LogLevel.Error,(function(){return"No current session"}))},i.prototype.ensureConfigured=function(){if(!this.currentUiHandler)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to start authentication without a registered UIHandler.")},i.prototype.getAppGlobalUIContext=function(){return this._appGlobalUiContext||(this._appGlobalUiContext=new n.impl.UIContextImpl(this)),this._appGlobalUiContext},i.prototype.userVaultExists=function(t,e){return n.UserVault.exists(this,t,e)},i.prototype.readUserVault=function(t,e,o){var r=this;return new Promise((function(i,s){n.UserVault.open(r,t,e).readData(o).then(i,s)}))},i.prototype.writeUserVault=function(t,e,o,r){var i=this;return new Promise((function(s,a){n.UserVault.open(i,t,e).writeData(o,r).then((function(){return s(!0)}),a)}))},i.prototype.saveCurrentSession=function(){this._currentSession?this.host.writeSessionStorageKey(o,this._currentSession.toJson()):this.host.deleteSessionStorageKey(o)},i.prototype.runWithCurrentSession=function(t){var e=this;if(!this._currentSession)return Promise.reject(new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.SessionRequired,"Operation requires an active session."));var o=this._currentSession;return o.lock(),t(o).finally((function(){o.unlock(),e.saveCurrentSession()}))},i.prototype.log=function(t,e){t<=this._logLevel&&this._nativeHost.log(t,"TransmitSDK/Tarsus",e())},i.prototype.getOrGenerateFlowId=function(t){return(null==t?void 0:t.getFlowId())||this.generateFlowId()},i.prototype.generateFlowId=function(){return this.host.generateRandomHexString(64)},i.prototype.promiseCollectionResult=function(t){var e=this;return void 0===t&&(t=null),this._nativeHost.promiseCollectionResult(t).then((function(n){return null!=t?e.addTarsusCollectedData(n,t):e.addTarsusCollectedData(n,e.enabledCollectors)}))},i.prototype.getClientFeatureSet=function(){var t,o=this.host.queryHostInfo(e.sdkhost.HostInformationKey.HostProvidedFeatures);return t=o&&o.length?o.split(",").map((function(t){return parseInt(t)})):[],"true"==this.host.queryHostInfo(e.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation)&&t.push(e.sdkhost.FeatureDeviceBiometricsFPContinuation),n.core.STATIC_FEATURE_SET.concat(t)},i.prototype.clearDataForUser=function(t){try{if(this.log(n.LogLevel.Debug,(function(){return"Delete data for user "+t+"."})),this._currentSession)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to call clearDataForUser with an active primary ongoing session.");var e=n.core.User.findUser(this,t);if(!e)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to call clearDataForUser with a non existing user.");try{this.host.deleteKeyPair(e.deviceSigningKeyTag)}catch(t){this.log(n.LogLevel.Warning,(function(){return"Can't delete device signing key."}))}try{this.host.deleteKeyPair(e.deviceEncryptionKeyTag)}catch(t){this.log(n.LogLevel.Warning,(function(){return"Can't delete device encryption key."}))}try{n.core.LocalEnrollment.deleteEnrollmentsForUser(e,this)}catch(t){this.log(n.LogLevel.Warning,(function(){return"Can't delete enrollments for user."}))}var o=new n.core.LocalSession(this,e);try{n.core.totp&&n.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(e,this,o).deleteAllProvisions()}catch(t){this.log(n.LogLevel.Warning,(function(){return"Can't delete enrollments for user."}))}n.core.User.deleteUser(e,this)}catch(e){throw this.log(n.LogLevel.Warning,(function(){return"Can't delete data for user "+t+": "+e})),e}},i.prototype.clearAllData=function(){var t=this;if(this._currentSession)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to call clearAllData with an active primary ongoing session.");this.log(n.LogLevel.Debug,(function(){return"Delete all data: collecting users"}));var e=[];n.core.User.iterateUsers(this,(function(t){e.push(t.userHandle)})),this.log(n.LogLevel.Debug,(function(){return"Delete all data: deleting users"})),e.forEach((function(e){try{t.clearDataForUser(e)}catch(o){t.log(n.LogLevel.Warning,(function(){return"Error when deleting user "+e+": "+o}))}}))},i.prototype.generateDebugPinForControlFlow=function(t){var e=this;return this.log(n.LogLevel.Debug,(function(){return"generateDebugPinForMainSession: Starting"})),new Promise((function(o,r){e.ensureConfigured();var i=n.core.ControlFlowProcessor.findByClientContext(t);if(!i)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to start debugging for an unknown control flow.");i.generateDebugPin().then(o,r)}))},i.prototype.lookupBoundUser=function(t,e){var o=n.core.User.findUserWithType(this,t,e);if(!o)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with an unknown user on this device.",{user:t});if(!o.deviceBound)throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with an unbound user on this device.",{user:t});return o},i.prototype.addTarsusCollectedData=function(t,e){var o=this;return new Promise((function(r,i){var a=new Array,u=new Array;Object.keys(n.core.collectors.TarsusCollectors).forEach((function(t){var r=new n.core.collectors.TarsusCollectors[t].createCollector(e);r.isEnabled()&&(u.push(t),a.push(r.provide(o)))})),Promise.all(a.map((function(t){return t.catch((function(t){return new Error(t)}))}))).then((function(e){for(var i=t.toJson(),a=function(t){e[t]instanceof Error?o.log(n.LogLevel.Error,(function(){return"caught collection error "+e[t]})):(o.log(n.LogLevel.Debug,(function(){return"Tarsus collected from: "+u[t]+" "+JSON.stringify(e[t])})),i.content[u[t]]=o.mergeCollectedData(e[t],i.content[u[t]]))},c=0;c<e.length;c++)a(c);r(new s(i))})).catch((function(t){i(t)}))}))},i.prototype.mergeCollectedData=function(t,e){var n={};for(var o in t)n[o]=t[o];for(var o in e)n[o]=e[o];return n},i.prototype.addMandatoryCollectorsIfNeeded=function(){var t=this;this.mandatoryCollectors.forEach((function(e){t.enabledCollectors.indexOf(e)<0&&(t.enabledCollectors.push(e),t.log(n.LogLevel.Warning,(function(){return n.CollectorType[e]+" collector is mandatory, and will remain enabled."})))}))},i.prototype.addMandatoryCollectorsForAnonymousIfNeeded=function(){var t=this;this.mandatoryCollectorsForAnonymous.forEach((function(e){null!==t._enabledCollectorsAnonymous&&t._enabledCollectorsAnonymous.indexOf(e)<0&&(t._enabledCollectorsAnonymous.push(e),t.log(n.LogLevel.Warning,(function(){return n.CollectorType[e]+" collector is mandatory for anonymous, and will remain enabled."})))}))},i.prototype.allCollectorsSet=function(){var t=[];return this.enabledCollectors.forEach((function(e){-1==t.indexOf(e)&&t.push(e)})),this.enabledCollectorsAnonymous.forEach((function(e){-1==t.indexOf(e)&&t.push(e)})),t},i.prototype.loadUiAssetsFromServer=function(t){var e=this;try{this.log(n.LogLevel.Debug,(function(){return"Start ClientStrings request with locale: "+t}));var o=new n.core.PublicNetworkRequest(this),r=o.createClientStringsRequest(t);return o.performRequest(r).then((function(o){if(e.uiAssetsData=new n.core.UIAssetsData(e,t),o){var r=o&&o.data;if(r&&r.values)return e.uiAssetsData.setServerClientStrings(new n.core.ClientStrings(r.values)),!0;throw new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,o.error_message)}return!1}))}catch(t){return this.log(n.LogLevel.Error,(function(){return"ClientStrings general error: "+t.getMessage()})),Promise.reject(t)}},i.prototype.getFullLocale=function(t){return t&&t.indexOf("-")>=0&&(n.util.LANGUAGES[t]=t),n.util.LANGUAGES[t]||t},i.prototype.applyConfigurationDefaultsAndLogConfiguration=function(){var e=this;null==this._apiLevel&&(this._apiLevel=t.ts.mobile.sdk.core.API_LEVEL),null==this.invalidUserRecoveryMode&&(this.invalidUserRecoveryMode=this.apiLevel>=9?n.InvalidUserRecordRecoveryMode.RecoverDeviceAndBindingOnAuthenticate:n.InvalidUserRecordRecoveryMode.Disable),this.log(n.LogLevel.Debug,(function(){return"Using Client API Level "+e.apiLevel})),this.log(n.LogLevel.Debug,(function(){return"Using invalid user recovery mode "+n.InvalidUserRecordRecoveryMode[e.invalidUserRecoveryMode]}))},i.prototype.applyInvalidUserRecordRecovery=function(t,e){switch(this.invalidUserRecoveryMode){case n.InvalidUserRecordRecoveryMode.Disable:break;case n.InvalidUserRecordRecoveryMode.RecoverDeviceAndBindingOnAuthenticate:e.getErrorCode()!=n.AuthenticationErrorCode.DeviceNotFound&&e.getErrorCode()!=n.AuthenticationErrorCode.InvalidDeviceBinding||(this.log(n.LogLevel.Error,(function(){return"Resetting user record due to error "+e})),this.clearDataForUser(t),e instanceof n.impl.AuthenticationErrorImpl||(e=new n.impl.AuthenticationErrorImpl(e.getErrorCode(),e.getMessage(),e.getData())),e.setPublicProperty(n.AuthenticationErrorProperty.UserRecordDeleted,!0))}return Promise.reject(e)},i.prototype.suspendControlFlowToDefaultSuspensionContext=function(t){if(!(t instanceof n.impl.PolicyActionImpl))throw this.log(n.LogLevel.Error,(function(){return"Attempt to request continuation for an unknown PolicyAction implementation"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Cannot prepare SDK for continuation in this context.");if(!(t.controlFlow&&t.controlFlow.requestContext&&t.controlFlow.requestContext instanceof n.core.ResumableControlFlowRequest))throw this.log(n.LogLevel.Error,(function(){return"Attempt to request continuation for a PolicyAction implementation without a control flow request context"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.Internal,"Cannot prepare SDK for continuation in this context.");this.log(n.LogLevel.Debug,(function(){return"Preparing for continuation of "+t.controlFlow}));var e=t.controlFlow.requestContext.topmost.createContinuation(),o=new n.core.SerializationContext;o.writeObject("continuation",e),this.log(n.LogLevel.Debug,(function(){return"Storing continuation"})),this.host.writeStorageKey(r,o.serializedContent)},i.prototype.resumeSuspendedControlFlow=function(t,e,o){var i=this;return new Promise((function(t,s){i.log(n.LogLevel.Debug,(function(){return"resumeSuspendedControlFlow Fetching continuation and deleting it..."}));var a=i.host.readStorageKey(r);i.host.deleteStorageKey(r),i.log(n.LogLevel.Debug,(function(){return"Deserializing continuation"}));var u=new n.core.SerializationContext(a).readNonNullObject("continuation");i.log(n.LogLevel.Debug,(function(){return"Resuming process based on continuation"})),u.createResumableProcess(i.resumableControlFlowRequestRuntimeContext(o)).resume(u,e).then(t,s)})).catch((function(t){throw n.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))},i.prototype.resetCurrentSession=function(){var t=this;return new Promise((function(e,o){if(t.log(n.LogLevel.Debug,(function(){return"resetCurrentSession Invoked"})),t.log(n.LogLevel.Debug,(function(){return"resetCurrentSession will discard session"})),t._currentSession&&!t._currentSession.canTerminate())throw t.log(n.LogLevel.Error,(function(){return"resetCurrentSession Attempt to reset current session with a locked session"})),new n.impl.AuthenticationErrorImpl(n.AuthenticationErrorCode.AppImplementation,"Attempt to resetCurrentSession with a locked session.");t._currentSession=null,t.saveCurrentSession(),t.log(n.LogLevel.Debug,(function(){return"resetCurrentSession will discard continuation"})),t.host.deleteStorageKey(r),e(!0)}))},i.__tarsusInterfaceName="TransmitSDKXm",i}());n.TransmitSDKXmImpl=i;var s=function(){function t(t){this.theResult=t}return t.prototype.toJson=function(){return this.theResult},t}();n.CollectionResultImpl=s,n.createSdk=function(){return new i}}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(n){this._backgroundColor=n.backgroundColor&&new e.TSColorImpl(t.core.Protocol.unwrap(n.backgroundColor)),this._tintColor=n.tintColor&&new e.TSColorImpl(t.core.Protocol.unwrap(n.tintColor)),this._lineColor=n.lineColor&&new e.TSColorImpl(t.core.Protocol.unwrap(n.lineColor)),this._iconColor=n.iconColor&&new e.TSColorImpl(t.core.Protocol.unwrap(n.iconColor)),this._imageUrl=n.imageUrl&&t.core.Protocol.unwrap(n.imageUrl),this._fontName=n.fontName&&t.core.Protocol.unwrap(n.fontName),this._fontSize=n.fontSize&&t.core.Protocol.unwrap(n.fontSize),this._fontBold=n.fontBold&&t.core.Protocol.unwrap(n.fontBold),this._maskInput=n.maskInput&&t.core.Protocol.unwrap(n.maskInput),this._rawJson=JSON.stringify({backgroundColor:this._backgroundColor&&this._backgroundColor.getHexValue(),tintColor:this._tintColor&&this._tintColor.getHexValue(),lineColor:this._lineColor&&this._lineColor.getHexValue(),iconColor:this._iconColor&&this._iconColor.getHexValue(),imageUrl:this._imageUrl,fontName:this._fontName,fontSize:this._fontSize,fontBold:this._fontBold,maskInput:this._maskInput})}return n.prototype.getBackgroundColor=function(){return this._backgroundColor||null},n.prototype.getTintColor=function(){return this._tintColor||null},n.prototype.getLineColor=function(){return this._lineColor||null},n.prototype.getIconColor=function(){return this._iconColor||null},n.prototype.getImageUrl=function(){return this._imageUrl||null},n.prototype.getFontName=function(){return this._fontName||null},n.prototype.getFontSize=function(){return this._fontSize||0},n.prototype.getFontBold=function(){return this._fontBold||!1},n.prototype.getMaskInput=function(){return this._maskInput||!1},n.prototype.getRawJson=function(){return this._rawJson},n.emptyStyle=function(){return this._emptyStyle||(this._emptyStyle=new n({})),this._emptyStyle},n}();e.UIStyleImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getUserChoice=function(){return this._userChoice},e.prototype.setUserChoice=function(t){this._userChoice=t},e.create=function(e){return t.ts.mobile.sdk.impl.UnregistrationInputImpl.create(e)},e.__tarsusInterfaceName="UnregistrationInput",e}();e.UnregistrationInput=n}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t){var n=new e;return n.setUserChoice(t),n},e}(t.UnregistrationInput);e.UnregistrationInputImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getUserHandle=function(){return this._user.userHandle},t.prototype.getUserHandleType=function(){return this._user.userHandleType},t.prototype.getDisplayName=function(){return this._user.displayName},t.prototype.getDeviceBound=function(){return this._user.deviceBound},t.prototype.getHasLoggedIn=function(){return this._user.hasLoggedIn},t.createWithUser=function(e){var n=new t;return n._user=e,n},t}();t.UserInfoImpl=e}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;e=t.sdk||(t.sdk={}),n=function(){function t(){}return t.prototype.getValidCancelOptions=function(){return null},t.prototype.getValidErrorRecoveryOptions=function(t){return[e.AuthenticationErrorRecovery.ChangeAuthenticator,e.AuthenticationErrorRecovery.SelectAuthenticator,e.AuthenticationErrorRecovery.Fail,e.AuthenticationErrorRecovery.RetryAuthenticator]},t}(),o=function(){function t(t,e){this._sdk=t,this._vault=e}return t.keyPathForUserVaultNamed=function(t){return new e.core.TarsusKeyPath("user_vaults",t)},t.isValidKeyPathForUserVault=function(t){return"user_vaults"==t.component(0)},t.open=function(o,r,i){var s=e.core.User.findUser(o,r);if(!s)throw o.log(e.LogLevel.Error,(function(){return"Can not find user record for <"+r+">"})),new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.InvalidInput,"Can not find user <"+r+">");return new t(o,e.core.vault.Vault.getVaultForUserWithId(s,this.keyPathForUserVaultNamed(i),new n,o,o.currentUiHandler))},t.exists=function(t,n,o){var r=e.core.User.findUser(t,n);return r?e.core.vault.Vault.vaultExists(r,this.keyPathForUserVaultNamed(o),t):(t.log(e.LogLevel.Error,(function(){return"Can not find user record for <"+n+">"})),!1)},t.prototype.readData=function(t){var n=this,o=e.impl.PolicyActionImpl.createPseudoAction(this._sdk,"user_vault_read");return this._vault.unlock(o,t,!0).then((function(t){if(t instanceof e.core.vault.VaultUnlockResultSuccessOrFailed&&t.successful){var o=n._vault.readVaultKey(e.core.vault.Vault.noIntegrityElementKey),r=e.util.hexToBase64(o);return n._vault.lock(),r}throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid response from vault unlock operation",{result:JSON.stringify(t)})}))},t.prototype.writeData=function(t,n){var o=this,r=e.impl.PolicyActionImpl.createPseudoAction(this._sdk,"user_vault_write");return this._vault.unlock(r,n,!0).then((function(n){if(n instanceof e.core.vault.VaultUnlockResultSuccessOrFailed&&n.successful){var r=e.util.base64ToHex(t);return o._vault.writeVaultKey(e.core.vault.Vault.noIntegrityElementKey,r).then((function(){return o._vault.lock()}))}throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid response from vault unlock operation")}))},t}(),e.UserVault=o}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(t,e){this._sdkVersion=e,this._platformName=t}return e.prototype.getSdkVersion=function(){return this._sdkVersion},e.prototype.getTarsusVersion=function(){return t.core.TARSUS_VERSION},e.prototype.getPlatformName=function(){return this._platformName},e.prototype.getApiLevel=function(){return t.core.API_LEVEL},e}();e.VersionInfoImpl=n}(t.impl||(t.impl={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){var n="input is invalid type",o=!t.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,r="0123456789abcdef".split(""),i=[-2147483648,8388608,32768,128],s=[24,16,8,0],a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],u=["hex","array","digest","arrayBuffer"],c=[];!t.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!o||!t.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"===e(t)&&t.buffer&&t.buffer.constructor===ArrayBuffer});var l=function(t,e){return function(n){return new f(e,!0).update(n)[t]()}},p=function(t){var e=l("hex",t);e.create=function(){return new f(t)},e.update=function(t){return e.create().update(t)};for(var n=0;n<u.length;++n){var o=u[n];e[o]=l(o,t)}return e},h=function(t,e){return function(n,o){return new m(n,e,!0).update(o)[t]()}},d=function(t){var e=h("hex",t);e.create=function(e){return new m(e,t)},e.update=function(t,n){return e.create(t).update(n)};for(var n=0;n<u.length;++n){var o=u[n];e[o]=h(o,t)}return e};function f(t,e){e?(c[0]=c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0,this.blocks=c):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=t}function m(t,r,i){var s,a=e(t);if("string"===a){var u,c=[],l=t.length,p=0;for(s=0;s<l;++s)(u=t.charCodeAt(s))<128?c[p++]=u:u<2048?(c[p++]=192|u>>6,c[p++]=128|63&u):u<55296||u>=57344?(c[p++]=224|u>>12,c[p++]=128|u>>6&63,c[p++]=128|63&u):(u=65536+((1023&u)<<10|1023&t.charCodeAt(++s)),c[p++]=240|u>>18,c[p++]=128|u>>12&63,c[p++]=128|u>>6&63,c[p++]=128|63&u);t=c}else{if("object"!==a)throw new Error(n);if(null===t)throw new Error(n);if(o&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||o&&ArrayBuffer.isView(t)))throw new Error(n)}t.length>64&&(t=new f(r,!0).update(t).array());var h=[],d=[];for(s=0;s<64;++s){var m=t[s]||0;h[s]=92^m,d[s]=54^m}f.call(this,r,i),this.update(d),this.oKeyPad=h,this.inner=!0,this.sharedMemory=i}f.prototype.update=function(t){if(!this.finalized){var r,i=e(t);if("string"!==i){if("object"!==i)throw new Error(n);if(null===t)throw new Error(n);if(o&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||o&&ArrayBuffer.isView(t)))throw new Error(n);r=!0}for(var a,u,c=0,l=t.length,p=this.blocks;c<l;){if(this.hashed&&(this.hashed=!1,p[0]=this.block,p[16]=p[1]=p[2]=p[3]=p[4]=p[5]=p[6]=p[7]=p[8]=p[9]=p[10]=p[11]=p[12]=p[13]=p[14]=p[15]=0),r)for(u=this.start;c<l&&u<64;++c)p[u>>2]|=t[c]<<s[3&u++];else for(u=this.start;c<l&&u<64;++c)(a=t.charCodeAt(c))<128?p[u>>2]|=a<<s[3&u++]:a<2048?(p[u>>2]|=(192|a>>6)<<s[3&u++],p[u>>2]|=(128|63&a)<<s[3&u++]):a<55296||a>=57344?(p[u>>2]|=(224|a>>12)<<s[3&u++],p[u>>2]|=(128|a>>6&63)<<s[3&u++],p[u>>2]|=(128|63&a)<<s[3&u++]):(a=65536+((1023&a)<<10|1023&t.charCodeAt(++c)),p[u>>2]|=(240|a>>18)<<s[3&u++],p[u>>2]|=(128|a>>12&63)<<s[3&u++],p[u>>2]|=(128|a>>6&63)<<s[3&u++],p[u>>2]|=(128|63&a)<<s[3&u++]);this.lastByteIndex=u,this.bytes+=u-this.start,u>=64?(this.block=p[16],this.start=u-64,this.hash(),this.hashed=!0):this.start=u}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},f.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=i[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},f.prototype.hash=function(){var t,e,n,o,r,i,s,u,c,l=this.h0,p=this.h1,h=this.h2,d=this.h3,f=this.h4,m=this.h5,g=this.h6,_=this.h7,v=this.blocks;for(t=16;t<64;++t)e=((r=v[t-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,n=((r=v[t-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,v[t]=v[t-16]+e+v[t-7]+n<<0;for(c=p&h,t=0;t<64;t+=4)this.first?(this.is224?(i=300032,_=(r=v[0]-1413257819)-150054599<<0,d=r+24177077<<0):(i=704751109,_=(r=v[0]-210244248)-1521486534<<0,d=r+143694565<<0),this.first=!1):(e=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),o=(i=l&p)^l&h^c,_=d+(r=_+(n=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&m^~f&g)+a[t]+v[t])<<0,d=r+(e+o)<<0),e=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),o=(s=d&l)^d&p^i,g=h+(r=g+(n=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&f^~_&m)+a[t+1]+v[t+1])<<0,e=((h=r+(e+o)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),o=(u=h&d)^h&l^s,m=p+(r=m+(n=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&_^~g&f)+a[t+2]+v[t+2])<<0,e=((p=r+(e+o)<<0)>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),o=(c=p&h)^p&d^u,f=l+(r=f+(n=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&_)+a[t+3]+v[t+3])<<0,l=r+(e+o)<<0;this.h0=this.h0+l<<0,this.h1=this.h1+p<<0,this.h2=this.h2+h<<0,this.h3=this.h3+d<<0,this.h4=this.h4+f<<0,this.h5=this.h5+m<<0,this.h6=this.h6+g<<0,this.h7=this.h7+_<<0},f.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,o=this.h3,i=this.h4,s=this.h5,a=this.h6,u=this.h7,c=r[t>>28&15]+r[t>>24&15]+r[t>>20&15]+r[t>>16&15]+r[t>>12&15]+r[t>>8&15]+r[t>>4&15]+r[15&t]+r[e>>28&15]+r[e>>24&15]+r[e>>20&15]+r[e>>16&15]+r[e>>12&15]+r[e>>8&15]+r[e>>4&15]+r[15&e]+r[n>>28&15]+r[n>>24&15]+r[n>>20&15]+r[n>>16&15]+r[n>>12&15]+r[n>>8&15]+r[n>>4&15]+r[15&n]+r[o>>28&15]+r[o>>24&15]+r[o>>20&15]+r[o>>16&15]+r[o>>12&15]+r[o>>8&15]+r[o>>4&15]+r[15&o]+r[i>>28&15]+r[i>>24&15]+r[i>>20&15]+r[i>>16&15]+r[i>>12&15]+r[i>>8&15]+r[i>>4&15]+r[15&i]+r[s>>28&15]+r[s>>24&15]+r[s>>20&15]+r[s>>16&15]+r[s>>12&15]+r[s>>8&15]+r[s>>4&15]+r[15&s]+r[a>>28&15]+r[a>>24&15]+r[a>>20&15]+r[a>>16&15]+r[a>>12&15]+r[a>>8&15]+r[a>>4&15]+r[15&a];return this.is224||(c+=r[u>>28&15]+r[u>>24&15]+r[u>>20&15]+r[u>>16&15]+r[u>>12&15]+r[u>>8&15]+r[u>>4&15]+r[15&u]),c},f.prototype.toString=f.prototype.hex,f.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,o=this.h3,r=this.h4,i=this.h5,s=this.h6,a=this.h7,u=[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24&255,n>>16&255,n>>8&255,255&n,o>>24&255,o>>16&255,o>>8&255,255&o,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s];return this.is224||u.push(a>>24&255,a>>16&255,a>>8&255,255&a),u},f.prototype.array=f.prototype.digest,f.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(this.is224?28:32),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),t},m.prototype=new f,m.prototype.finalize=function(){if(f.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.array();f.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(t),f.prototype.finalize.call(this)}};var g=p();g.sha256=g,g.sha224=p(!0),g.sha256.hmac=d(),g.sha224.hmac=d(!0),t.sha256=g.sha256,t.sha224=g.sha224}("undefined"!=typeof window?window:f),function(t){!function(t){!function(t){var e;(function(t){var n=function(){function t(t){this.flowId=t}return t.prototype.getFlowId=function(){return this.flowId},t}();t.ApprovalControlFlowExecutionContext=n;var o=function(){function t(t,n,o){this._session=n,this._sdk=t,this._clientContext=o,this._uiHandler=t.currentUiHandler,this._uiContextImpl=new e.impl.UIContextImpl(t)}return t.prototype.getUiContext=function(){return this._uiContextImpl},t.prototype.run=function(){var t=this;return this._sdk.log(e.LogLevel.Debug,(function(){return"approvals: Starting session"})),this.queryApprovalsFromServer().then((function(e){return new Promise((function(n,o){t._completeFn=n,t._rejectFn=o,t.kickStartSession(e)}))}))},t.prototype.approve=function(t,n){return this.changeApprovalStatus(t,e.MobileApprovalStatus.Approved,n)},t.prototype.deny=function(t){return this.changeApprovalStatus(t,e.MobileApprovalStatus.Denied).then((function(t){return!0}))},t.prototype.requestRefreshApprovals=function(){var t=this;return this.queryApprovalsFromServer().then((function(e){return t.updateManagedApprovals(e),!0}),(function(t){throw e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))},t.prototype.finishSession=function(){if(!this._appSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to finish a non started approval session.");this._appSession.endSession(),this._appSession=null,this._completeFn(!0)},t.prototype.kickStartSession=function(t){this._appSession=this._sdk.currentUiHandler.createApprovalsSession(this._session.user.displayName),this._appSession?(this.updateManagedApprovals(t),this._appSession.startSession(this,null,this._clientContext)):this._rejectFn(e.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTicketWaitSession."))},t.prototype.updateManagedApprovals=function(t){if(this._managedApprovals=t,!this._appSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to update approvals on a non started approval session.");this._appSession.setSessionApprovalsList(t)},t.prototype.queryApprovalsFromServer=function(){var t=this;this._sdk.log(e.LogLevel.Debug,(function(){return"approvals: Initiating collection"}));var n=this._sdk.promiseCollectionResult();return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,n.then((function(n){t._sdk.log(e.LogLevel.Debug,(function(){return"approvals: Collection done; setting up request to query approvals"}));var o=t._session.createApprovalsFetchRequest(n);return t._sdk.log(e.LogLevel.Debug,(function(){return"approvals: Sending request to query approvals"})),t._session.performSessionExchange(o).then((function(t){return t.data.approvals.map((function(t){return new e.impl.ManagedMobileApprovalImpl(t)}))}))})))},t.prototype.changeApprovalStatus=function(t,o,r){var i=this;return this._sdk.log(e.LogLevel.Debug,(function(){return"approval: change status of approval "+t.getApproval().getApprovalId()+" to "+o})),this._sdk.log(e.LogLevel.Debug,(function(){return"approval: Initiating request promise"})),this._sdk.promiseCollectionResult().then((function(n){return i._sdk.log(e.LogLevel.Debug,(function(){return"approval: Collection done; setting up request"})),i._session.createApprovalReplyRequest(n,t.getApproval().getApprovalId(),o)})).then((function(s){i._sdk.log(e.LogLevel.Debug,(function(){return"approval: Initiating control flow"}));var a=new n(s.getFlowId());return a.approval=t.getApproval(),i._session.startControlFlow(s,a,r||i._clientContext).then((function(e){return t.getApproval().updateStatus(o),i.updateManagedApprovals(i._managedApprovals),e}),(function(t){var n=e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t);throw i._sdk.log(e.LogLevel.Debug,(function(){return"approval: Got server error "+n})),n.getErrorCode()==e.AuthenticationErrorCode.Internal&&n.getData()&&6001==n.getData().server_error_code?(i._sdk.log(e.LogLevel.Debug,(function(){return"approval: Converting server error"})),new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.ApprovalWrongState,n.getMessage())):n}))}))},t}();t.ApprovalSessionProcessor=o})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var $=f&&f.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{u(o.next(t))}catch(t){i(t)}}function a(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((o=o.apply(t,e||[])).next())}))},X=f&&f.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};!function(t){!function(t){!function(t){var e;(function(t){var n=function(t){function e(e,n){var o=t.call(this,e)||this;return n&&(o.flowId=n),o}return V(e,t),e.prototype.serializeTo=function(e){t.prototype.serializeTo.call(this,e),e.writePrimitive("flowId",this.flowId)},e.prototype.serializeFrom=function(e){t.prototype.serializeFrom.call(this,e),this.flowId=e.readPrimitive("flowId")},e}(t.MultiStageResumableProcessContinuation);t.ResumableControlFlowRequestContinuation=n;var o=function(e){function n(n,o){var r=e.call(this)||this;return n instanceof t.Session?r.initFromSession(n):r.serializeFrom(n),r}return V(n,e),Object.defineProperty(n.prototype,"userRecord",{get:function(){return this._userRecord},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"usedSessionJson",{get:function(){return this._sessionJson},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controlFlowContinuation",{get:function(){return this._cflowContinuation},enumerable:!1,configurable:!0}),n.prototype.createUsedSession=function(e){var n=t.User.fromUserRecord(this._userRecord,e);return t.Session.fromJsonWithUser(e,this._sessionJson,n)},n.prototype.serializeTo=function(t){t.writePrimitive("user",this._userRecord),t.writePrimitive("session",this._sessionJson),t.writeObject("cflowContinuation",this._cflowContinuation)},n.prototype.serializeFrom=function(t){this._userRecord=t.readPrimitive("user"),this._sessionJson=t.readPrimitive("session"),this._cflowContinuation=t.readObject("cflowContinuation")},n.prototype.initFromSession=function(e){this._sessionJson=e.toJson(),this._userRecord=t.User.toUserRecord(e.user),this._cflowContinuation=e.createCurrentControlFlowContinuation()},n}(t.ResumableProcessStageContinuation);t.ExecuteControlFlowStageContinuation=o;var r=function(){function t(t){this._ownerRequest=t,this._rtContext=t.rtContext}return Object.defineProperty(t.prototype,"clientContext",{get:function(){return this._rtContext.clientContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdk",{get:function(){return this._rtContext.sdk},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uiHandler",{get:function(){return this._rtContext.uiHandler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdkSessionManagementServices",{get:function(){return this._rtContext.sdkSessionManagementServices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"session",{get:function(){return this._usedSession},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return this._usedSession.user},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"additionalParameters",{get:function(){return this._additionalParameters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"policy",{get:function(){return this._policy},enumerable:!1,configurable:!0}),t.prototype.run=function(){return this.runOrContinue()},t.prototype.resume=function(t,n){var r=this;return new Promise((function(i,s){if(!(t instanceof o))return Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid continuation type for resume"));r.restoreParametersFromContinuation(t),r.runOrContinue(t,n).then(i,s)}))},t.prototype.restoreParametersFromContinuation=function(t){this._usedSession=t.createUsedSession(this.sdk)},t.prototype.postProcessControlFlowResult=function(t){return t},t.prototype.prepareForControlFlowExecution=function(){},t.prototype.handleControlFlowError=function(t){},t.prototype.createNextStage=function(t){return new s(this._ownerRequest,this._usedSession,t)},t.prototype.runOrContinue=function(t,n){var o=this;return this._usedSession.lock(),new Promise((function(r,i){var s;o.sdk.log(e.LogLevel.Debug,(function(){return"Running "+o.opName+" for user "+(o.user.userId||o.user.idToken)+"; continuation: "+!!t})),o.sdk.ensureConfigured(),o.prepareForControlFlowExecution(),t?(o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Resuming control flow from continuation"})),s=o._usedSession.continueControlFlow(t.controlFlowContinuation,n,o._ownerRequest,o.clientContext)):o._inlineControlFlowInitiationServerResponse?(o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Non continuation, starting control flow with inline server response"})),s=o._usedSession.startControlFlow(o._inlineControlFlowInitiationServerResponse,o._ownerRequest,o.clientContext)):(o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Non continuation, starting control flow with server request"})),s=e.util.wrapPromiseWithActivityIndicator(o.uiHandler,null,o.clientContext,o.generateControlFlowRequest()).then((function(t){return o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Starting control flow"})),o._usedSession.startControlFlow(t,o._ownerRequest,o.clientContext)}))),s.then((function(t){return r(o.postProcessControlFlowResult(t))}),(function(t){if(t.getErrorCode()==e.AuthenticationErrorCode.Internal&&t.getData()){var n=t.getData();t=e.impl.AuthenticationErrorImpl.errorForHostInternalErrorData(n)||t}o.handleControlFlowError(t),i(t)}))})).finally((function(){o._usedSession.unlock()})).catch((function(t){return Promise.reject(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))})).then((function(t){return o.createNextStage(t)}))},t.prototype.getFlowId=function(){return this._ownerRequest.getFlowId()},t}();t.ExecuteControlFlowStage=r;var i=function(n){function o(t){var e=n.call(this)||this;return t instanceof s?e.initFromProc(t):e.serializeFrom(t),e}return V(o,n),Object.defineProperty(o.prototype,"redirectionContinuation",{get:function(){return this._redirectionContinuation},enumerable:!1,configurable:!0}),o.prototype.serializeTo=function(t){t.writeObject("redirectionContinuation",this._redirectionContinuation)},o.prototype.serializeFrom=function(t){this._redirectionContinuation=t.readNonNullObject("redirectionContinuation")},o.prototype.initFromProc=function(t){var n=t.requestProcess;if(!n)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid state for requesting contination");this._redirectionContinuation=n.createContinuation()},o.prototype.createResumableProcess=function(t){return new s(t)},o=z([t.Serializable("RunRedirectsStageContinuation"),J("design:paramtypes",[Object])],o)}(t.ResumableProcessStageContinuation),s=function(){function n(t,e,n){this._ownerRequest=t,this._rtContext=t.rtContext,this._usedSession=e||null,this._authResult=n||null;var o=n&&this._authResult.getInternalData();this._redirectData=o&&o.redirect&&o.redirect}return Object.defineProperty(n.prototype,"requestProcess",{get:function(){return this._requestProcess},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clientContext",{get:function(){return this._rtContext.clientContext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sdk",{get:function(){return this._rtContext.sdk},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"uiHandler",{get:function(){return this._rtContext.uiHandler},enumerable:!1,configurable:!0}),n.prototype.createContinuation=function(){return new i(this)},n.prototype.run=function(){return $(this,void 0,void 0,(function(){var n,o,r,i;return X(this,(function(s){switch(s.label){case 0:if(!this._authResult)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid resumable control flow request state");return this._redirectData?[3,1]:[2,this._authResult];case 1:return n=this._redirectData,o=n.policy_id||null,r=n.target.user_id||n.target.token||null,[4,this.uiHandler.handlePolicyRedirect(t.Protocol.RedirectTypeMap[n.redirect_type],o,r,n.params,this.clientContext)];case 2:switch((i=s.sent()).getAdditionalParametersOverride()&&(n.params=i.getAdditionalParametersOverride()),i.getRedirectResponse()){case e.RedirectResponseType.RedirectToPolicy:return[2,this.processRedirectRequest(n)];case e.RedirectResponseType.CancelRedirect:throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.UserCanceled,"Redirection to next policy canceled.");default:throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid redirect response type.")}case 3:return[2]}}))}))},n.prototype.resume=function(t,n){return t instanceof i?(this._requestProcess=t.redirectionContinuation.createResumableProcess(this._rtContext),this._requestProcess.resume(t.redirectionContinuation,n)):Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid continuation type for resume"))},n.prototype.runtimeContextForCallee=function(){return{clientContext:this.clientContext,sdk:this.sdk,sdkSessionManagementServices:this._ownerRequest.rtContext.sdkSessionManagementServices,uiHandler:this.uiHandler,caller:this._ownerRequest}},n.prototype.processRedirectRequest=function(n){return $(this,void 0,void 0,(function(){var o,r,i,s,a,u,c,l,p,h,d,f=this;return X(this,(function(m){if(!this._usedSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid resumable control flow request state");if(o=n.policy_id||null,r=n.params,i=this._usedSession.user,"current"==n.target.type);else if("user_id"==n.target.type){if(!(s=n.target.user_id||this._usedSession.user.userId))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"failed to resolve user id for redirect request <"+n.redirect_type+", "+n.target.type+">");s!=this._usedSession.user.userId&&(this.sdk.log(e.LogLevel.Debug,(function(){return"User id in request is different than that of the current user <"+s+", "+f._usedSession.user.userId+">"})),i=t.User.findUser(this.sdk,s)||t.User.createUserWithUserId(this.sdk,s))}else{if("uid_token"!=n.target.type)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Unhandled redirect target type '"+n.target.type+"'");if(a=n.target.uid_hash,!(u=n.target.token||this._usedSession.user.idToken))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"failed to resolve id token for redirect request <"+n.redirect_type+", "+n.target.type+">");u!=this._usedSession.user.idToken&&(this.sdk.log(e.LogLevel.Debug,(function(){return"Id token in request is different than that of the current user <"+u+", "+f._usedSession.user.idToken+">"})),i=a&&t.User.findUserByUidHash(this.sdk,a)||t.User.findUser(this.sdk,u)||t.User.createUserWithIdToken(this.sdk,u,a))}switch(this.sdk.log(e.LogLevel.Info,(function(){return"control flow || type:"+n.redirect_type+" policy: "+o})),(c=n.redirect_type)===t.Protocol.RedirectTypeName.RedirectTypeNameBindOrAuthenticate&&(c=i.deviceBound?t.Protocol.RedirectTypeName.RedirectTypeNameAuthenticate:t.Protocol.RedirectTypeName.RedirectTypeNameBind),l=this.runtimeContextForCallee(),c){case t.Protocol.RedirectTypeName.RedirectTypeNameAuthenticate:return p=new t.AuthenticateControlFlowRequest(l,this._ownerRequest.getFlowId()),this._requestProcess=p,[2,p.run(i,o,r)];case t.Protocol.RedirectTypeName.RedirectTypeNameBind:return h=new t.BindControlFlowRequest(l,this._ownerRequest.getFlowId()),this._requestProcess=h,[2,h.run(i,r)];case t.Protocol.RedirectTypeName.RedirectTypeNameInvokePolicy:return d=new t.InvokePolicyControlFlowRequest(l,this._ownerRequest.getFlowId()),this._requestProcess=d,[2,d.run(o,r)];default:throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Unhandled redirect type '"+n.redirect_type+"'")}}))}))},n}();t.RunRedirectsStage=s;var a=function(t){function e(e,n){var o=t.call(this,e)||this;return o._flowId=n,o}return V(e,t),Object.defineProperty(e.prototype,"topmost",{get:function(){for(var t=this;t.rtContext.caller;)t=t.rtContext.caller;return t},enumerable:!1,configurable:!0}),e.prototype.getFlowId=function(){return this._flowId},e}(t.MultiStageResumableProcess);t.ResumableControlFlowRequest=a;var u=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return V(o,n),o.prototype.prepareForControlFlowExecution=function(){if(this.sdk.currentSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to start a session (bind) with a current primary active session.");this.sdkSessionManagementServices.setCurrentSession(this._usedSession)},o.prototype.handleControlFlowError=function(t){this.sdk.log(e.LogLevel.Debug,(function(){return"Clearing session after error"})),this.sdkSessionManagementServices.setCurrentSession(null),this.sdkSessionManagementServices.saveCurrentSession()},o.prototype.postProcessControlFlowResult=function(e){return this._usedSession.persistUserData&&t.User.save(this.sdk,this._usedSession.user),this.sdkSessionManagementServices.saveCurrentSession(),t.Session.notifySessionObserversOnMainSessionLogin(this._usedSession),e},o.prototype.createNextStage=function(t){return new l(this._ownerRequest,this._usedSession,t)},o}(r);t.SessionSetupExecuteControlFlowStage=u;var c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.createResumableProcess=function(t){return new l(t)},n=z([t.Serializable("SessionSetupProcessRedirectsStageContination")],n)}(i),l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.resume=function(e,n){var o=this;return t.prototype.resume.call(this,e,n).catch((function(t){return o.handleRedirectionError(t)}))},n.prototype.processRedirectRequest=function(e){var n=this;return t.prototype.processRedirectRequest.call(this,e).catch((function(t){return n.handleRedirectionError(t)}))},n.prototype.createContinuation=function(){return new c(this)},n.prototype.handleRedirectionError=function(t){return this.sdk.apiLevel>=10?(this.sdk.log(e.LogLevel.Debug,(function(){return"Error in redirect after session establishing call. Logging out session."})),this.sdk.logout().then((function(e){throw t}),(function(e){throw t}))):Promise.reject(t)},n}(s);t.SessionSetupRunRedirectsStage=l;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e}(a);t.SessionSetupResumableControlFlowRequest=p})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new o(t)},n=z([e.Serializable("AuthenticateRequestExecuteControlFlowStageContinuation")],n)}(e.ExecuteControlFlowStageContinuation);e.AuthenticateRequestExecuteControlFlowStageContinuation=n;var o=function(o){function r(t,e,n,r){void 0===r&&(r=null);var i=o.call(this,t)||this;return i.opName="authenticate",e&&(i._usedSession=e,i._additionalParameters=n,i._policy=r),i}return V(r,o),r.generateLoginRequest=function(t,n){var o={collection_result:t.toJson(),push_token:n.sdkSessionManagementServices.lastReceivedPushToken};return n.policy&&(o.policy_request_id=n.policy),n.additionalParameters&&(o.params=n.additionalParameters),new e.SessionExchangeRequest("POST","auth/login",o,[],n.getFlowId())},r.prototype.generateControlFlowRequest=function(){var e=this;return this.sdk.promiseCollectionResult().then((function(n){return e.sdk.log(t.LogLevel.Debug,(function(){return"authenticate: Collection done; setting up request"})),r.generateLoginRequest(n,e)}))},r.prototype.postProcessControlFlowResult=function(e){return this.sdk.log(t.LogLevel.Debug,(function(){return"authenticate: marking user has logged in after succesful completion"})),this.user.markLoggedIn(),o.prototype.postProcessControlFlowResult.call(this,e)},r.prototype.createContinuation=function(){return new n(this.session,this.getFlowId())},r}(e.SessionSetupExecuteControlFlowStage);e.AuthenticateRequestExecuteControlFlowStage=o;var r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new i(t,this.flowId)},n=z([e.Serializable("AuthenticateControlFlowRequestContinuation")],n)}(e.ResumableControlFlowRequestContinuation),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createContinuation=function(){return new r(this,this.getFlowId())},n.prototype.run=function(t,n,r){return this.startWithStage(new o(this,new e.Session(this.rtContext.sdk,t),r,n))},n}(e.SessionSetupResumableControlFlowRequest);e.AuthenticateControlFlowRequest=i}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){!function(n){!function(o){var r;!function(t){t[t.Builtin=0]="Builtin",t[t.Placeholder=1]="Placeholder",t[t.OTP=2]="OTP",t[t.Totp=3]="Totp",t[t.MobileApprove=4]="MobileApprove"}(r=o.AuthenticatorPrototype||(o.AuthenticatorPrototype={}));var i=function(){function i(e,n,o,i){this._session=e,this._authenticatorId=n;var s=n.match(/^placeholder_(.*)$/);if(s){this._authenticatorPrototype=r.Placeholder,this._placeholderId=s[1];var a=o;this._authetnicationMethodTypeName=a.placeholder_type}else n.match(/^otp_(.*)$/)?(this._authenticatorPrototype=r.OTP,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMultiStep()):n.match(/^totp_(.*)$/)?(this._authenticatorPrototype=r.Totp,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMultiStep()):n.match(/^mobile_approve_(.*)$/)?(this._authenticatorPrototype=r.MobileApprove,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMobileApprove()):(this._authenticatorPrototype=r.Builtin,this._authetnicationMethodTypeName=this._authenticatorId);this._authenticatorMethodConfig=o,this._serverReportedRegistrationStatus=i.status,this._expired=i.expired||!1,this._locked=i.locked||!1,o.recovery_escape&&(this._recoveryEscapeOption=new t.ts.mobile.sdk.impl.EscapeOptionImpl(o.recovery_escape))}return Object.defineProperty(i.prototype,"authenticationDriverDescriptor",{get:function(){var e=this.internalAuthenticationDriverDescriptor();if(!e)throw new t.ts.mobile.sdk.impl.AuthenticationErrorImpl(t.ts.mobile.sdk.AuthenticationErrorCode.Internal,"Unhandled authenticator: "+this.getAuthenticatorId());return e},enumerable:!1,configurable:!0}),i.prototype.internalAuthenticationDriverDescriptor=function(){switch(this._authenticatorPrototype){case r.Placeholder:return o.AuthenticatorDrivers.__placeholder;case r.Totp:case r.OTP:var t=this.getAuthenticatorIdForMultiStep();return o.AuthenticatorDrivers[t];case r.MobileApprove:var e=this.getAuthenticatorIdForMobileApprove();return o.AuthenticatorDrivers[e];case r.Builtin:default:return o.AuthenticatorDrivers[this.getAuthenticatorId()]}},i.prototype.getAuthenticatorIdForMobileApprove=function(){var t=this._authenticatorId.split("_");return t[0]+"_"+t[1]},i.prototype.getAuthenticatorIdForMultiStep=function(){return""+this._authenticatorId.split("_")[0]},i.prototype.getAuthenticatorId=function(){return this._authenticatorId},i.prototype.getType=function(){var t=n.Protocol.AuthTypeData[this._authetnicationMethodTypeName];return t&&"authTypeEnum"in t?t.authTypeEnum:e.AuthenticatorType.Generic},i.prototype.getName=function(){var t=n.Protocol.AuthTypeData[this._authetnicationMethodTypeName];return t&&t.authTypeName||"Generic"},i.prototype.getExpired=function(){return this._expired},i.prototype.getRegistered=function(){return this.getRegistrationStatus()==e.AuthenticatorRegistrationStatus.Registered},i.prototype.getRegistrationStatus=function(){return this._serverReportedRegistrationStatus!=n.Protocol.AuthenticationMethodStatus.Registered?e.AuthenticatorRegistrationStatus.Unregistered:this.authenticationDriverDescriptor.evaluateLocalRegistrationStatus(this._session)},i.prototype.getLocked=function(){return this._locked},i.prototype.getDefaultAuthenticator=function(){return this._session.user.defaultAuthId==this.getAuthenticatorId()},i.prototype.getSupportedOnDevice=function(){return this.internalAuthenticationDriverDescriptor()&&this.authenticationDriverDescriptor.isSupportedOnDevice(this._session)},i.prototype.getPlaceholderId=function(){return this._placeholderId},i.prototype.updateWithAuthenticatorState=function(t){this._expired=t.expired||!1,this._locked=t.locked||!1,this._serverReportedRegistrationStatus=t.status},i.prototype.getCredentialRecoveryEscapeOption=function(){return this._recoveryEscapeOption},i}();o.AuthenticatorDescriptionImpl=i}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),e=r.core||(r.core={}),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getEnabled=function(){return this.getSupportedOnDevice()},e}(e.authenticationdrivers.AuthenticatorDescriptionImpl),o=function(){function t(t,e,n,o){this._sdk=t,this._session=e,this._token=o||null,this._clientContext=n,this._uiHandler=this._sdk.currentUiHandler,this._uiContextImpl=new r.impl.UIContextImpl(t)}return t.prototype.getUiContext=function(){return this._uiContextImpl},t.prototype.run=function(){var t=this;return this._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Starting session"})),this.queryConfigMenuFromServerAndFilter().then((function(e){return new Promise((function(n,o){t.kickStartSession(e),t._completeFn=n,t._rejectFn=o}))}))},t.prototype.registerAuthenticator=function(t,e){return this.requestAuthenticatorRegistrationChange(t,!0,e)},t.prototype.reregisterAuthenticator=function(t,e){return this.requestAuthenticatorRegistrationChange(t,!0,e)},t.prototype.setDefaultAuthenticator=function(t){var n=this;return this._sdk.log(r.LogLevel.Info,(function(){return"Configuration: Updating user default authenticator."})),new Promise((function(o,r){if(!n._session.anonymous){var i=n._session.user;i.updateDefaultAuthId(t.getDescription().getAuthenticatorId()),n._session.persistUserData&&e.User.save(n._sdk,i)}o(!0),n.updateManagedAuthenticators(n._authenticators)}))},t.prototype.unregisterAuthenticator=function(t,e){return this.requestAuthenticatorRegistrationChange(t,!1,e).then((function(t){return!0}))},t.prototype.requestRefreshAuthenticators=function(){var t=this;return this.queryConfigMenuFromServerAndFilter().then((function(e){return t.updateManagedAuthenticators(e),!0}),(function(t){throw r.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))},t.prototype.finishSession=function(){if(!this._appSession)throw new r.impl.AuthenticationErrorImpl(r.AuthenticationErrorCode.Internal,"Attempt to finish a non started config session.");this._appSession.endSession(),this._appSession=null,this._completeFn(!0)},t.prototype.kickStartSession=function(t){this._appSession=this._uiHandler.createAuthenticationConfigurationSession(this._session.user.displayName),this._appSession?(this._appSession.startSession(this,null,this._clientContext),this.updateManagedAuthenticators(t)):this._rejectFn(r.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createAuthenticationConfigurationSession."))},t.prototype.updateManagedAuthenticators=function(t){if(!this._appSession)throw new r.impl.AuthenticationErrorImpl(r.AuthenticationErrorCode.Internal,"Attempt to work with a non started config session.");var e={};t.forEach((function(t){e[t.getDescription().getAuthenticatorId()]=t})),this._authenticators=t,this._authenticatorsByName=e,this._appSession.setAuthenticatorsList(t)},t.prototype.queryConfigMenuFromServerAndFilter=function(){var t=this;this._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Initiating collection"}));var e=this._sdk.promiseCollectionResult();return r.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,e.then((function(e){t._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Collection done; setting up request to query for config menu"}));var o=t._session.createConfigMenuFetchRequest(e,t._token);return t._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Sending request to query approvals"})),t._session.performSessionExchange(o).then((function(e){var o=e.data&&"configuration"==e.data.type&&e.data;if(!o)throw new r.impl.AuthenticationErrorImpl(r.AuthenticationErrorCode.Internal,"Invalid configuration screen structure encountered.");return o.methods.map((function(e){var o=new n(t._session,e.type,e,e);return new r.impl.ConfigurableAuthenticatorImpl(o,e.options)})).filter((function(t){return t.getDescription().getSupportedOnDevice()}))}))})))},t.prototype.requestAuthenticatorRegistrationChange=function(t,n,o){var i=this;this._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Authenticator "+t.getDescription().getName()+" request (un)registration "+n})),this._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Initiating registration request promise"}));var s=this._sdk.promiseCollectionResult().then((function(e){return i._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Collection done; setting up request"})),i._session.createAuthRegistrationRequest(e,t.getDescription().getAuthenticatorId(),n,i._token)}));return this._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Initiating control flow"})),s.then((function(s){return i._session.startControlFlow(s,null,o||i._clientContext).then((function(o){var s=o.getInternalData(),a=!1;if(s&&s.methods&&s.methods.length&&(i._sdk.log(r.LogLevel.Debug,(function(){return"configuration: Processing updates."})),s.methods.forEach((function(t){var e=i._authenticatorsByName[t.type];e&&(e.getDescription().updateWithAuthenticatorState(t),a=!0)}))),a){if(!n&&t.getDescription().getDefaultAuthenticator()&&!i._session.anonymous){var u=i._session.user;u.updateDefaultAuthId(""),i._session.persistUserData&&e.User.save(i._sdk,u)}i.updateManagedAuthenticators(i._authenticators)}return o}),(function(t){throw r.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))}))},t}(),e.AuthenticationConfigurationSessionProcessor=o}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(t){var e=function(){function t(t,e){this._sdk=t,this._user=e}return Object.defineProperty(t.prototype,"user",{get:function(){return this._user},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),t}();t.BaseSession=e;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e}(e);t.LocalSession=n})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.createResumableProcess=function(t){return new r(t)},e=z([n.Serializable("BindRequestExecuteControlFlowStageContinuation")],e)}(n.ExecuteControlFlowStageContinuation),r=function(r){function i(t,e,n){var o=r.call(this,t)||this;return o.opName="bind",e&&(o._usedSession=e,o._additionalParameters=n),o}return V(i,r),i.prototype.generateControlFlowRequest=function(){var o=this;this.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Generating new device keys for "+(o.user.userId||o.user.idToken)}));var r=this.sdk.host.generateKeyPair(this.user.deviceSigningKeyTag,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.None,!0),i=this.sdk.host.generateKeyPair(this.user.deviceEncryptionKeyTag,t.sdkhost.KeyClass.StdEncryptionKey,t.sdkhost.KeyBiometricProtectionMode.None,!0);return Promise.all([r,i]).then((function(t){var r=t[0],i=t[1];return o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": key generation done"})),o.sdk.promiseCollectionResult().then((function(t){o.sdk.log(e.LogLevel.Debug,(function(){return o.opName+": Collection result completed, Initiating request promise"}));var s={collection_result:t.toJson(),public_key:r.publicKeyToJson(),push_token:o.sdkSessionManagementServices.lastReceivedPushToken};return i&&(s.encryption_public_key=i.publicKeyToJson()),o.additionalParameters&&(s.params=o.additionalParameters),new n.SessionExchangeRequest("POST","auth/bind",s,[],o.getFlowId())}))}))},i.prototype.postProcessControlFlowResult=function(t){var n=this,o=this.sdk.currentSession&&this.sdk.currentSession.deviceId();return this.sdk.currentSession&&o&&(this.sdk.log(e.LogLevel.Debug,(function(){return n.opName+": binding device to user after succesful completion"})),this.sdk.currentSession.user.bindDeviceToUser(o)),r.prototype.postProcessControlFlowResult.call(this,t)},i.prototype.createContinuation=function(){return new o(this.session,this.getFlowId())},i}(n.SessionSetupExecuteControlFlowStage);n.BindRequestExecuteControlFlowStage=r;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.createResumableProcess=function(t){return new s(t,this.flowId)},e=z([n.Serializable("BindControlFlowRequestContinuation")],e)}(n.ResumableControlFlowRequestContinuation),s=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return V(o,t),o.prototype.createContinuation=function(){return new i(this,this.getFlowId())},o.prototype.run=function(t,o){var i=this;return new Promise((function(s,a){i._ctxt.sdk.deviceSupportsCryptoBinding()?t.deviceBound?a(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to bind an already bound user on this device.",{user:t.userHandle})):s(i.startWithStage(new r(i,new n.Session(i.rtContext.sdk,t),o))):a(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"cryptographic binding is not supported for this device"))}))},o}(n.SessionSetupResumableControlFlowRequest);n.BindControlFlowRequest=s}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.core||(o.core={}),n=function(){function t(t,e){if(this.sdk=t,this.ec=new elliptic.ec("secp256k1"),e&&(this.sessionId=e.session_id,this.aesKey=this.base64ToJsArray(e.key),!this.isReady()))throw new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.Internal,"Can't deserialize crypto session")}return t.prototype.getExchangeRequestHeader=function(){if(!this.kp){var t={entropy:this.sdk.host.generateRandomHexString(192),entropyEnc:"hex"};this.kp=this.ec.genKeyPair(t)}return{type:"key_exchange",scheme:2,y:this.jsArrayToBase64(this.kp.getPublic().encode())}},t.prototype.processExchangeResponseHeader=function(t){if(2!=t.scheme)throw"Unsupported crypto scheme "+t.scheme;this.sessionId=t.crypto_session_id;var e=this.kp.derive(this.ec.keyFromPublic(atob(t.y)).getPublic()),n=sha256.create();n.update(e.toArray("be",32)),this.aesKey=n.digest()},t.prototype.isReady=function(){return!(!this.aesKey||!this.sessionId)},t.prototype.decryptResponse=function(t){var e=null;if(t.headers.forEach((function(t){"encryption"==t.type&&(e=t)})),e){var n=this.base64ToJsArray(e.iv),o=new aesjs.ModeOfOperation.cbc(this.aesKey,n),r=this.base64ToJsArray(t.data),i=o.decrypt(r),s=aesjs.utils.utf8.fromBytes(i);s=this.pkcs7Unpad(s),t.data=JSON.parse(s)}return t},t.prototype.encryptRequest=function(t){var e=this,n=this.sdk.host.generateRandomHexString(32),r=aesjs.utils.hex.toBytes(n),i={type:"encryption",iv:o.util.hexToBase64(n),crypto_session_id:this.sessionId},s=t.headers.map((function(t){return e.encryptStringToBase64(JSON.stringify(t),r)})),a=JSON.stringify(t.data),u=this.encryptStringToBase64(a,r);t.headers=[i],t.enc_headers=s,t.data=u},t.prototype.encryptStringToBase64=function(t,e){var n=new aesjs.ModeOfOperation.cbc(this.aesKey,e),o=aesjs.utils.utf8.toBytes(t),r=this.pkcs7Pad(o),i=n.encrypt(r);return this.jsArrayToBase64(i)},t.prototype.toJson=function(){return{scheme:2,session_id:this.sessionId,key:this.jsArrayToBase64(this.aesKey)}},t.fromJson=function(e,n){return new t(e,n)},t.prototype.jsArrayToBase64=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)},t.prototype.base64ToJsArray=function(t){for(var e=atob(t),n=[],o=0;o<e.length;o++)n.push(e.charCodeAt(o));return n},t.prototype.pkcs7Pad=function(t){var e=16-t.length%16,n=new Uint8Array(t.length+e);n.set(t,0);for(var o=0;o<e;o++)n[t.length+o]=e;return n},t.prototype.pkcs7Unpad=function(t){var e=t.charCodeAt(t.length-1);return t.slice(0,-e)},t}(),e.Scheme2CryptoSession=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(t){var n;!function(t){t[t.FinishSession=0]="FinishSession",t[t.CurrentDeviceDeleted=1]="CurrentDeviceDeleted"}(n=t.DeviceManagementSessionProcessorReturnReason||(t.DeviceManagementSessionProcessorReturnReason={}));var o=function(){function t(t,n,o,r){this._sdk=t,this._session=n,this._clientContext=o,this._token=r||null,this._uiHandler=this._sdk.currentUiHandler,this._uiContextImpl=new e.impl.UIContextImpl(t)}return t.prototype.getUiContext=function(){return this._uiContextImpl},t.prototype.run=function(){var t=this;return this._sdk.log(e.LogLevel.Debug,(function(){return"device management: Starting session"})),this.queryDevicesFromServer().then((function(e){return new Promise((function(n,o){t._completeFn=n,t._rejectFn=o,t.kickStartSession(e)}))}))},t.prototype.removeDevice=function(t,n){var o=this;return new Promise((function(r,i){if(t.getInfo().getIsCurrent())throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Illegal attempt to delete the current device using 'DeviceManagementSessionServices.removeDevice'. The current device must only be deleted using DeviceManagementSessionServices.removeCurrentDeviceAndFinishSession.");var s=o.ensureValidDevice(t);o.performDeviceAction(s,e.DeviceManagementAction.Remove,n,null).then((function(t){return o._sdk.log(e.LogLevel.Debug,(function(){return"device management: Updating device state locally"})),s.getInfo().setStatus(e.DeviceStatus.Removed),o.updateManagedDevices(o._managedDevices.filter((function(t){return t!=s}))),!0})).then(r,i)}))},t.prototype.removeCurrentDeviceAndFinishSession=function(t){var o,r=this;return this._appSession?(o=this._appSession,new Promise((function(i,s){r._sdk.log(e.LogLevel.Debug,(function(){return"device management: Start removing current device"}));var a=r._managedDevices.filter((function(t){return t.getInfo().getIsCurrent()}));if(1!=a.length)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Couldn't locate current device in device list.");var u=a[0];r.performDeviceAction(u,e.DeviceManagementAction.Remove,t,null).then((function(t){return r._sdk.log(e.LogLevel.Debug,(function(){return"device management: Updating device state locally"})),u.getInfo().setStatus(e.DeviceStatus.Removed),!0})).then((function(){i(!0),o.endSession(),r._appSession=null,r._completeFn(n.CurrentDeviceDeleted)})).catch(s)}))):Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to finish a non started device management session."))},t.prototype.renameDevice=function(t,n,o){var r=this;return new Promise((function(i,s){var a=r.ensureValidDevice(t),u={name:n};return r.performDeviceAction(a,e.DeviceManagementAction.Rename,o,u).then((function(t){return r._sdk.log(e.LogLevel.Debug,(function(){return"device management: Updating device state locally"})),a.getInfo().setName(n),r.updateManagedDevices(r._managedDevices),!0})).then(i,s)}))},t.prototype.requestRefreshDevices=function(){var t=this;return this.queryDevicesFromServer().then((function(e){return t.updateManagedDevices(e),!0}),(function(t){throw e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))},t.prototype.finishSession=function(){if(!this._appSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to finish a non started device management session.");this._appSession.endSession(),this._appSession=null,this._completeFn(n.FinishSession)},t.prototype.kickStartSession=function(t){this._appSession=this._sdk.currentUiHandler.createDeviceManagementSession(this._session.user.displayName),this._appSession?(this.updateManagedDevices(t),this._appSession.startSession(this,null,this._clientContext)):this._rejectFn(e.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createDeviceManagementSession."))},t.prototype.updateManagedDevices=function(t){if(!this._appSession)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to update device list for a non started device management session.");this._managedDevices=t,this._appSession.setSessionDevicesList(t)},t.prototype.queryDevicesFromServer=function(){var t=this;this._sdk.log(e.LogLevel.Debug,(function(){return"device management: Initiating collection"}));var n=this._sdk.promiseCollectionResult();return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,n.then((function(n){t._sdk.log(e.LogLevel.Debug,(function(){return"device management: Collection done; setting up request to query devices"}));var o=t._session.createDevicesFetchRequest(n,t._token);return t._sdk.log(e.LogLevel.Debug,(function(){return"device management: Sending request to query devices"})),t._session.startControlFlow(o,null,t._clientContext).then((function(n){return t._uiHandler.endActivityIndicator(null,t._clientContext),n.getInternalData().devices.map((function(n){var o=new e.impl.ManagedDeviceImpl(n);return o.getInfo().getDeviecId()==t._session.user.deviceId&&o.getInfo().forceCurrent(),o}))}))})))},t.prototype.performDeviceAction=function(t,n,o,r){var i,s=this,a=o||this._clientContext;switch(n){case e.DeviceManagementAction.Remove:i="remove";break;case e.DeviceManagementAction.Rename:i="name";break;default:return Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid device action specified "+n))}this._sdk.log(e.LogLevel.Debug,(function(){return"devices: action "+i+" on "+t.getInfo().getDeviecId()})),this._sdk.log(e.LogLevel.Debug,(function(){return"devices: Initiating collection"}));var u=this._sdk.promiseCollectionResult();return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,a,u.then((function(n){s._sdk.log(e.LogLevel.Debug,(function(){return"devices: Collection done; setting up request"}));var o=s._session.createDeviceActionRequest(n,s._token,t.getInfo().getDeviecId(),i,r);return s._sdk.log(e.LogLevel.Debug,(function(){return"devices: Sending request"})),s._session.startControlFlow(o,null,a).then((function(t){return t.getInternalData()}))})).catch((function(t){throw e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)})))},t.prototype.ensureValidDevice=function(t){var n=this._managedDevices.indexOf(t);if(n<0)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to perform a device action on a device not originally included in device management session.");return this._managedDevices[n]},t}();t.DeviceManagementSessionProcessor=o})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function e(t){this._name=t,this._extensions=[],e._extensionPoints[t]=this}return e.prototype.extend=function(t){this._extensions.push(t)},e.prototype.forEach=function(t){this._extensions.forEach(t)},e.prototype.first=function(t){var e=null;return this._extensions.forEach((function(n){!e&&t(n)&&(e=n)})),e},e.prototype.firstNonNull=function(t){var e=null;return this._extensions.forEach((function(n){e||(e=t(n))})),e},e.byName=function(e){var n=this._extensionPoints[e];if(!n)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid extension point requested: "+e);return n},e._extensionPoints={},e}();e.ExtensionPoint=n}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.createSuccessResponse=function(t){var n=new e.Fido2AuthenticatorSuccessResponse;return n.setFido2Response(t),n},n.createdFailedResponse=function(t){var n=new e.Fido2AuthenticationFailedResponse;return n.setFailureError(t),n},n}(t.InputResponseType);e.Fido2InputResponseInternal=n}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getFailureError=function(){return this._failureError},e.prototype.setFailureError=function(t){this._failureError=t},e}(t.Fido2InputResponseInternal);t.Fido2AuthenticationFailedResponse=e}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getFido2Response=function(){return this._fido2Response},e.prototype.setFido2Response=function(t){this._fido2Response=t},e}(t.Fido2InputResponseInternal);t.Fido2AuthenticatorSuccessResponse=e}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new o(t)},n=z([e.Serializable("InvokeAnonymousPolicyRequestExecuteControlFlowStageContinuation")],n)}(e.ExecuteControlFlowStageContinuation);e.InvokeAnonymousPolicyRequestExecuteControlFlowStageContinuation=n;var o=function(o){function r(t,e,n,r){void 0===n&&(n=null);var i=o.call(this,t)||this;return i.opName="invokeAnonymousPolicy",e&&(i._usedSession=e,null===n||"string"==typeof n?(i._additionalParameters=r,i._policy=n):i._inlineControlFlowInitiationServerResponse=n),i}return V(r,o),r.prototype.generateControlFlowRequest=function(){var n=this;return this.sdk.promiseCollectionResult(this.sdk.enabledCollectorsAnonymous).then((function(o){n.sdk.log(t.LogLevel.Debug,(function(){return"authenticate: Collection done; setting up request"}));var r={collection_result:o.toJson(),push_token:n.sdkSessionManagementServices.lastReceivedPushToken};return n.policy&&(r.policy_request_id=n.policy),n.additionalParameters&&(r.params=n.additionalParameters),new e.SessionExchangeRequest("POST","auth/anonymous_invoke",r,[],n.getFlowId())}))},r.prototype.createContinuation=function(){return new n(this.session,this.getFlowId())},r}(e.ExecuteControlFlowStage);e.InvokeAnonymousPolicyRequestExecuteControlFlowStage=o;var r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new i(t,this.flowId)},n=z([e.Serializable("InvokeAnonymousPolicyControlFlowRequestContinuation")],n)}(e.ResumableControlFlowRequestContinuation),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createContinuation=function(){return new r(this,this.getFlowId())},n.prototype.run=function(t,n){var r,i=e.Session.createAnonymousSession(this.rtContext.sdk);return r="string"!=typeof t&&t?new o(this,i,t):new o(this,i,t,n),this.startWithStage(r)},n}(e.ResumableControlFlowRequest);e.InvokeAnonymousPolicyControlFlowRequest=i}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new o(t)},n=z([e.Serializable("InvokePolicyRequestExecuteControlFlowStageContinuation")],n)}(e.ExecuteControlFlowStageContinuation),o=function(o){function r(t,e,n,r){void 0===r&&(r=null);var i=o.call(this,t)||this;return i.opName="invokePolicy",e&&(i._usedSession=e,i._additionalParameters=n,i._policy=r),i}return V(r,o),r.prototype.generateControlFlowRequest=function(){var n=this;return this.sdk.promiseCollectionResult().then((function(o){return n.sdk.log(t.LogLevel.Debug,(function(){return"invokePolicy: Collection done; setting up request"})),e.AuthenticateRequestExecuteControlFlowStage.generateLoginRequest(o,n)}))},r.prototype.restoreParametersFromContinuation=function(e){if(!this.sdk.currentSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to resume invokePolicy without an existing session.");o.prototype.restoreParametersFromContinuation.call(this,e);var n=this._usedSession;this._usedSession=this.sdk.currentSession,this.sdk.currentSession.updateFromContinuedSession(n)},r.prototype.createContinuation=function(){return new n(this.session,this.getFlowId())},r}(e.ExecuteControlFlowStage);e.InvokePolicyRequestControlFlowStage=o;var r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.createResumableProcess=function(t){return new i(t,this.flowId)},n=z([e.Serializable("InvokePolicyControlFlowRequestContinuation")],n)}(e.ResumableControlFlowRequestContinuation),i=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.createContinuation=function(){return new r(this,this.getFlowId())},n.prototype.run=function(e,n){return this.rtContext.sdk.currentSession?this.startWithStage(new o(this,this.rtContext.sdk.currentSession,n,e)):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to resume invokePolicy without an existing session."))},n}(e.ResumableControlFlowRequest);e.InvokePolicyControlFlowRequest=i}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.core||(o.core={}),n=function(){function t(){}return t.installOnSdk=function(e){e.setExternalLogger(new t)},t.prototype.log=function(t,e,n){var r="["+e+"] "+n;switch(t){case o.LogLevel.Debug:console.log(r);break;case o.LogLevel.Info:console.info(r);break;case o.LogLevel.Warning:console.warn(r);break;case o.LogLevel.Error:case o.LogLevel.Critical:console.error(r)}},t}(),e.JsConsoleLogger=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(n){var o,r;!function(t){t.Registering="registering",t.Registered="registered",t.Unregistered="unregistered"}(o=n.LocalEnrollmentStatus||(n.LocalEnrollmentStatus={})),function(t){t.None="none",t.Validated="validated",t.Invalidated="invalidated"}(r=n.LocalEnrollmentValidationStatus||(n.LocalEnrollmentValidationStatus={}));var i=function(){function t(t,e){this.pbkdf_iterations_count=t,this.pbkdf_key_size=e}return t.prototype.duplicate=function(){return new t(this.pbkdf_iterations_count,this.pbkdf_key_size)},t.prototype.toRecordFormat=function(){return{pbkdf_iterations_count:this.pbkdf_iterations_count,pbkdf_key_size:this.pbkdf_key_size}},t}();n.ClientCryptoSettingsRecordFormat=i;var s=function(){function t(t,e,n,o,r,i,s){this.salt=t,this.status=e,this.version=n,this.authenticatorId=o,this.cryptoSettings=r,this.validationStatus=i,this.publicKeyHash=s}return t.prototype.duplicate=function(){var e=null;this.cryptoSettings&&(e=this.cryptoSettings.duplicate());var n=new t(this.salt,this.status,this.version,this.authenticatorId,e,this.validationStatus,this.publicKeyHash);return n.keyMeterial=this.keyMeterial,this.authenticatorConfig&&(n.authenticatorConfig=JSON.parse(JSON.stringify(this.authenticatorConfig))),n},t.prototype.toRecordFormat=function(){var t=null;return this.cryptoSettings&&(t=this.cryptoSettings.toRecordFormat()),{salt:this.salt,status:this.status,version:this.version,authenticatorId:this.authenticatorId,cryptoSettings:t,validationStatus:this.validationStatus,publicKeyHash:this.publicKeyHash,keyMeterial:this.keyMeterial,authenticatorConfig:this.authenticatorConfig}},t}();n.LocalEnrollmentRecordFormat=s;var a=function(){function a(){}return Object.defineProperty(a.prototype,"salt",{get:function(){return this._record.salt},set:function(t){this._record.salt=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"status",{get:function(){return this._record.status||o.Unregistered},set:function(t){this._record.status=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"version",{get:function(){return this._record.version},set:function(t){this._record.version=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"authenticatorId",{get:function(){return this._record.authenticatorId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"validationStatus",{get:function(){return this._record.validationStatus},set:function(t){this._record.validationStatus=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"publicKeyHash",{get:function(){return this._record.publicKeyHash},set:function(t){this._record.publicKeyHash=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"cryptoSettings",{get:function(){return this._record.cryptoSettings?e.ClientCryptoSettings.create(this._record.cryptoSettings.pbkdf_iterations_count):null},set:function(t){this._record.cryptoSettings=t?new i(t.getLocalEnrollmentKeyIterationCount(),t.getLocalEnrollmentKeySizeInBytes()):null},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"keyMaterial",{get:function(){return this._record.keyMeterial},set:function(t){this._record.keyMeterial=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"authenticatorConfig",{get:function(){return this._record.authenticatorConfig},set:function(t){this._record.authenticatorConfig=t},enumerable:!1,configurable:!0}),a.prototype.setFingerprintDbSnapshot=function(t){this._record.fingerprintDbSsnapshot=t},a.enrollmentWithRecord=function(t){var e=new a,n=null;return t.cryptoSettings&&(n=new i(t.cryptoSettings.pbkdf_iterations_count,t.cryptoSettings.pbkdf_key_size)),e._record=new s(t.salt,t.status,t.version,t.authenticatorId,n,t.validationStatus,t.publicKeyHash),e.authenticatorConfig=t.authenticatorConfig,e.keyMaterial=t.keyMeterial,e},a.migrateFPEnrollmentsToDeviceBiometricsIfNeeded=function(o,r,i){var s=i.host.queryHostInfo(t.sdkhost.HostInformationKey.DeviceBiometricsSupported);if(s&&"false"!=s&&"true"==i.host.queryHostInfo(t.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation)){var a=o[n.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName];a&&(i.log(e.LogLevel.Debug,(function(){return"migrating Fingerprint enrollment to DeviceBiometrics for user "+r.displayName})),a.version="v0_"+a.version,a.authenticatorId=n.authenticationdrivers.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,delete o[n.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName],o[n.authenticationdrivers.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName]=a,i.host.writeStorageKey(this.storageKeyForEnrollmentsForUser(r.guid),o))}return o},a.enrollmentsForUser=function(t,n){var o={},r=n.host.readStorageKey(this.storageKeyForEnrollmentsForUser(t.guid));for(var i in r=a.migrateFPEnrollmentsToDeviceBiometricsIfNeeded(r,t,n),n.log(e.LogLevel.Debug,(function(){return"Got db "+JSON.stringify(r)})),r)n.log(e.LogLevel.Debug,(function(){return"Got db wEnrollmentKey"+i})),o[i]=a.enrollmentWithRecord(r[i]);return o},a.deleteEnrollmentsForUser=function(t,e){e.host.deleteStorageKey(this.storageKeyForEnrollmentsForUser(t.guid))},a.createNew=function(t,e,n,i,u){var c=new s(n,o.Unregistered,e,t,null,r.None,u),l=new a;return l._record=c,l},a.prototype.duplicate=function(){var t=new a;return t._record=this._record.duplicate(),t},a.updateEnrollmentsForUser=function(t,e,n){var o={};for(var r in e)o[r]=e[r]._record.toRecordFormat();n.host.writeStorageKey(this.storageKeyForEnrollmentsForUser(t.guid),o)},a.invalidateLocalRegistrationStatusAndNotifyUIHandler=function(t,n){return new Promise((function(o,i){if(!t)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"No user interaction session provider!");t._sdk.log(e.LogLevel.Info,(function(){return"Marking authenticator as invalidated and invoking UI Handler"}));var s=t._session.user.localEnrollments[n.getAuthenticatorId()];s.validationStatus=r.Invalidated,t._session.user.updateEnrollmentRecord(s),t._uiHandler.localAuthenticatorInvalidated(n,t._clientContext).then((function(t){o(t)}))}))},a.storageKeyForEnrollmentsForUser=function(t){return new n.TarsusKeyPath("per_user",t.toString(),"local_enrollments")},a.listInvalidatedLocalEnrollments=function(t){var e,n=new Array;for(var o in t.user.localEnrollments)(e=t.user.localEnrollments[o]).validationStatus==r.Invalidated&&n.push(e);return n},a}();n.LocalEnrollment=a})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){function n(t){return void 0!==t.ref}e.isRefType=n,e.unwrap=function(e){if(n(e))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"style property "+e+" is not the right format");return e}}(e.Protocol||(e.Protocol={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){t.TARSUS_EXTENSION_POINT_NAME_MESSAGE_FILTERS="com.ts.mobile.sdk.core.messageFilters",t.TARSUS_EXTENSION_POINT_NAME_SESSION_OBSERVERS="com.ts.mobile.sdk.core.sessionObservers",t.TARSUS_EXTENSION_POINT_NAME_PLACEHOLDER_EXTENSION="com.ts.mobile.sdk.core.placeholderExtension",t.TARSUS_EXTENSION_POINT_NAME_FORMS_EXTENSION="com.ts.mobile.plugins.form.settings",t.TARSUS_EXTENSION_POINT_NAME_IDP_LOGIN_PROVIDER="com.ts.mobile.plugins.providers.idp",t.TARSUS_EXTENSION_POINT_NAME_KYC="com.ts.mobile.plugins.kyc",t.TARSUS_EXTENSION_POINT_NAME_SEED_BASED_TOTP_CALCULATOR="com.ts.mobile.plugins.totp.seedBasedTotpCalculator"}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.core||(o.core={}),n=function(){function t(t){this._sdk=t}return Object.defineProperty(t.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),t.prototype.createClientStringsRequest=function(t){return new e.PublicExchangeRequest("GET","resources/localization?locale="+t+"&v=1",{})},t.prototype.performRequest=function(t){var n=this;return this._sdk.log(o.LogLevel.Debug,(function(){return"Preprocess request "+JSON.stringify(t)})),this.createTransportRequestForPublicExchangeRequest(t).then((function(t){return n.prepareTransportRequest(t).then((function(t){return n._sdk.log(o.LogLevel.Debug,(function(){return"Will send request "+JSON.stringify(t)})),n._sdk.transportProvider.sendRequest(t).then((function(t){n._sdk.log(o.LogLevel.Debug,(function(){return"Got response "+JSON.stringify(t)}));try{var r=JSON.parse(t.getBodyJson())}catch(e){throw o.impl.AuthenticationErrorImpl.errorForTransportResponse(t)}var i=r.data&&r.data.state==e.Protocol.AuthSessionState.Rejected;if(200==t.getStatus()&&!r.error_code||401==t.getStatus()&&i)return r;throw 200==t.getStatus()||r.error_code?o.impl.AuthenticationErrorImpl.errorForServerResponse(r):o.impl.AuthenticationErrorImpl.errorForTransportResponse(t)}))}))}))},t.prototype.createTransportRequestForPublicExchangeRequest=function(t){var e=this;return new Promise((function(n,r){var i={headers:t.envelopeHeaders,data:t.body},s=new o.TransportRequest;s.setMethod(t.method);var a=e._sdk.connectionSettings.getRealm()||"",u=a.length?"/"+a:"";s.setUrl(""+e._sdk.connectionSettings.getServerAddress()+u+"/api/v2/"+t.serverRelativeUrl),s.setBodyJson(JSON.stringify(i)),n(s)}))},t.prototype.prepareTransportRequest=function(t){var e={aid:this._sdk.connectionSettings.getAppId()};t.setUrl(this.urlWithConcatenatedQuery(t.getUrl(),e));var n=t.getHeaders()||[];return t.setHeaders(n),Promise.resolve(t)},t.prototype.urlWithConcatenatedQuery=function(t,e){var n="";return t.indexOf("?")<0?n="?":"&"!=t[t.length-1]&&(n="&"),t+n+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")},t}(),e.PublicNetworkRequest=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getUrl=function(){return this._url},t.prototype.setUrl=function(t){this._url=t},t.prototype.getMethod=function(){return this._method},t.prototype.setMethod=function(t){this._method=t},t.prototype.getHeaders=function(){return this._headers},t.prototype.setHeaders=function(t){this._headers=t},t.prototype.getBodyJson=function(){return this._bodyJson},t.prototype.setBodyJson=function(t){this._bodyJson=t},t.__tarsusInterfaceName="TransportRequest",t}();t.TransportRequest=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(n){var o=function(o){function s(t,e){var n=o.call(this,t,e)||this;n._lockCount=0,n._invalidated=!1,n._persistUserData=t.currentPersistUserData;var r=e&&(e.deviceBound||e.hasLoggedIn);return n._deviceId=r&&e.deviceId||null,n}return V(s,o),Object.defineProperty(s.prototype,"anonymous",{get:function(){return this._anonymous},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"invalidated",{get:function(){return this._invalidated},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"persistUserData",{get:function(){return this._persistUserData},enumerable:!1,configurable:!0}),s.createAnonymousSession=function(t){var e=new s(t,n.User.createEphemeralUser(t));return e._anonymous=!0,e},s.prototype.createLogoutRequest=function(){return new n.SessionExchangeRequest("POST","auth/logout",{},[],this.getFlowId())},s.prototype.createApprovalsFetchRequest=function(t){var e={collection_result:t.toJson()};return new n.SessionExchangeRequest("POST","approvals/actions/fetch",e,[],this.getFlowId())},s.prototype.createApprovalReplyRequest=function(t,o,r){var i={collection_result:t.toJson(),status:r==e.MobileApprovalStatus.Approved?n.Protocol.ServerResponseDataApprovalsApprovalStatus.Approved:n.Protocol.ServerResponseDataApprovalsApprovalStatus.Denied};return new n.SessionExchangeRequest("POST","auth/approve?apid="+o,i,[],this.getFlowId())},s.prototype.createDevicesFetchRequest=function(t,e){var o={collection_result:t.toJson()};return e&&(o.token=e),new n.SessionExchangeRequest("POST","authenticate/physical/devices",o,[],this.getFlowId())},s.prototype.createDeviceActionRequest=function(t,e,o,r,i){var s={collection_result:t.toJson(),device_id:o};return e&&(s.token=e),i&&Object.keys(i).forEach((function(t){s[t]=i[t]})),new n.SessionExchangeRequest("POST","authenticate/physical/device/action?action="+r,s,[],this.getFlowId())},s.prototype.createConfigMenuFetchRequest=function(t,e){var o={collection_result:t.toJson()};return e&&(o.token=e),new n.SessionExchangeRequest("POST","auth/authenticator/config_menu",o,[],this.getFlowId())},s.prototype.createAuthRegistrationRequest=function(t,e,o,r){var i={collection_result:t.toJson(),type:e};r&&(i.token=r);var s=o?"register":"unregister";return new n.SessionExchangeRequest("POST","auth/authenticator/"+s,i,[],this.getFlowId())},s.prototype.startControlFlow=function(t,e,o){var r=new n.ControlFlowProcessor(this.sdk,this,o,e);return this.runWithSessionControlFlow(r,(function(e){return e.startControlFlow(t)}))},s.prototype.continueControlFlow=function(t,e,o,r){var i=new n.ControlFlowProcessorRuntimeContext;i.cflowRequestContext=o,i.clientContext=r,i.sdk=this.sdk,i.session=this,i.uiHandler=this.sdk.currentUiHandler;var s=t.createResumableProcess(i);return this.runWithSessionControlFlow(s,(function(n){return n.resume(t,e)}))},s.prototype.createCurrentControlFlowContinuation=function(){if(!this._currentControlFlow)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to create continuation for a session without an active control flow");return this._currentControlFlow.createContinuation()},s.prototype.runWithSessionControlFlow=function(t,o){var r=this;return new Promise((function(i,s){if(r._currentControlFlow)throw r.sdk.log(e.LogLevel.Error,(function(){return"Attempt to start a control flow while an existing control flow ("+r._currentControlFlow.challenge+") is running."})),new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to start a control flow while an existing control flow ("+r._currentControlFlow.challenge+") is running.");r._currentControlFlow=t,r.sdk.log(e.LogLevel.Debug,(function(){return"Start control flow"})),n.authenticationdrivers.SimpleAuthenticationDriverDescriptor.refreshInvalidatedAuthenticatorsEnrollments(r).catch((function(t){r.sdk.log(e.LogLevel.Warning,(function(){return"Could not refresh invalidated authenticators enrollments: "+t}))})).then((function(){return o(t)})).finally((function(){r.sdk.log(e.LogLevel.Debug,(function(){return"Done control flow "+t.challenge})),r._currentControlFlow=null})).then(i,s)}))},s.prototype.getCurrentUserInteractionSessionProvider=function(){return this._currentControlFlow},s.prototype.generateInvalidatedAuthenticatorsHeadersIfNeeded=function(){for(var t,o=new Array,r=0,i=n.LocalEnrollment.listInvalidatedLocalEnrollments(this);r<i.length;r++)if(t=i[r],this._sdk.log(e.LogLevel.Debug,(function(){return"Found invalidated authenticator: "+t.authenticatorId})),t.publicKeyHash){var s={type:"public_key_hash",hash:t.publicKeyHash},a={type:"registration_invalidated",method:t.authenticatorId,registration_id:s};o.push(a)}return o},Object.defineProperty(s.prototype,"deviceSigningKeyPair",{get:function(){if(!this._deviceKeyPair&&!this._anonymous&&this._sdk.deviceSupportsCryptoBinding()&&(this._deviceKeyPair=this._sdk.host.getKeyPair(this._user.deviceSigningKeyTag,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.None),this.user.deviceBound&&!this._deviceKeyPair))throw this._sdk.log(e.LogLevel.Error,(function(){return"Could not load device signing key pair for this device."})),new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.InvalidDeviceBinding,"Invalid device signature - could not load device signing key pair.");return this._deviceKeyPair},enumerable:!1,configurable:!0}),s.prototype.performSessionExchange=function(t){return this.performSessionExchangeInternal(t,!0,!0,!0).catch((function(t){throw e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t)}))},s.prototype.performSessionExchangeInternal=function(o,r,i,s){var a=this;if(this._invalidated)return this._sdk.log(e.LogLevel.Error,(function(){return"Attempt to execute a session exchange from invalidated session."})),Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.SessionRequired,"Session was invalidated by server."));if(this.connectionSettings().getCryptoMode()==e.ConnectionCryptoMode.Full&&!this._currentCryptoSession&&s){var u=new n.SessionExchangeRequest("POST","auth/key_exchange",{r:"Hello Encrypted World"},[],this.getFlowId());return this.performSessionExchangeInternal(u,r,i).then((function(t){return a.performSessionExchangeInternal(o,r)}))}return this._sdk.log(e.LogLevel.Debug,(function(){return"Preprocess request "+JSON.stringify(o)})),this.preprocessSessionExchangeRequest(o).then((function(s){return a.promisePossiblyEncryptedTransportRequest(s).then((function(s){return a.preprocessTransportRequest(s).then((function(s){return a._sdk.log(e.LogLevel.Debug,(function(){return"Will send request "+JSON.stringify(s)})),a._sdk.transportProvider.sendRequest(s).then((function(s){a._sdk.log(e.LogLevel.Debug,(function(){return"Got response "+JSON.stringify(s)}));try{var u=JSON.parse(s.getBodyJson())}catch(t){throw e.impl.AuthenticationErrorImpl.errorForTransportResponse(s)}a.postprocessResponse(u);var c=(u=a.possiblyDecryptResponse(u)).data&&u.data.state==n.Protocol.AuthSessionState.Rejected;if(200==s.getStatus()&&!u.error_code||401==s.getStatus()&&c)return u;if(200==s.getStatus()||u.error_code){if(u.error_code==n.Protocol.ServerResponseErrorCode.EncryptionStateError&&i)return a._currentCryptoSession=null,a.performSessionExchangeInternal(o,r,!1,!0);if(u.error_code==n.Protocol.ServerResponseErrorCode.DeviceKeyExpired){if(a._sdk.log(e.LogLevel.Debug,(function(){return"DeviceKeyRoll: device key expired rejection received"})),r){var l=a._sdk.host.generateRandomHexString(24);return a._sdk.host.generateKeyPair(a._user.getPendingDeviceSigningKeyTag(l),t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.None,!0).then((function(t){var n=void 0;return a.verifyDevicePublicKey(u.data.key_id)||(a._sdk.log(e.LogLevel.Warning,(function(){return"DeviceKeyRoll: server response device public key hash doesn't match."})),n="Device public key hash and server response public key hash do not match."),a._deviceKeyRollData={deviceKeyPair:t,salt:l,message:n},a.performSessionExchangeInternal(o,!1,!0,!0)}))}if(a._sdk.log(e.LogLevel.Warning,(function(){return"DeviceKeyRoll: already attempted to roll device key and failed. Aborting second attempt."})),a._deviceKeyRollData)try{a._sdk.host.deleteKeyPair(a._user.getPendingDeviceSigningKeyTag(a._deviceKeyRollData.salt))}catch(t){a._sdk.log(e.LogLevel.Warning,(function(){return"DeviceKeyRoll: Can't delete pending device signing key."}))}}else u.error_code==n.Protocol.ServerResponseErrorCode.UserIdTokenExpired&&n.User.resetUserIdTokenForSession(a);throw e.impl.AuthenticationErrorImpl.errorForServerResponse(u)}throw e.impl.AuthenticationErrorImpl.errorForTransportResponse(s)}))}))}))}))},s.prototype.processInlineResponse=function(t){return this.postprocessResponse(t),Promise.resolve(t)},s.prototype.cancelCurrentControlFlow=function(){this._currentControlFlow?this._currentControlFlow.cancelFlow():this._sdk.log(e.LogLevel.Error,(function(){return"No current control flow."}))},s.prototype.deviceId=function(){return this._deviceId},s.prototype.preprocessTransportRequest=function(t){var n=this,o={aid:this.connectionSettings().getAppId()};this._deviceId&&(o.did=this._deviceId),this._sessionId&&(o.sid=this._sessionId),this._sdk.uiAssetsData&&this._sdk.uiAssetsData.locale&&(o.locale=this._sdk.uiAssetsData.locale),t.setUrl(this.urlWithConcatenatedQuery(t.getUrl(),o));var r=t.getHeaders()||[],i=new e.TransportHeader;i.setName("X-TS-Client-Version"),i.setValue(this.clientVersionHeader),r.push(i);var s=new e.TransportHeader;s.setName("Authorization"),s.setValue("TSToken "+this.connectionSettings().getToken()+"; tid="+this.connectionSettings().getTokenName()),r.push(s);try{if(this._deviceId&&this.deviceSigningKeyPair)return this.generateSignatureForRequest(t).then((function(o){var i=e.util.calcPublicKeyHexStringEncodedSha256Hash(n.deviceSigningKeyPair,n._sdk),s=new e.TransportHeader;return s.setName("Content-Signature"),s.setValue("data:"+o+";key-id:"+i+";scheme:4"),r.push(s),t.setHeaders(r),t}))}catch(t){return Promise.reject(t)}return t.setHeaders(r),Promise.resolve(t)},s.prototype.postprocessResponse=function(t){var e=this;t.headers&&t.headers.forEach((function(t){s.headerProcessors[t.type].call(e,t)}))},s.prototype.encryptEnvelopedMessageIfNeeded=function(t){var e=this.generateKeyExchangeHeaderIfNeeded();this._currentCryptoSession&&this._currentCryptoSession.isReady()&&this._currentCryptoSession.encryptRequest(t),e&&t.headers.push(e)},s.prototype.promisePossiblyEncryptedTransportRequest=function(t){var o=this;return new Promise((function(r,i){var s,a={headers:t.envelopeHeaders,data:t.body};o.encryptEnvelopedMessageIfNeeded(a);var u=new e.TransportRequest;u.setHeaders([]),u.setMethod(t.method);var c=o._sdk.connectionSettings.getRealm()||"",l=c.length?"/"+c:"";u.setUrl(""+o._sdk.connectionSettings.getServerAddress()+l+"/api/v2/"+t.serverRelativeUrl),u.setBodyJson(JSON.stringify(a));var p=null===(s=t.envelopeHeaders.filter((function(t){return t.type===n.Protocol.flowIdHeaderName})))||void 0===s?void 0:s[0];if(o.connectionSettings().shouldSendFlowIdAsHttpHeader()&&p){var h=new e.TransportHeader;h.setName(p.type),h.setValue(p[n.Protocol.flowIdHeaderName]),u.getHeaders().push(h)}r(u)}))},s.prototype.possiblyDecryptResponse=function(t){return this._currentCryptoSession&&this._currentCryptoSession.isReady()&&(t=this._currentCryptoSession.decryptResponse(t)),t},s.prototype.generateKeyExchangeHeaderIfNeeded=function(){return this.connectionSettings().getCryptoMode()==e.ConnectionCryptoMode.None||this._currentCryptoSession?null:(this._currentCryptoSession=new n.Scheme2CryptoSession(this._sdk),this._currentCryptoSession.getExchangeRequestHeader())},s.prototype.preprocessSessionExchangeRequest=function(t){var n=this;return new Promise((function(o,r){var a=n.generateUserIDHeaderIfNeeded();a&&t.addEnvelopeHeader(a);var u=n.generateInvalidatedAuthenticatorsHeadersIfNeeded();if(u)for(var c=0,l=u;c<l.length;c++){var p=l[c];t.addEnvelopeHeader(p)}var h=n.generateDeviceKeyRollHeaderIfNeeded();h&&t.addEnvelopeHeader(h);var d=Promise.resolve(!0),f=new i(t);s.messageFilteringExtensionPoint.forEach((function(t){d=d.then((function(o){return t.filterMessage(n.createPluginSessionInfo(),f).catch((function(t){return n.sdk.log(e.LogLevel.Warning,(function(){return"Error during message filtering: "+t})),!0}))}))})),d.then((function(e){return o(t)}),r)}))},s.prototype.getFlowId=function(){var t,e;return null===(e=null===(t=this._currentControlFlow)||void 0===t?void 0:t.requestContext)||void 0===e?void 0:e.getFlowId()},s.prototype.generateDeviceKeyRollHeaderIfNeeded=function(){if(!this._deviceKeyRollData)return null;var t={type:"device_key_roll"};return t.device_key_roll=this._deviceKeyRollData.deviceKeyPair.publicKeyToJson(),this._deviceKeyRollData.message&&(t.message=this._deviceKeyRollData.message),t},s.prototype.generateUserIDHeaderIfNeeded=function(){if(this.connectionSettings().getCryptoMode()==e.ConnectionCryptoMode.Full&&!this._currentCryptoSession)return null;if(this._anonymous){if(this._user.ephemeralUserId)return{type:"uid",uid:this._user.ephemeralUserId}}else{if(this._user.userId)return{type:"uid",uid:this._user.userId};if(this._user.idToken)return{type:"uid_token",token:this._user.idToken}}return null},s.prototype.processKeyExchangeResponseHeader=function(t){this._currentCryptoSession&&this._currentCryptoSession.processExchangeResponseHeader(t)},s.prototype.generateSignatureForRequest=function(t){var n=t.getUrl(),o=n.indexOf("?");if(o>0){var r=t.getUrl().substring(o+1);n=t.getUrl().substring(0,o)+"?"+r.split("&").sort().join("&")}var i=/%%/g,s=n.substr(this.connectionSettings().getServerAddress().length).replace(i,"\\%")+"%%"+this.clientVersionHeader.replace(i,"\\%")+"%%"+t.getBodyJson().replace(i,"\\%"),a=e.util.asciiToHex(s);return this.deviceSigningKeyPair.signHex(a).then((function(t){return e.util.hexToBase64(t)}))},s.prototype.connectionSettings=function(){return this._sdk.connectionSettings},s.prototype.processSessionIdHeader=function(t){this._sdk.log(e.LogLevel.Debug,(function(){return"Processing session ID header "+t})),this._sessionId=t.session_id},s.prototype.processDeviceIdHeader=function(t){var n=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Processing Device ID header "+t})),this._deviceId?this._deviceId!=t.device_id&&this._sdk.log(e.LogLevel.Warning,(function(){return"Received device ID "+t.device_id+" in a session with an existing device id "+n._deviceId})):(this._user.setProvisionalDeviceId(t.device_id),this._deviceId=t.device_id)},s.prototype.processSessionStateChangeHeader=function(t){switch(this._sdk.log(e.LogLevel.Debug,(function(){return"Processing session state change header "+t+" to state "+t.state})),t.state){case n.Protocol.SessionStateChangeState.Closed:this._sdk.log(e.LogLevel.Debug,(function(){return"Invalidating session."})),this._invalidated=!0;break;default:throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Communication,"Invalid session state change encountered in header.")}},s.prototype.processSessionEphemeralUserHeader=function(t){this._sdk.log(e.LogLevel.Debug,(function(){return"Processing ephemeral user Id header "+t})),this._user.updateEphemeralUserId(t.uid)},s.prototype.noHeaderProcessing=function(t){},s.prototype.processEncryptedSharedSecretHeader=function(t){},s.prototype.processDisplayNameHeader=function(t){this._sdk.log(e.LogLevel.Debug,(function(){return"Processing display name header '"+t.display_name+"'"})),n.User.updateUserDisplayName(t.display_name,this._user,this._sdk)},s.prototype.processUidTokenHeader=function(t){this._sdk.log(e.LogLevel.Debug,(function(){return"Processing uid_token header '"+t.token+"', uid hash '"+t.uid_hash+"'"})),n.User.updateUserIdTokenForSession(t.token,this,t.uid_hash)},s.prototype.processDeviceKeyRollSuccess=function(t){if(this._sdk.log(e.LogLevel.Debug,(function(){return"DeviceKeyRoll: Processing device_key_roll_success header. device_key_roll_success = '"+t.device_key_roll_success+"'."})),t.device_key_roll_success&&this._deviceKeyRollData){var n=this._user.deviceSigningKeyTag;this._user.updateDeviceKeyTagSaltAndSave(this._deviceKeyRollData.salt),this._deviceKeyPair=this._deviceKeyRollData.deviceKeyPair,this._deviceKeyRollData=null;try{this._sdk.host.deleteKeyPair(n)}catch(t){this._sdk.log(e.LogLevel.Warning,(function(){return"DeviceKeyRoll: Can't delete old device signing key."}))}}},s.prototype.verifyDevicePublicKey=function(t){var n=e.util.calcPublicKeyHexStringEncodedSha256Hash(this.deviceSigningKeyPair,this._sdk);return this._sdk.log(e.LogLevel.Debug,(function(){return"DeviceKeyRoll: verify server key hash matches device key hash: "+(n===t)})),n===t},s.prototype.urlWithConcatenatedQuery=function(t,e){var n="";return t.indexOf("?")<0?n="?":"&"!=t[t.length-1]&&(n="&"),t+n+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")},Object.defineProperty(s.prototype,"clientVersionHeader",{get:function(){if(!this._cachedClientVersionHeader){var t=this._sdk.getClientFeatureSet().join(",");this._cachedClientVersionHeader=this._sdk.getVersionInfo().getSdkVersion()+";["+t+"]"}return this._cachedClientVersionHeader},enumerable:!1,configurable:!0}),s.prototype.createPluginSessionInfo=function(){return new r(this)},s.prototype.lock=function(){var t=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Locking session "+t._sessionId})),this._lockCount++},s.prototype.unlock=function(){var t=this;if(this._sdk.log(e.LogLevel.Debug,(function(){return"Unlocking session "+t._sessionId})),this._lockCount--,this._lockCount<0)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Unbalanced session locking: Attempt to unlock an already unlocked sessoin.")},s.prototype.canTerminate=function(){return!this._lockCount},s.prototype.toJson=function(){var t={session_id:this._sessionId,user_guid:this._user.guid.toString(),device_id:this._deviceId,invalidated:this._invalidated,persistUserData:this._persistUserData,anonymous:this._anonymous};return this._persistUserData||(t.nonPersistentUser=n.User.toUserRecord(this._user)),this._currentCryptoSession&&this._currentCryptoSession.isReady()&&(t.c_session=this._currentCryptoSession.toJson()),t},s.fromJson=function(t,o){var r=o,i=r.persistUserData?n.User.findUserByGuid(t,n.UserGuid.createFromString(r.user_guid)):r.nonPersistentUser&&n.User.fromUserRecord(r.nonPersistentUser,t);if(!i)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Can't deserialize session -- user "+r.user_guid+" not found.");return this.fromJsonWithUser(t,o,i)},s.fromJsonWithUser=function(t,e,o){var r=e,i=new s(t,o);return i._sessionId=r.session_id,i._deviceId=r.device_id,i._invalidated=r.invalidated||!1,i._persistUserData=r.persistUserData||!0,i._anonymous=r.anonymous||!1,r.c_session&&(i._currentCryptoSession=n.Scheme2CryptoSession.fromJson(t,r.c_session)),i},s.prototype.updateFromContinuedSession=function(t){this.user.updateFromContinuedSessionUser(t.user)},s.notifySessionObserversOnMainSessionLogin=function(t){var e=t.createPluginSessionInfo();this.sessionObservationExtensionPoint.forEach((function(t){t.mainSessionStarted(e)}))},s.notifySessionObserversOnMainSessionLogout=function(t){var e=t.createPluginSessionInfo();this.sessionObservationExtensionPoint.forEach((function(t){t.mainSessionEnded(e)}))},s.headerProcessors={session_id:s.prototype.processSessionIdHeader,device_id:s.prototype.processDeviceIdHeader,encrypted_shared_secret:s.prototype.processEncryptedSharedSecretHeader,session_state:s.prototype.processSessionStateChangeHeader,ephemeral_uid:s.prototype.processSessionEphemeralUserHeader,key_exchange:s.prototype.processKeyExchangeResponseHeader,encryption:s.prototype.noHeaderProcessing,display_name:s.prototype.processDisplayNameHeader,uid_token:s.prototype.processUidTokenHeader,device_key_roll_success:s.prototype.processDeviceKeyRollSuccess},s.messageFilteringExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_MESSAGE_FILTERS),s.sessionObservationExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_SESSION_OBSERVERS),s}(n.BaseSession);n.Session=o;var r=function(){function t(t){this._underlying=t}return t.prototype.getUsername=function(){return this._underlying.user.displayName},t}(),i=function(){function t(t){this._underlying=t}return t.prototype.getMethod=function(){return this._underlying.method},t.prototype.getBody=function(){return this._underlying.body},t.prototype.getHeaders=function(){return this._underlying.envelopeHeaders},t.prototype.addHeader=function(t){this._underlying.addEnvelopeHeader(t)},t}()})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(){function n(n,o,r,i,s){if(this.flowId=s,n instanceof e.SerializationContext)this.serializeFrom(n);else{if("string"!=typeof n||!o||!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid arguments for constructing session message");this._requestMethod=n,this._requestServerRelativeUrl=o,this._requestBody=r,this._envelopeHeaders=i||[]}var a=this.createFlowIdSdkHeader();a&&this._envelopeHeaders.push(a)}return n.prototype.addEnvelopeHeader=function(t){this._envelopeHeaders.push(t)},Object.defineProperty(n.prototype,"method",{get:function(){return this._requestMethod},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"serverRelativeUrl",{get:function(){return this._requestServerRelativeUrl},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this._requestBody},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"envelopeHeaders",{get:function(){return this._envelopeHeaders},enumerable:!1,configurable:!0}),n.prototype.serializeTo=function(t){t.writePrimitive("envelopeHeaders",this._envelopeHeaders),t.writePrimitive("requestBody",this._requestBody),t.writePrimitive("requestMethod",this._requestMethod),t.writePrimitive("requestServerRelativeUrl",this._requestServerRelativeUrl)},n.prototype.serializeFrom=function(t){this._envelopeHeaders=t.readPrimitive("envelopeHeaders"),this._requestBody=t.readPrimitive("requestBody"),this._requestMethod=t.readPrimitive("requestMethod"),this._requestServerRelativeUrl=t.readPrimitive("requestServerRelativeUrl")},n.prototype.getFlowId=function(){return this.flowId},n.prototype.createFlowIdSdkHeader=function(){var t;return this.flowId?((t={type:e.Protocol.flowIdHeaderName})[e.Protocol.flowIdHeaderName]=this.flowId,t):null},n=z([e.Serializable("ExchangeRequest"),J("design:paramtypes",[Object,String,Object,Array,String])],n)}();e.BaseExchangeRequest=n;var o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n=z([e.Serializable("SessionExchangeReqeust")],n)}(n);e.SessionExchangeRequest=o;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e}(n);e.PublicExchangeRequest=r}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(n){var o=function(){function t(t,e){this._sdk=t,this._hostedPluginName=e.getPluginInfo().getPluginName()}return t.prototype.extend=function(t,e){n.ExtensionPoint.byName(t).extend(e)},t.prototype.getSdk=function(){return this._sdk},t.prototype.generateRandomHexString=function(t){return this._sdk.host.generateRandomHexString(t)},t.prototype.suspendControlFlowToDefaultSuspensionContext=function(t){this._sdk.suspendControlFlowToDefaultSuspensionContext(t)},t.prototype.log=function(t,e){this._sdk.host.log(t,"TransmitSDK/Tarsus/Plugin/"+this._hostedPluginName,e)},t}();n.TarsusPluginHostImpl=o;var r=function(){function n(t){this._installedPluginsAndConfigs={},this._initializedPlugins=[],this._sdk=t}return n.prototype.getInitializedPlugins=function(){return this._initializedPlugins.concat([])},n.prototype.installPlugin=function(t,n){if(this._installedPluginsAndConfigs[t])throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to install plugin "+t+" twice.");this._installedPluginsAndConfigs[t]=n},n.prototype.initializePlugins=function(){var n=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Starting plugin initialization..."}));var r=Object.keys(this._installedPluginsAndConfigs).map((function(r){return n._sdk.log(e.LogLevel.Debug,(function(){return"Loading plugin "+r+"..."})),n._sdk.host.loadPlugin(r).then((function(i){var s=i.getPluginInfo(),a=t.tarsusplugin.impl.PluginInfoImpl.toString(s);if(i.getPluginInfo().getPluginName()!=r)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Plugin "+r+": getPluginInfo() reported mismatched name -- "+a+".");n._sdk.log(e.LogLevel.Info,(function(){return"Initializing plugin "+a+"..."}));var u=new o(n._sdk,i);return i.initialize(u,n._installedPluginsAndConfigs[r]).then((function(){n._initializedPlugins.push(i)})).catch((function(t){n._sdk.log(e.LogLevel.Error,(function(){return"Couldn't initialize plugin "+a+": "+t}))}))}))}));return Promise.all(r).then((function(){n._sdk.log(e.LogLevel.Debug,(function(){return"Plugin initialization completed sucessfuly"}))}))},n}();n.TarsusPluginManager=r})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o;o=t.sdk||(t.sdk={}),e=o.core||(o.core={}),n=function(){function t(t,n){this._locale=n,this._sdk=t,this._serverClientStrings=new e.ClientStrings({}),this._cachedClientStrings=new e.ClientStrings({})}return Object.defineProperty(t.prototype,"locale",{get:function(){return this._locale},enumerable:!1,configurable:!0}),t.prototype.isServerClientStringsEmpty=function(){var t=this._serverClientStrings.strings;return null==t||0===Object.keys(t).length&&t.constructor===Object},t.prototype.setServerClientStrings=function(t){this._serverClientStrings=t,this._cachedClientStrings=new e.ClientStrings({})},t.prototype.applyGlobalStyleSheetJson=function(t){this._styleSheetJson||(this._styleSheetJson=JSON.parse(this._sdk.host.getUIStyles())),this._styleSheetJson=e.UIStyleSheets.merge(this._styleSheetJson,t),this._cachedBaseStylesheet=null},Object.defineProperty(t.prototype,"uiStylesheets",{get:function(){return this.getUiStylesheetsWithOverrides()},enumerable:!1,configurable:!0}),t.prototype.getUiStylesheetsWithOverrides=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._styleSheetJson||(this._styleSheetJson=JSON.parse(this._sdk.host.getUIStyles())),t.length?new(e.UIStyleSheets.bind.apply(e.UIStyleSheets,Q([void 0,this._styleSheetJson],t))):(this._cachedBaseStylesheet||(this._cachedBaseStylesheet=new e.UIStyleSheets(this._styleSheetJson)),this._cachedBaseStylesheet)},t.prototype.getString=function(t){var e=null;return(e=this._cachedClientStrings.getString(t))?e:(this._serverClientStrings&&(e=this._serverClientStrings.getString(t)),null==e&&(e=this._sdk.host.getString(t,this._locale)),e&&this.storeInLocalCache(t,e),e)},t.prototype.storeInLocalCache=function(t,e){e&&this._cachedClientStrings&&(this._cachedClientStrings.strings[t]=e)},t}(),e.UIAssetsData=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(t){var n=function(){function t(){}return t.prototype.toString=function(){return this._guidStr},t.prototype.equalString=function(t){return this._guidStr==t},t.prototype.equalsUserGuid=function(t){return this.toString()==t.toString()},t.createWithLength=function(e,n){var o=new t;return o._guidStr=n.host.generateRandomHexString(e),o},t.createFromString=function(e){var n=new t;return n._guidStr=e,n},t}();t.UserGuid=n;var o=function(){function o(){}return Object.defineProperty(o.prototype,"guid",{get:function(){return this._guid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"displayName",{get:function(){return(this._ephemeral?"anonymous":this._displayName)||this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"idToken",{get:function(){return this._idToken},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"uidHash",{get:function(){return this._uidHash},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"deviceId",{get:function(){return this._deviceId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"phoneNumber",{get:function(){return this._phoneNumber},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"defaultAuthId",{get:function(){return this._defaultAuthId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"deviceBound",{get:function(){return this._deviceBound},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasLoggedIn",{get:function(){return this._hasLoggedIn},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"deviceEncryptionKeyTag",{get:function(){return new t.TarsusKeyPath("per_user",this._guid.toString(),"enc_enabled")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ephemeralUserId",{get:function(){return this._ephemeralUserId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userHandle",{get:function(){return this._userId||this._idToken},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userHandleType",{get:function(){return this._userId?e.UserHandleType.UserId:e.UserHandleType.IdToken},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"deviceSigningKeyTag",{get:function(){return this._deviceSigningKeyTagSalt?new t.TarsusKeyPath("per_user",this._guid.toString(),"device_key",this._deviceSigningKeyTagSalt):new t.TarsusKeyPath("per_user",this._guid.toString(),"device_key")},enumerable:!1,configurable:!0}),o.prototype.getPendingDeviceSigningKeyTag=function(e){return new t.TarsusKeyPath("per_user",this._guid.toString(),"device_key",e)},o.prototype.updateDeviceKeyTagSaltAndSave=function(t){this._deviceSigningKeyTagSalt=t,o.save(this._sdk,this)},Object.defineProperty(o.prototype,"localEnrollments",{get:function(){return this._localEnrollments||(this._localEnrollments=t.LocalEnrollment.enrollmentsForUser(this,this._sdk)),this._localEnrollments},enumerable:!1,configurable:!0}),o.prototype.updateDefaultAuthId=function(t){this._defaultAuthId=t},o.prototype.updateEphemeralUserId=function(t){if(!this._ephemeral)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid ephemeral user name update reaquest header, user is not ephemeral.");if(this._ephemeralUserId)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to set an ephemeral userId after it has already been updated once.");this._ephemeralUserId=t},o.updateUserDisplayName=function(t,e,n){e._displayName=t,n.currentSession&&n.currentSession.persistUserData&&o.save(n,e)},o.updateUserIdTokenForSession=function(t,e,n){var r=e.user;r._idToken=t,r._uidHash=n,delete r._userId,e.persistUserData&&o.save(e.sdk,r)},o.resetUserIdTokenForSession=function(t){var e=t.user;delete e._idToken,t.persistUserData&&o.save(t.sdk,e)},o.prototype.updateFromContinuedSessionUser=function(t){if(!this._guid.equalsUserGuid(t.guid))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"GUID mismatch when updating user from continuation");this._defaultAuthId=t._defaultAuthId,this._deviceBound=t._deviceBound,this._hasLoggedIn=t._hasLoggedIn,this._deviceId=t._deviceId,this._phoneNumber=t._phoneNumber,this._userId=t._userId,this._idToken=t._idToken,this._displayName=t._displayName,this._uidHash=t._uidHash},o.prototype.setProvisionalDeviceId=function(t){if(this.deviceBound)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to record a provisional device ID for an already bound user record.",{});this._deviceId=t},o.prototype.bindDeviceToUser=function(t){if(this.deviceBound)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to record a device for an already bound user record.",{});if(this._deviceId!=t)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to bind user to a device ID different than provisional device ID.",{});this._deviceBound=!0},o.prototype.markLoggedIn=function(){this._hasLoggedIn=!0},o.iterateUsers=function(t,e){for(var n=t.host.readStorageKey(o.storageKey),r=t.currentSession&&t.currentSession.user,i=0;i<n.length;i++){var s=o.fromUserRecord(n[i],t),a=e(s);if(null!=a)return a;r&&r.guid.equalsUserGuid(s.guid)&&(r=null)}return r?e(r):null},o.findUserByUidToken=function(t,n){return o.iterateUsers(t,(function(o){return o.idToken&&o.idToken===n?(t.log(e.LogLevel.Debug,(function(){return"Located user based on id token, guid: '"+o.guid+"'"})),o):null}))},o.calculateUidHash=function(t,n){var o=n.toLowerCase(),r=e.util.hexToBase64(t.host.calcHexStringEncodedSha256Hash(e.util.asciiToHex(o)));return t.log(e.LogLevel.Debug,(function(){return"Calculated uid hash, input: '"+o+", hash: '"+r+"'"})),r},o.findUserByUidHash=function(t,n){var r=this;return t.log(e.LogLevel.Debug,(function(){return"Looking up user based on user id hash, hash: '"+n+"'"})),o.iterateUsers(t,(function(o){return n==o._uidHash?(t.log(e.LogLevel.Debug,(function(){return"Located user based on uid hash, guid: '"+o.guid+"'"})),o):o.userId&&r.calculateUidHash(t,o.userId)==n?(t.log(e.LogLevel.Debug,(function(){return"Located user with user id based on uid hash, guid: '"+o.guid+"'"})),o):null}))},o.findUserByUserId=function(t,n){var r=this.calculateUidHash(t,n);return t.log(e.LogLevel.Debug,(function(){return"Looking up user based on user id, userId: '"+n+"'"})),o.iterateUsers(t,(function(o){return o.userId&&o.userId.toLowerCase()===n.toLowerCase()?(t.log(e.LogLevel.Debug,(function(){return"Located user based on user id, guid: '"+o.guid+"'"})),o):o.userId||r!=o._uidHash?null:(t.log(e.LogLevel.Debug,(function(){return"Located user based on uid hash, guid: '"+o.guid+"'"})),o.idToken||(o._userId=n),o)}))},o.findUserByGuid=function(t,n){return o.iterateUsers(t,(function(o){return o.guid.equalsUserGuid(n)?(t.log(e.LogLevel.Debug,(function(){return"Located user based on guid, guid: '"+o.guid+"'"})),o):null}))},o.findUser=function(t,e){return 0==e.indexOf("uidt:")?this.findUserByUidToken(t,e):this.findUserByUserId(t,e)},o.findUserWithType=function(t,n,o){if(o){if(o===e.UserHandleType.IdToken)return this.findUserByUidToken(t,n);if(o===e.UserHandleType.UserId)return this.findUserByUserId(t,n);throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Unsupported user handle type",{user_handle_type:o})}return this.findUser(t,n)},o.createUserWithUserId=function(t,n){if(!n)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"userHandle must not be empty");var o=this.createBaseUser(t);return o._userId=n,o._uidHash=e.util.hexToBase64(t.host.calcHexStringEncodedSha256Hash(e.util.asciiToHex(n))),o},o.createUserWithIdToken=function(t,n,o){if(!n)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"userHandle must not be empty");var r=this.createBaseUser(t);return r._idToken=n,r._uidHash=o,r},o.createBaseUser=function(t){var e=new o;return e._guid=n.createWithLength(32,t),e._deviceBound=!1,e._hasLoggedIn=!1,e._phoneNumber="",e._sdk=t,e._ephemeral=!1,e._deviceSigningKeyTagSalt=t.host.generateRandomHexString(24),e},o.createEphemeralUser=function(t){var e=new o;return e._guid=n.createWithLength(32,t),e._deviceBound=!1,e._hasLoggedIn=!1,e._phoneNumber="",e._sdk=t,e._ephemeral=!0,e._ephemeralUserId=null,e},o.deleteUser=function(t,n){var r=n.host.readStorageKey(o.storageKey);n.log(e.LogLevel.Warning,(function(){return"=== CURRENTL LEN    "+r.length}));for(var i=0;i<r.length;i++){var s=o.fromUserRecord(r[i],n);if(t.guid.equalsUserGuid(s.guid))break}if(i<r.length){for(;i<r.length-1;)r[i]=r[i+1],i++;var a=r.length-1;delete r[r.length-1],r.length=a,n.host.writeStorageKey(o.storageKey,r)}else n.log(e.LogLevel.Warning,(function(){return"Attempt to delete nonexisting user "+t.userHandle}))},o.prototype.createEnrollmentRecord=function(e,n,o,r,i){var s=t.LocalEnrollment.createNew(e,n,o,this._sdk,i);return s.status=r,s},o.prototype.updateEnrollmentRecord=function(n){if(this._ephemeral)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to update enrollment record for ephemeral user.",{});var o={};for(var r in this.localEnrollments)o[r]=this.localEnrollments[r];o[n.authenticatorId]=n,t.LocalEnrollment.updateEnrollmentsForUser(this,o,this._sdk),this._localEnrollments=o},o.toUserRecord=function(t){var e={default_auth_id:t._defaultAuthId,device_bound:t._deviceBound,has_logged_in:t._hasLoggedIn,device_id:t._deviceId,last_auth:"<null>",guid:t._guid.toString(),user_id:t.userId,display_name:t._displayName,id_token:t._idToken,uid_hash:t._uidHash,user_number:t._phoneNumber,schemeVersion:"v1",device_signing_key_tag_salt:t._deviceSigningKeyTagSalt};return t._ephemeralUserId&&(e.ephemeral_id=t._ephemeralUserId),e},o.save=function(t,n){if(n._ephemeral)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to save ephemeral user record to persistent store.",{});var r=t.host.readStorageKey(o.storageKey);r.length=r.length||0;for(var i=0;i<r.length&&!o.fromUserRecord(r[i],t).guid.equalsUserGuid(n.guid);i++);r[i]=o.toUserRecord(n),r.length<i+1&&(r.length=i+1),t.host.writeStorageKey(o.storageKey,r)},o.fromUserRecord=function(t,e){var r=new o;return r._sdk=e,r._defaultAuthId=t.default_auth_id,r._deviceBound=t.device_bound,r._hasLoggedIn=t.has_logged_in,r._deviceId=t.device_id,r._phoneNumber=t.user_number,r._deviceSigningKeyTagSalt=t.device_signing_key_tag_salt,r._userId=t.user_id,r._idToken=t.id_token,r._uidHash=t.uid_hash,t.ephemeral_id&&(r._ephemeral=!0,r._ephemeralUserId=t.ephemeral_id),t.schemeVersion?(r._guid=n.createFromString(t.guid),r._displayName=t.display_name):(r._guid=n.createFromString(t.user_id),r._displayName=t.user_id),r},o.storageKey=new t.TarsusKeyPath("users"),o}();t.User=o})((e=t.sdk||(t.sdk={})).core||(e.core={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){t.InternalErrorWrongBiometric=1e3,t.InternalErrorBiometricInvalidated=1001,t.InternalErrorBiometricKeyStoreError=1002,t.InternalErrorBiometricNotConfigured=1003,t.InternalErrorBiometricOsLockTemporary=1004,t.InternalErrorBiometricOsLockPermanent=1005,t.InternalErrorBiometricFallbackPressed=1006,t.InternalErrorCouldNotGenerateSecureKey=1007,t.ErrorDataInternalError="internal_error",t.ErrorDataNumFailures="num_failures",t.ErrorDataServerErrorCode="server_error_code",t.ErrorDataServerErrorMessage="server_error_message",t.ErrorDataServerErrorData="server_error_data",t.ErrorDataRetriesLeft="retries",t.ErrorDataCommunicationError="communication_error",t.ErrorDataCommunicationSSL="ssl",t.FeatureCodeServerHeaders=1,t.FeatureCodeAuthFailover=2,t.FeatureCodeUnifiedRegFlow=3,t.FeatureCodePromotionAction=6,t.FeatureCodeSilentFingerprintRegistration=7,t.FeatureCodeMultiMethodRegistrationAction=8,t.FeatureCodeOtpCodeInvalidated=10,t.FeatureCodeEnvelopedClientRequest=11,t.FeatureCodeUnregistrationFlow=12,t.FeatureCodeFaceIdAuthentication=13,t.FeatureCodeDynamicPolicySupport=14,t.FeatureCodeAutoRequestForSignContent=19,t.FeatureDeviceBiometricsFPContinuation=27,t.FeatureCodeDebugBreakpointActionSupport=28,t.FeatureCodeFido2ClientEcKeyExtSupport=37,t.FeatureCodeMultiCredVaultFido2Support=38}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){e.TARSUS_VERSION="7.0.0",e.API_LEVEL=11,e.STATIC_FEATURE_SET=[t.sdkhost.FeatureCodeServerHeaders,t.sdkhost.FeatureCodeAuthFailover,t.sdkhost.FeatureCodeUnifiedRegFlow,t.sdkhost.FeatureCodePromotionAction,t.sdkhost.FeatureCodeSilentFingerprintRegistration,t.sdkhost.FeatureCodeMultiMethodRegistrationAction,t.sdkhost.FeatureCodeOtpCodeInvalidated,t.sdkhost.FeatureCodeEnvelopedClientRequest,t.sdkhost.FeatureCodeUnregistrationFlow,t.sdkhost.FeatureCodeDynamicPolicySupport,t.sdkhost.FeatureCodeDebugBreakpointActionSupport]}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var r=e.call(this,n,o)||this;return r._clientContext=r._controlFlowProcessor._clientContext,r._cancellationHolder=new t.util.CancelablePromiseHolder,r}return V(n,e),n.prototype.run=function(){var e=this;return this._cancellationHolder.resolveWith((function(t,n){e.doRunAction().then(t,n)})),this._cancellationHolder.cancellablePromise.catch((function(n){if(n==t.util.CancelablePromiseHolder.CancelRequest)return e._controlFlowProcessor.createExternalCancellationRejectionPromise();throw n}))},n.prototype.cancelRun=function(){this._cancellationHolder.cancel()},n}(e.ActionDriver);e.SimpleCancellationActionDriver=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(n){!function(o){!function(o){var r=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.doRunAction=function(){var o=this;this._sdk.log(n.LogLevel.Debug,(function(){return"Executing Anonymous FIDO2 authentication."}));var r=this._action;return this._sdk.host.fido2CredentialsOp(this._uiHandler,this._controlFlowProcessor,this._policyAction,e.sdkhost.Fido2CredentialsOpType.Get,r.credentialRequestOptions).then((function(t){var e={assertion_credential:t};return o.sendAssertionRequest("authenticate",e)})).catch((function(e){var r=t.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(e);if(r.getErrorCode()===n.AuthenticationErrorCode.UserCanceled){o._sdk.log(n.LogLevel.Debug,(function(){return"Received FIDO2 cancellation request."}));var i=o._policyAction.getEscapeOptions().filter((function(e){return e.getPresentation()==t.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel}))[0];if(i){o._sdk.log(n.LogLevel.Debug,(function(){return"Got cancel escape option; responding with that."}));var s=new n.ActionEscapeRequest;return s.setEscapeOption(i),o.processEscapeRequest(s)}}throw r}))},r}(o.SimpleCancellationActionDriver);o.ActionDriverAnonymousFido2Authenticate=r}(o.actiondrivers||(o.actiondrivers={}))}(n.core||(n.core={}))}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(t){function e(e,n,o,r,i,s,a,u){var c=t.call(this,a._controlFlowProcessor._session,e,n,o)||this;return c._assertionId=r,c._retriesLeft=i,c._actionDriver=a,c._fallback=s,c._registration=u,c}return V(e,t),Object.defineProperty(e.prototype,"authDriver",{get:function(){return this._authDriver||(this._authDriver=this.authenticationDriverDescriptor.createAuthenticationDriver(this._actionDriver,this._authenticatorMethodConfig,this)),this._authDriver},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"suggestedParameters",{get:function(){return this.getEnabled()?this.authenticationDriverDescriptor.suggestParameters(this._authenticatorMethodConfig,this):[]},enumerable:!1,configurable:!0}),e.prototype.getEnabled=function(){return(this._registration||this.getRegistered()&&!this.getLocked())&&this.getSupportedOnDevice()},Object.defineProperty(e.prototype,"fallback",{get:function(){return this._fallback},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"assertionId",{get:function(){return this._assertionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retriesLeft",{get:function(){return this._retriesLeft},enumerable:!1,configurable:!0}),e.prototype.updateWithAssertionResult=function(t){t.retries_left&&(this._retriesLeft=t.retries_left),t.locked&&(this._locked=t.locked)},e.fromUnregistrationAction=function(t,n){return new e(t.method,t,t,t.assertion_id,null,null,n,!1)},e.fromPromotionAction=function(t,n){return new e(t.method,t,t,t.assertion_id,t.retries_left,t.fallback||null,n,!0)},e.fromAuthenticationActionMenuOption=function(t,n){return new e(t.type,t,t,t.assertion_id,t.retries_left,t.fallback||null,n,!1)},e.fromRegistrationAction=function(t,n){return new e(t.method,t,t,t.assertion_id,null,null,n,!0)},e}(e.authenticationdrivers.AuthenticatorDescriptionImpl);n.AuthenticationMenuAuthenticator=o;var r=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o._externallyCancelled=!1,o}return V(n,e),n.prototype.doRunAction=function(){var t=this;return new Promise((function(e,n){t._completionFunction=e,t._rejectionFunction=n,t.runActionWithCompletionFunctions()}))},Object.defineProperty(n.prototype,"availableAuthenticatorsForSwitching",{get:function(){return this.availableAuthenticators},enumerable:!1,configurable:!0}),n.prototype.sendPollingRequest=function(t,n){return e.prototype.sendPollingRequest.call(this,t,n)},n.prototype.sendAuthenticatorAssertionRequest=function(e,n,o,r){this._sdk.log(t.LogLevel.Debug,(function(){return"Sending authenticator asserion request for "+e.getAuthenticatorId()+": assert="+n}));var i={assertion_id:e.assertionId,method:e.getAuthenticatorId()};if(r)for(var s in r)i[s]=r[s];return this.sendAssertionRequest(n,o,i)},n.prototype.completeAuthenticationWithAssertionResult=function(t){this._completionFunction(t)},n.prototype.completeAuthenticationWithError=function(t){this._rejectionFunction(t)},n.prototype.completeWithEscapeRequest=function(t){var e=this;this.processEscapeRequest(t).then((function(t){e.completeAuthenticationWithAssertionResult(t)}),(function(t){e.completeAuthenticationWithError(t)}))},n.prototype.prepareForRunningAuthenticationDriver=function(t){return this._externallyCancelled?(this.completeAuthenticationWithError(this._controlFlowProcessor.createExternalCancellationError()),!1):(this._runningAuthenticatorDriver=t,!0)},n.prototype.cancelRun=function(){this._externallyCancelled=!0,this._runningAuthenticatorDriver&&this._runningAuthenticatorDriver.onCancelRun(),e.prototype.cancelRun.call(this)},n}(n.SimpleCancellationActionDriver);n.ActionDriverAuthenticatorOp=r}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.runActionWithCompletionFunctions=function(){var n=this._action;this._sdk.log(t.LogLevel.Debug,(function(){return"Loading authenticator descriptions"})),this.loadAuthenticatorDescriptionsFromAction(n),this._shouldUpdateDefaultAuth=n.options&&n.options.update_default,this._sdk.log(t.LogLevel.Debug,(function(){return"Starting auth presentation"})),this.runWithPresentationMode(n.options&&n.options.start_with||e.Protocol.AuthMenuPresentationMode.DefaultAuthenticator)},Object.defineProperty(r.prototype,"availableAuthenticators",{get:function(){return this.updateAvailableAuthenticatorsList(),this._availableAuthenticators.concat([])},enumerable:!1,configurable:!0}),r.prototype.runWithPresentationMode=function(n,o){var r=this;this.updateAvailableAuthenticatorsList();var i=n==e.Protocol.AuthMenuPresentationMode.AuthenticatorMenu&&this._uiHandler.shouldIncludeDisabledAuthenticatorsInMenu(this.policyAction(),this._clientContext)?this._allAuthenticators:this._availableAuthenticators;if(o&&(i=i.filter((function(t){return o.filter((function(e){return e.getAuthenticatorId()==t.getAuthenticatorId()})).length>0}))),i.length)switch(n){case e.Protocol.AuthMenuPresentationMode.AuthenticatorMenu:var s=i.map((function(e){return new t.impl.AuthenticationOptionImpl(e,e.suggestedParameters)}));this._uiHandler.selectAuthenticator(s,this.policyAction(),this._clientContext).then((function(e){switch(e.getResultType()){case t.AuthenticatorSelectionResultType.Abort:r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Cancel during authenticator selection."));break;case t.AuthenticatorSelectionResultType.SelectAuthenticator:if(!(s.filter((function(t){return t.getAuthenticator()==e.getSelectedAuthenticator()})).length>0)){r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"selectAuthenticator returned an authenticator not within options."));break}if(!e.getSelectedAuthenticator().getEnabled()){r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"selectAuthenticator returned a non-enabled authenticator."));break}r.runAuthenticator(e.getSelectedAuthenticator(),e.getSelectedAuthenticationParameters());break;case t.AuthenticatorSelectionResultType.Escape:r.completeWithEscapeRequest(e.getActionEscapeRequest())}}));break;case e.Protocol.AuthMenuPresentationMode.DefaultAuthenticator:this._defaultAuthenticator&&this._availableAuthenticators.indexOf(this._defaultAuthenticator)>=0?this.runAuthenticator(this._defaultAuthenticator,[]):(this._sdk.log(t.LogLevel.Warning,(function(){return"Default authenticator for user not found. Falling back to first authenticator in list."})),this.runAuthenticator(this._availableAuthenticators[0],[]));break;case e.Protocol.AuthMenuPresentationMode.FirstAuthenticator:this.runAuthenticator(this._availableAuthenticators[0],[])}else this._allAuthenticators.filter((function(t){return t.getLocked()})).length>0?this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AllAuthenticatorsLocked,"All authenticators locked.")):this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"No registered authenticator available."))},r.prototype.loadAuthenticatorDescriptionsFromAction=function(t){var e=this;this._allAuthenticators=t.methods.map((function(t){return n.AuthenticationMenuAuthenticator.fromAuthenticationActionMenuOption(t,e)}))},r.prototype.updateAvailableAuthenticatorsList=function(){var e=this;this._defaultAuthenticator=null,this._availableAuthenticators=[],this._allAuthenticators.forEach((function(t){t.getEnabled()&&e._availableAuthenticators.push(t),t.getDefaultAuthenticator()&&(e._defaultAuthenticator=t)})),this._defaultAuthenticator||(this._defaultAuthenticator=this._availableAuthenticators[0]),this._sdk.log(t.LogLevel.Debug,(function(){return"Updated available authenticators list; "+e._availableAuthenticators.length+" available authenticators"}))},r.prototype.runAuthenticator=function(n,o){var r=this,i=n.authDriver;this.prepareForRunningAuthenticationDriver(i)&&i.runAuthentication(o).then((function(o){if(o instanceof e.authenticationdrivers.AuthenticationDriverSessionResultSwitchAuthenticator)o.requiredAuthenticator?r.runAuthenticator(o.requiredAuthenticator,[]):r.runWithPresentationMode(e.Protocol.AuthMenuPresentationMode.AuthenticatorMenu,o.allowedAuthenticators);else if(o instanceof e.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted){if(r._shouldUpdateDefaultAuth&&(r._sdk.log(t.LogLevel.Info,(function(){return"Updating user default authenticator."})),!r._controlFlowProcessor._session.anonymous)){var i=r._controlFlowProcessor._session.user;i.updateDefaultAuthId(n.getAuthenticatorId()),r._controlFlowProcessor._session.persistUserData&&e.User.save(r._sdk,i)}r.completeAuthenticationWithAssertionResult(o.assertionResult)}else o instanceof e.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?r.completeWithEscapeRequest(o.escapeRequest):r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered."))}),(function(e){r._sdk.log(t.LogLevel.Debug,(function(){return"Received authentication driver error "+e})),r.completeAuthenticationWithError(e)}))},r}(n.ActionDriverAuthenticatorOp);n.ActionDriverAuthentication=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.doRunAction=function(){var n=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Executing confirmation action."}));var o=this._action;return this._uiHandler.getConfirmationInput(o.title,o.text,o.continue_button_text,o.cancel_button_text,this.policyAction(),this._clientContext).then((function(r){var i=r.getActionEscapeRequest();if(i)return n.processEscapeRequest(i);var s={user_cancelled:1==r.getUserChoice()},a=Promise.resolve(s);if(o.require_sign_content){var u={params:{title:o.title,text:o.text,continue_button_text:o.continue_button_text,cancel_button_text:o.cancel_button_text,parameters:o.parameters,image:o.image},user_input:s.user_cancelled?o.cancel_button_text:o.continue_button_text};a=a.then((function(t){return e.ActionDriverSignContent.augmentAssertionDataWithSignedContent(t,u,n._controlFlowProcessor._session.deviceSigningKeyPair,n._sdk)}))}return a.then((function(e){return n._sdk.log(t.LogLevel.Debug,(function(){return"Asserting confirmation: "+e})),n.sendAssertionRequest(null,e).then((function(t){return t}))}))}))},o}(e.SimpleCancellationActionDriver);e.ActionDriverConfirmation=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.doRunAction=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,(function(){return"Executing debug break action."})),this._sdk.host.setDebugIndicatorVisible(!0),this.pollUntilDone().finally((function(){e._sdk.host.setDebugIndicatorVisible(!1)}))},o.prototype.pollUntilDone=function(){var n=this,o={};return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._policyAction,this._clientContext,this._sdk.host.createDelayedPromise(250)).then((function(){return n.sendAssertionRequest(null,o)})).then((function(t){return t.assertion_error_code==e.Protocol.AssertionErrorCode.NotFinished?n.pollUntilDone():t}))},o}(n.SimpleCancellationActionDriver);n.ActionDriverDebugBreak=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.doRunAction=function(){var n=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Executing disable TOTP action..."}));var o=this._action,r=e.totp.TotpPropertiesProcessor.createWithUser(this._controlFlowProcessor._session.user,this._sdk,this._clientContext,this._controlFlowProcessor._session);return this._sdk.log(t.LogLevel.Debug,(function(){return"Obtained TOTP processor."})),o.config_ids.forEach((function(e){n._sdk.log(t.LogLevel.Debug,(function(){return"Deleting TOTP processor "+e+"."})),r.deleteProvisionForGenerator(e),n._sdk.log(t.LogLevel.Debug,(function(){return"TOTP processor "+e+" deleted."}))})),this.sendAssertionRequest()},o}(n.SimpleCancellationActionDriver);n.ActionDriverDisableTotp=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.doRunAction=function(){var t=this,n=this._action,o=r.formExtensionPoint.firstNonNull((function(t){return t.createFormSession(n.form_id,n.app_data)}));return o?(this._sdk.log(e.LogLevel.Debug,(function(){return'Using extension of type "com.ts.mobile.plugins.form.settings" for formId '+n.form_id})),this.session=o):this.session=this._uiHandler.createFormSession(n.form_id,n.app_data),this.session?new Promise((function(e,n){t.completionFunction=e,t.rejectionFunction=n,t.session.startSession(t._clientContext,t.policyAction()),t.session.promiseFormInput().then((function(e){return t.processPromiseResult(e)}),t.rejectionFunction)})):Promise.reject(e.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createFormSession."))},r.prototype.processPromiseResult=function(t){switch(t.getControlRequest()){case e.FormControlRequest.Submit:var n={input:t.getJsonData()};this.request(n);break;case e.FormControlRequest.Abort:this.terminateSession(),this.rejectionFunction(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.UserCanceled,"User cancelled a form action."));break;case e.FormControlRequest.Escape:this.terminateSession(),this.processEscapeRequest(t.getActionEscapeRequest()).then(this.completionFunction,this.rejectionFunction)}},r.prototype.terminateSession=function(){this.session&&(this.session.endSession(),delete this.session)},r.prototype.request=function(t){var e=this;this.sendAssertionRequest(null,null,t).then((function(t){var o=t.data;switch(t.assertion_error_code){case n.Protocol.AssertionErrorCode.NotFinished:e.session.onContinue(o),e.session.promiseFormInput().then((function(t){return e.processPromiseResult(t)}),e.rejectionFunction);break;case n.Protocol.AssertionErrorCode.RepeatCurrentStep:e.session.onError(o),e.session.promiseFormInput().then((function(t){return e.processPromiseResult(t)}),e.rejectionFunction);break;default:e.terminateSession(),e.completionFunction(t)}})).catch((function(t){e.terminateSession(),e.rejectionFunction(t)}))},r.formExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_FORMS_EXTENSION),r}(o.SimpleCancellationActionDriver);o.ActionDriverForm=r}(n.actiondrivers||(n.actiondrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n){return e.call(this,t,n)||this}return V(n,e),n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Executing information action."}));var n=this._action;return this._uiHandler.getInformationResponse(n.title,n.text,n.button_text,this.policyAction(),this._clientContext).then((function(n){if(n.getActionEscapeRequest())return e.processEscapeRequest(n.getActionEscapeRequest());if(e._sdk.log(t.LogLevel.Debug,(function(){return"Asserting information"})),-1!=n.getUserChoice())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"ConfirmationInput.getUserChoice must be set to -1.");return e.sendAssertionRequest()}))},n}(e.SimpleCancellationActionDriver);e.ActionDriverInformation=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(t){function e(e,o){var r=t.call(this,e)||this;return e instanceof n.SerializationContext||(r._idpSessionContinuationData=o),r}return V(e,t),Object.defineProperty(e.prototype,"idpSessionContinuationData",{get:function(){return this._idpSessionContinuationData},enumerable:!1,configurable:!0}),e.prototype.createResumableProcess=function(t){return new i(t,this)},e.prototype.serializeTo=function(e){t.prototype.serializeTo.call(this,e),e.writePrimitive("idpSessionContinuation",this._idpSessionContinuationData)},e.prototype.serializeFrom=function(e){t.prototype.serializeFrom.call(this,e),this._idpSessionContinuationData=e.readPrimitive("idpSessionContinuation")},e=z([n.Serializable("ActionDriverInvokeIdpContinuation"),J("design:paramtypes",[Object,Object])],e)}(o.ResumableProcessActionContinuation);o.ActionDriverInvokeIdpContinuation=r;var i=function(o){function i(){return null!==o&&o.apply(this,arguments)||this}return V(i,o),i.prototype.extensionPointForIdp=function(){var t=this,n=i.idpExtensionPoint.first((function(e){return e.canHandleIdp(t.idpName)}));if(!n)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Could not locate IDP handler plugin for idp "+this.idpName+".");return n},i.prototype.resume=function(t,n){var o=this;if(!(t instanceof r))throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid continuation type for ActionDriverInvokeIdp");return new Promise((function(e,r){o.extensionPointForIdp().resumeFromContinuation(t.idpSessionContinuationData,n).then((function(t){return o.processIdpResponse(t)})).then(e,r)}))},i.prototype.createContinuation=function(){return new r(this._action,this._activeIdpAuthSession&&this._activeIdpAuthSession.serializeContinuationData())},i.prototype.run=function(){var t=this;return new Promise((function(e,n){var o=t.extensionPointForIdp().createIdpAuthSession(t.idpName);t._activeIdpAuthSession=o,o.startSession(t._controlFlowProcessor._session.user.userHandle,t._action,t.policyAction(),t._clientContext),t._activeIdpAuthSession.invokeIdp().finally((function(){o.endSession(),t._activeIdpAuthSession=null})).then((function(e){return t.processIdpResponse(e)})).then(e,n)}))},Object.defineProperty(i.prototype,"idpName",{get:function(){return this._action.idp_name},enumerable:!1,configurable:!0}),i.prototype.processIdpResponse=function(t){return this.sendAssertionRequest(null,{idp_response:t.getResultPayload()})},i.idpExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_IDP_LOGIN_PROVIDER),i}(o.ResumableProcessActionDriver);o.ActionDriverInvokeIdp=i}(n.actiondrivers||(n.actiondrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n){return e.call(this,t,n)||this}return V(n,e),n.prototype.run=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,(function(){return"Executing JSON data action."})),this.sendAssertionRequest().then((function(o){return e._sdk.log(t.LogLevel.Debug,(function(){return"Executing JSON data action: "+o})),n.handleJsonDataByUiHandler(e._uiHandler,o,o.data.json_data,e._policyAction,e._clientContext)}))},n.handleJsonDataByUiHandler=function(e,n,o,r,i){return e.processJsonData(o,r,i).then((function(e){if(e.getContinueProcessing())return n;throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User cancelled a JSON action.")}))},n}(e.ActionDriver);e.ActionDriverJsonData=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var Y;Y.ts.mobile.tarsusplugin.KycDataCollectionResult,Y.ts.mobile.sdk.InputOrControlResponse;!function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.doRunAction=function(){return $(this,void 0,void 0,(function(){var t,e,o,r,i,s;return X(this,(function(a){switch(a.label){case 0:t=this.extensionPointForKyc(),(e=t.createSession(this.action.vendor_name,this.action.payload)).startSession(this._controlFlowProcessor._clientContext,this.policyAction()),a.label=1;case 1:a.trys.push([1,8,9,10]),o=null,a.label=2;case 2:return o&&o.assertion_error_code!=n.Protocol.AssertionErrorCode.NotFinished?[3,7]:(r=o?o.data.payload:this.action.payload,[4,e.collectKycData(r)]);case 3:return(i=a.sent()).isControlRequest()?[2,this.handleControlRequest(i.getControlRequest())]:[3,4];case 4:return[4,this.handleUserResponse(i.getResponse())];case 5:o=a.sent(),a.label=6;case 6:return[3,2];case 7:return[2,o];case 8:return s=a.sent(),[2,Promise.reject(s)];case 9:return e.endSession(),[7];case 10:return[2]}}))}))},r.prototype.handleControlRequest=function(t){switch(this.logDebug((function(){return"Processing control request "+t.getRequestType()})),t.getRequestType()){case e.ControlRequestType.AbortAuthentication:return this.rejectedPromise(e.AuthenticationErrorCode.UserCanceled,"Scan qr code action canceled by user.");default:return this.rejectedPromise(e.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+t.getRequestType()+" for kyc action.")}},r.prototype.handleUserResponse=function(t){return $(this,void 0,void 0,(function(){var e,o,i;return X(this,(function(s){switch(s.label){case 0:return this.logDebug((function(){return"Processing kyc data"})),e=t.getPayload(),o={payload:e},[4,this.sendAssertionRequest(r.AssertActionSendData,o)];case 1:i=s.sent(),this.logDebug((function(){return"Server result: "+i.assertion_error_code})),s.label=2;case 2:return i.assertion_error_code!=n.Protocol.AssertionErrorCode.ExternalProcessPending?[3,5]:[4,this.delay(3e3)];case 3:return s.sent(),[4,this.sendAssertionRequest(r.AssertActionPoll,{})];case 4:return i=s.sent(),this.logDebug((function(){return"Server result: "+i.assertion_error_code})),[3,2];case 5:return[2,i]}}))}))},r.prototype.extensionPointForKyc=function(){var t=this,n=r.kycExtensionPoint.firstNonNull((function(e){return e.canHandleProvider(t.action.vendor_name)?e:null}));if(!n)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Could not locate KYC handler plugin for kyc provider "+this.action.vendor_name+".");return n},Object.defineProperty(r.prototype,"action",{get:function(){return this._action},enumerable:!1,configurable:!0}),r.prototype.rejectedPromise=function(t,n){return Promise.reject(new e.impl.AuthenticationErrorImpl(t,n))},r.prototype.logDebug=function(t){this._sdk.log(e.LogLevel.Debug,t)},r.prototype.delay=function(t){return this._sdk.host.createDelayedPromise(t)},r.AssertActionPoll="poll",r.AssertActionSendData="data",r.kycExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_KYC),r}(o.SimpleCancellationActionDriver);o.ActionDriverKyc=r}(n.actiondrivers||(n.actiondrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e){var n=o.call(this,t,e)||this;return n.isAssertionContainerNotComplete=!1,n}return V(r,o),r.prototype.strategyStatePerUserStorageKey=function(){var t=this._controlFlowProcessor._session.user.guid;return new e.TarsusKeyPath("per_user",t.toString(),"promotion_strategy_state")},r.prototype.runActionWithCompletionFunctions=function(){var e=this;if(this._sdk.log(t.LogLevel.Debug,(function(){return"ActionDriverPromotion#runActionWithCompletionFunctions() started"})),this._action=this._action,this._action.assertions.length<1)return this._sdk.log(t.LogLevel.Info,(function(){return"runActionWithCompletionFunctions() Promotion has no assertions, finishing action."})),void this.completeWithDeclineAssertion();if(!this.shouldDisplayPromotion())return this._sdk.log(t.LogLevel.Info,(function(){return"runActionWithCompletionFunctions() Promotion stragety stop, finishing action."})),void this.completeWithDeclineAssertion();if(this._session=this._uiHandler.createRegistrationPromotionSession(this._controlFlowProcessor._session.user.displayName,this._policyAction),this._session){this._session.startSession(this._clientContext,this.policyAction());var o=this._action.options;this._session.promptIntroduction(o.title,o.text,o.ok_button,o.decline_button).then((function(t){if(e.handlePromotionInputControlOrEscapeRequest(t)){for(var o=e._action.assertions,r=new Array,i=0;i<o.length;i++){var s=n.AuthenticationMenuAuthenticator.fromPromotionAction(o[i],e);s.getSupportedOnDevice()&&r.push(s)}e._authenticatorList=r,e.suggestAuthenticators()}}))}else this._rejectionFunction(t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createRegistrationPromotionSession."))},r.prototype.sendAssertionRequest=function(t,n,r){var i=this;return this.isAssertionContainerNotComplete=!1,o.prototype.sendAssertionRequest.call(this,t,n,r).then((function(t){return t.assertion_error_code==e.Protocol.AssertionErrorCode.AssertionContainerNotComplete&&(t.assertion_error_code=void 0,i.isAssertionContainerNotComplete=!0),t}))},r.prototype.suggestAuthenticators=function(n){var o=this;if(void 0===n&&(n=this._authenticatorList),this._currentAuthentictorSelected){var r=n.indexOf(this._currentAuthentictorSelected);r>-1&&n.splice(r,1)}this._session.setPromotedAuthenticators(n).then((function(n){if(o.handlePromotionInputControlOrEscapeRequest(n)){var r=n.getSelectedAuthenticator();o._currentAuthentictorSelected=r;var i=r.authDriver;o.prepareForRunningAuthenticationDriver(i)&&r.authDriver.runRegistration().then((function(n){if(n instanceof e.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted)o.isAssertionContainerNotComplete?(o._sdk.log(t.LogLevel.Debug,(function(){return"suggestAuthenticators() callback result: promotion not completed. showing list again."})),o.suggestAuthenticators()):(o._sdk.log(t.LogLevel.Debug,(function(){return"suggestAuthenticators() callback result: promotion completed. finishing"})),o.completeAuthenticationWithAssertionResult(n.assertionResult));else if(n instanceof e.authenticationdrivers.AuthenticationDriverSessionResultSwitchAuthenticator)if(n.allowedAuthenticators){o._sdk.log(t.LogLevel.Debug,(function(){return"suggestAuthenticators() callback result: switch authentciator with allowed authenticators called"}));var r=n.allowedAuthenticators;o._currentAuthentictorSelected=null,o.suggestAuthenticators(r)}else o._sdk.log(t.LogLevel.Debug,(function(){return"suggestAuthenticators() callback result: switch authentciator called"})),o._currentAuthentictorSelected=null,o.suggestAuthenticators();else n instanceof e.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?o.completeWithEscapeRequest(n.escapeRequest):(o._sdk.log(t.LogLevel.Error,(function(){return"suggestAuthenticators() unexpected callback result: stopping with error.'"})),o.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered during registration.")))}),(function(e){o._sdk.log(t.LogLevel.Error,(function(){return"suggestAuthenticators() error callback result: stopping with error. error: '"+e._data+"'"})),o.completeAuthenticationWithError(e)}))}else o._sdk.log(t.LogLevel.Debug,(function(){return"suggestAuthenticators() stopped by ControlRequest of type "+n.getControlRequest()}))}))},r.prototype.handlePromotionInputControlOrEscapeRequest=function(e){if(e.getActionEscapeRequest())return this.completeWithEscapeRequest(e.getActionEscapeRequest()),!1;if(!e.isControlRequest())return!0;switch(e.getControlRequest()){case t.PromotionControlRequest.Continue:return!0;case t.PromotionControlRequest.Skip:return this.completeWithDeclineAssertion(),!1;case t.PromotionControlRequest.Abort:return this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User aborted/canceled")),!1;default:return this._sdk.log(t.LogLevel.Warning,(function(){return"handlePromotionInputControlRequest() received invalid PromotionInput, unsupported ControlRequest"})),!1}},r.prototype.sendDeclineAssertion=function(){return this.sendAssertionRequest(r.ASSERT_DECLINE)},r.prototype.completeWithDeclineAssertion=function(){var t=this;this.sendDeclineAssertion().then((function(e){t.completeAuthenticationWithAssertionResult(e)})).catch((function(e){t.completeAuthenticationWithError(e)}))},r.prototype.completeAuthenticationWithAssertionResult=function(t){this.terminateSession(),o.prototype.completeAuthenticationWithAssertionResult.call(this,t)},r.prototype.completeAuthenticationWithError=function(t){this.terminateSession(),o.prototype.completeAuthenticationWithError.call(this,t)},r.prototype.terminateSession=function(){this._session&&(this._session.endSession(),delete this._session)},Object.defineProperty(r.prototype,"availableAuthenticatorsForSwitching",{get:function(){return this.availableAuthenticators},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"availableAuthenticators",{get:function(){return this._authenticatorList.concat([])},enumerable:!1,configurable:!0}),r.prototype.shouldDisplayPromotion=function(){var e=this.readStrategyState();if(null==e||null==e.lastPromotionDate||null==e.loginsCounter)return this._sdk.log(t.LogLevel.Debug,(function(){return"shouldDisplayPromotion() first promotion. Stored data was empty."})),e={loginsCounter:1,lastPromotionDate:0},this.updateStrategyState(e),!0;for(var n=this._action.options.strategies,o=!0,r=function(n){if(0==i.checkStrategy(n,e))return i._sdk.log(t.LogLevel.Debug,(function(){return"shouldDisplayPromotion() strategy stopped promotion. strategy type: "+n.type})),o=!1,"break"},i=this,s=0,a=n;s<a.length;s++){if("break"===r(a[s]))break}return e.loginsCounter+=1,this.updateStrategyState(e),o},r.prototype.updateStrategyState=function(t){this._sdk.host.writeStorageKey(this.strategyStatePerUserStorageKey(),t)},r.prototype.readStrategyState=function(){var e=this._sdk.host.readStorageKey(this.strategyStatePerUserStorageKey());return null!=e.lastPromotionDate&&null!=e.loginsCounter?(this._sdk.log(t.LogLevel.Debug,(function(){return"Stored state found, "+JSON.stringify(e)})),e):(this._sdk.log(t.LogLevel.Debug,(function(){return"No stored state, trying to read legacy format"})),this.readLegacyStrategyStateFormat())},r.prototype.readLegacyStrategyStateFormat=function(){var n=this._sdk.host.readStorageKey(new e.TarsusKeyPath("stragety"));return null!=n.days&&null!=n.logins?(this._sdk.log(t.LogLevel.Debug,(function(){return"Reading from legacy format, "+JSON.stringify(n)})),{loginsCounter:n.logins,lastPromotionDate:n.days}):null},r.prototype.checkStrategy=function(t,n){if(t.type==e.Protocol.PromotionStrategyFrequency.LOGINS)return n.loginsCounter%t.value==0;if(t.type==e.Protocol.PromotionStrategyFrequency.DAYS){var o=new Date,r=new Date;r.setTime(n.lastPromotionDate);var i=new Date;return i.setDate(r.getDate()+t.value),i.getTime()<=o.getTime()&&(n.lastPromotionDate=o.getTime(),!0)}return!1},r.ASSERT_DECLINE="decline",r.ACTION_REGISTRATION="registration",r.ACTION_PROMOTION="registration_promotion",r}(n.ActionDriverAuthenticatorOp);n.ActionDriverPromotion=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.doRunAction=function(){var o=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Executing provision TOTP action."})),this._cfmAction=this._action;var r=n.totp.TotpPropertiesProcessor.createWithUser(this._controlFlowProcessor._session.user,this._sdk,this._clientContext,this._controlFlowProcessor._session),i=r.createTotpDriver(this._cfmAction.generator,this._cfmAction.otp_type);return i?(r.deleteProvisionForGenerator(this._cfmAction.generator),i.promiseProvisionOutput(this._cfmAction,this.policyAction(),this._clientContext,this._uiHandler).then((function(n){if(n instanceof t.tarsusplugin.TotpProvisionOutput)return o.sendAssertionRequest(null,n.getAssertionData()).then((function(t){return n.finalize(t),r.updateWithProvisionedGenerator(o._cfmAction,n),t}));if(n instanceof t.tarsusplugin.TotpProvisionEscapeRequest)return o.processEscapeRequest(n.getEscapeRequest());throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid TOTP provision output response")}))):(this._sdk.log(e.LogLevel.Error,(function(){return"failed to create TOTP driver"})),Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"failed to create TOTP driver")))},r}(o.SimpleCancellationActionDriver);o.ActionDriverProvisionTotp=r}(n.actiondrivers||(n.actiondrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.toValidVaultPath=function(n){var o=e.TarsusKeyPath.fromString(n);if(!t.UserVault.isValidKeyPathForUserVault(o))throw this._sdk.log(t.LogLevel.Error,(function(){return"Invalid user vault path "+o})),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid user vault path "+o);return o},o.prototype.doRunAction=function(){var n=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Executing provision TOTP action."})),this._vaultAction=this._action;var o=Promise.resolve();return this._vaultAction.new_vaults.forEach((function(r){o=o.then((function(){var o=n.toValidVaultPath(r.vault.vault_id);n._sdk.log(t.LogLevel.Debug,(function(){return"Will provision vault "+o}));var i=r.vault.vault_type,s=e.vault.VaultTypes[i];return s?s.createNew(n._controlFlowProcessor._session.user,o,n,n._sdk,n._controlFlowProcessor._uiHandler,!1,r).then((function(){})):(n._sdk.log(t.LogLevel.Error,(function(){return"failed to find vault driver for type "+i})),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"failed to create TOTP driver for type "+i)))}))})),(o=o.then((function(o){n._vaultAction.deleted_vaults.forEach((function(o){var r=n.toValidVaultPath(o);n._sdk.log(t.LogLevel.Debug,(function(){return"Will delete vault "+r})),e.vault.Vault.deleteVaultForUserWithId(n._controlFlowProcessor._session.user,r,n._sdk)}))}))).then((function(){return n.sendAssertionRequest()}))},o.prototype.getValidCancelOptions=function(){return[t.ControlRequestType.SelectMethod,t.ControlRequestType.ChangeMethod,t.ControlRequestType.RetryAuthenticator,t.ControlRequestType.CancelAuthenticator]},o.prototype.getValidErrorRecoveryOptions=function(e){return[t.AuthenticationErrorRecovery.RetryAuthenticator,t.AuthenticationErrorRecovery.ChangeAuthenticator,t.AuthenticationErrorRecovery.SelectAuthenticator,t.AuthenticationErrorRecovery.Fail]},o}(n.SimpleCancellationActionDriver);n.ActionDriverProvisionUserVault=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e){return o.call(this,t,e)||this}return V(r,o),r.prototype.runActionWithCompletionFunctions=function(){var o=this,r=this._action;this._sdk.log(t.LogLevel.Debug,(function(){return"Loading and validating authenticator description"}));for(var i=0;i<r.assertions.length;i++){var s=n.AuthenticationMenuAuthenticator.fromRegistrationAction(r.assertions[i],this);if(s.getSupportedOnDevice()){this._registeredAuthenticator=s,this._silentRegistration=!!r.assertions[i].silent;break}}if(this._registeredAuthenticator){var a=this._registeredAuthenticator.authDriver;this.prepareForRunningAuthenticationDriver(a)&&(this._sdk.log(t.LogLevel.Debug,(function(){return"Starting auth registeration"})),a.runRegistration().then((function(n){n instanceof e.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted?o.completeAuthenticationWithAssertionResult(n.assertionResult):n instanceof e.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?o.completeWithEscapeRequest(n.escapeRequest):o.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered during registration."))}),(function(e){o._sdk.log(t.LogLevel.Debug,(function(){return"Received authentication driver error "+e})),o.completeAuthenticationWithError(e)})))}else this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"No supported authenticator listed in registeration request."))},Object.defineProperty(r.prototype,"availableAuthenticatorsForSwitching",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"availableAuthenticators",{get:function(){return[this._registeredAuthenticator]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isSilentRegistration",{get:function(){return this._silentRegistration},enumerable:!1,configurable:!0}),r}(n.ActionDriverAuthenticatorOp);n.ActionDriverRegistration=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n){return e.call(this,t,n)||this}return V(n,e),n.prototype.run=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,(function(){return"Executing scan qr action."})),new Promise((function(n,o){var r=e._action,i=t.QrCodeFormat.Alphanumeric;if(r.qr_code_format_type&&(i=t.QrCodeFormatImpl.fromAssertionFormat(r.qr_code_format_type)),e._session=e._uiHandler.createScanQrSession(e._policyAction,e._clientContext),!e._session)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createScanQrSession.");e._session.startSession(e._clientContext,e.policyAction()),e._session.getScanQrResponse(r.instructions,i).then((function(n){if(n.isControlRequest())return e.processControlRequest(n.getControlRequest());if(null!=n.getActionEscapeRequest())return e.processEscapeRequest(n.getActionEscapeRequest());var o={qr_content:n.getResponse().getQrCodeResult().getQrCode()};return e._sdk.log(t.LogLevel.Debug,(function(){return"Asserting scan qr: "+o.qr_content})),e.sendAssertionRequest(null,o).catch((function(n){throw e._sdk.log(t.LogLevel.Error,(function(){return"Scan qr sendAssertionRequest error: "+n})),n}))})).catch((function(n){throw e._sdk.log(t.LogLevel.Error,(function(){return"Scan qr action error: "+n})),n})).finally((function(){e._session.endSession(),delete e._session})).then(n,o)}))},n.prototype.processControlRequest=function(e){var n=this;return new Promise((function(o,r){switch(n._sdk.log(t.LogLevel.Debug,(function(){return"Processing control request "+e.getRequestType()})),e.getRequestType()){case t.ControlRequestType.CancelAuthenticator:r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Scan qr code action canceled by user."));break;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+e.getRequestType()+" for scan qr action.")}}))},n}(e.ActionDriver);e.ActionDriverScanQr=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.actiondrivers||(o.actiondrivers={}),n=function(t){function e(e,n){return t.call(this,e,n)||this}return V(e,t),e.augmentAssertionDataWithSignedContent=function(t,e,n,o){var i=JSON.stringify(e);o.log(r.LogLevel.Debug,(function(){return"Signing consent payload: "+i}));var s=r.util.asciiToHex(i);return n.signHex(s).then((function(e){var n=r.util.hexToBase64(e),o={payload:i,signed_payload:n};return t.sign_content_data=o,t}))},e.prototype.run=function(){var t=this;this._sdk.log(r.LogLevel.Debug,(function(){return"Executing consent action."}));var n=this._controlFlowProcessor.initiatingRequest&&this._controlFlowProcessor.initiatingRequest.body,i={params:n&&n.params||{}};if(this._controlFlowProcessor.requestContext&&this._controlFlowProcessor.requestContext instanceof o.ApprovalControlFlowExecutionContext){var s=this._controlFlowProcessor.requestContext.approval;i.approval={approval_id:s.getApprovalId(),message:{title:s.getTitle(),details:s.getDetails()}}}return e.augmentAssertionDataWithSignedContent({},i,this._controlFlowProcessor._session.deviceSigningKeyPair,this._sdk).then((function(e){return t.sendAssertionRequest(null,e)}))},e}(e.ActionDriver),e.ActionDriverSignContent=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.doRunAction=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,(function(){return"Executing ticket wait action."})),new Promise((function(n,o){var r=e._action;if(e._session=e._uiHandler.createTicketWaitSession(e._policyAction,e._clientContext),!e._session)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTicketWaitSession.");e._session.setWaitingTicket(new t.impl.TicketWaitingInformationImpl(r)),e._session.startSession(e.policyAction(),e._clientContext),e.pollServer().then((function(t){n(t)})).finally((function(){e._session.endSession(),delete e._session})).catch((function(n){e._sdk.log(t.LogLevel.Error,(function(){return"Wait for ticket action error: "+n})),o(n)}))}))},o.prototype.pollServer=function(){var n=this,o={};return this._sdk.log(t.LogLevel.Debug,(function(){return"Asserting ticket wait poll"})),new Promise((function(t,r){var i,s=3;!function a(){0===s?r(i):n.sendAssertionRequest(null,o).then((function(o){o.assertion_error_code==e.Protocol.AssertionErrorCode.ExternalProcessPending?t(n.inputLoop()):t(o)})).catch((function(t){s--,i=t,n._sdk.host.createDelayedPromise(10).then((function(){a()}))}))}()}))},o.prototype.longPoll=function(t){var e=this,n={type:"ticket",ticket_id:this._action.raw_ticket_id};return this.sendPollingRequest(n,t).then((function(t){return t.change_detected?e.pollServer():e.inputLoop()}))},o.prototype.inputLoop=function(){var e=this;return this._session.promiseInput().then((function(n){if(n.isControlRequest())return e.processControlRequest(n.getControlRequest());if(null!=n.getActionEscapeRequest())return e.processEscapeRequest(n.getActionEscapeRequest());var o=n.getResponse();if(o instanceof t.TicketWaitInputPollRequest){var r=o.getPollingTimeout();return r?e.longPoll(r):e.pollServer()}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expected polling request input response but got: "+o)}))},o.prototype.processControlRequest=function(e){var n=this;return new Promise((function(o,r){switch(n._sdk.log(t.LogLevel.Debug,(function(){return"Processing control request "+e.getRequestType()})),e.getRequestType()){case t.ControlRequestType.CancelAuthenticator:case t.ControlRequestType.AbortAuthentication:r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Wait for ticket action canceled by user."));break;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+e.getRequestType()+" for ticket wait action.")}}))},o}(n.SimpleCancellationActionDriver);n.ActionDriverTicketWait=o}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(n){function o(t,e){return n.call(this,t,e)||this}return V(o,n),o.prototype.runActionWithCompletionFunctions=function(){this._action=this._action,this._sdk.log(t.LogLevel.Debug,(function(){return"Started unregister action!"})),e.AuthenticationMenuAuthenticator.fromUnregistrationAction(this._action,this).authDriver.runUnregistration().then(this._completionFunction,this._rejectionFunction)},Object.defineProperty(o.prototype,"availableAuthenticators",{get:function(){return this._availableAuthenticators.concat([])},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isSilentRegistration",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPlaceholder",{get:function(){return 0==this._action.method.indexOf("placeholder")},enumerable:!1,configurable:!0}),o.prototype.sendUnregisterAssertion=function(){return this.sendAssertionRequest()},o}(e.ActionDriverAuthenticatorOp);e.ActionDriverUnregistration=n}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(n){var o,r;o=n.dyadic||(n.dyadic={}),r=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return V(o,n),o.prototype.run=function(){var n=this;return Promise.resolve().then((function(o){return"false"==n._sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.DyadicPresent)?Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Dyadic capability is not present (is Dyadic SDK integrated?)")):n.issueDyadicRequest().then((function(t){return n.sendAssertionRequest(null,n.buildAssertionData(t)).then((function(o){var r=n.dyadicServerResponseFromAssertionResponse(o);return r?t.finalize(r).then((function(t){return o})):Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Dyadic data missing from server response"))}))}))})).catch((function(t){var o=e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t),r={msg:o.getMessage(),code:o.getErrorCode(),data:o.getData()};return n.sendErrorReportAssertionRequest(r).finally((function(){throw t}))}))},o.prototype.dyadicServerResponseFromAssertionResponse=function(t){var e=t.data&&t.data.dyadic;return e&&e.server_response},o.prototype.buildAssertionData=function(t){var e={requestData:"request_data",requestPayload:"request_payload",proxyPayload:"proxy_payload"},n=t.getServerRequest();Object.keys(e).forEach((function(t){var o=e[t];n[o]=n[t],delete n[t];var r=n[o];r&&(r.original_data=r.originalData,delete r.originalData)}));var o={dyadic:n};return o.dyadic.token_uid=t.getTokenId()||this._controlFlowProcessor._session.deviceId(),o},o}(n.ActionDriver),o.ActionDriverDyadic=r}(n.actiondrivers||(n.actiondrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.issueDyadicRequest=function(){var t=this._action,e=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicEnroll(e,t.server_info)},e}(t.ActionDriverDyadic);t.ActionDriverDyadicEnroll=e}(t.dyadic||(t.dyadic={}))}(t.actiondrivers||(t.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){!function(e){var n=function(){function t(){}return t.prototype.getServerRequest=function(){return this._serverRequest},t.prototype.getTokenId=function(){return this._signHandle.getTokenId()},t.prototype.finalize=function(t){var e=this,n=t,o=this._signHandle.finalize(n.server_response);return n.otp_token_refresh&&Object.keys(n.otp_token_refresh).forEach((function(t){o=o.then((function(o){return e._refreshTokenHandles[t].finalize(n.otp_token_refresh[t])}))})),o},t.create=function(e,n,o){var r=new t;return r._refreshTokenHandles=e,r._signHandle=n,r._serverRequest=o,r},t}(),o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.issueDyadicRequest=function(){var e=this,o=this._action,r=t.util.asciiToHex(o.assertion_id+this._controlFlowProcessor.challenge),i=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicSign(i,r).then((function(t){var r={},i=t.getServerRequest(),s=Promise.resolve(!0);return o.otp_token_uids&&0<o.otp_token_uids.length&&(i.otp_token_refresh={},o.otp_token_uids.forEach((function(t){s=s.then((function(n){return e._sdk.host.dyadicRefreshToken(t).then((function(e){return r[t]=e,i.otp_token_refresh[t]=e.getServerRequest(),!0}))}))}))),s.then((function(e){return n.create(r,t,i)}))}))},o.prototype.dyadicServerResponseFromAssertionResponse=function(t){return t.data&&t.data.dyadic},o}(e.ActionDriverDyadic);e.ActionDriverDyadicSign=o}(e.dyadic||(e.dyadic={}))}(e.actiondrivers||(e.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.issueDyadicRequest=function(){var t=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicDelete(t)},e}(t.ActionDriverDyadic);t.ActionDriverDyadicDelete=e}(t.dyadic||(t.dyadic={}))}(t.actiondrivers||(t.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){t.ActionDrivers={confirmation:t.ActionDriverConfirmation,information:t.ActionDriverInformation,json_data:t.ActionDriverJsonData,authentication:t.ActionDriverAuthentication,registration:t.ActionDriverRegistration,unregistration:t.ActionDriverUnregistration,provision_totp:t.ActionDriverProvisionTotp,disable_totp:t.ActionDriverDisableTotp,sign_content:t.ActionDriverSignContent,form:t.ActionDriverForm,registration_promotion:t.ActionDriverPromotion,scan_qr:t.ActionDriverScanQr,wait_for_ticket:t.ActionDriverTicketWait,dyadic_enroll:t.dyadic.ActionDriverDyadicEnroll,dyadic_sign:t.dyadic.ActionDriverDyadicSign,dyadic_un_enroll:t.dyadic.ActionDriverDyadicDelete,debug_break:t.ActionDriverDebugBreak,invoke_idp:t.ActionDriverInvokeIdp,provision_user_vault:t.ActionDriverProvisionUserVault,kyc:t.ActionDriverKyc,fido2_anonymous_auth:t.ActionDriverAnonymousFido2Authenticate}}(t.actiondrivers||(t.actiondrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(){function o(t,e,n){this._externalCancelled=!1,this._actionDriver=t,this._authenticatorConfig=e,this._authenticatorDescription=n,this._sdk=t._sdk,this._uiHandler=t._uiHandler,this._clientContext=t._clientContext}return o.prototype.runAuthentication=function(e){return this._authenticationParameters=e,this.runMode(t.AuthenticatorSessionMode.Authentication)},o.prototype.runRegistration=function(){if(this._actionDriver.isSilentRegistration){var e=this;return n.instanceOfAuthenticationDriverSilentRegistrationSupport(this)?(e._sdk.log(t.LogLevel.Debug,(function(){return"Invoking silent registration for "+e._authenticatorDescription.getAuthenticatorId()})),this.runSilentRegistration()):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorError,"Silent registration not supported for this authenticator"))}return this.runMode(t.AuthenticatorSessionMode.Registration)},o.prototype.runUnregistration=function(){var e=this,n=this._actionDriver;return this._sdk.currentUiHandler.handleAuthenticatorUnregistration(this._authenticatorDescription,n.isPlaceholder,n.policyAction(),this._clientContext).then((function(o){if(e._sdk.log(t.LogLevel.Debug,(function(){return"handleAuthenticatorUnregistration() result: "+o})),0==o.getUserChoice())return n.sendUnregisterAssertion().then((function(t){return e.handleUnregistrationAssertionResult(t),t}));var r=new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unregistration failed due to app implementation rejecting unregistertion.");return Promise.reject(r)}))},o.prototype.onCancelRun=function(){this._externalCancelled=!0},Object.defineProperty(o.prototype,"user",{get:function(){return this._actionDriver._controlFlowProcessor._session.user},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"operationMode",{get:function(){return this._operationMode},enumerable:!1,configurable:!0}),o.prototype.terminateSession=function(){this._inputSession&&(this._inputSession.endSession(),delete this._inputSession)},o.prototype.completeAuthenticatorSessionWithResult=function(t){this.terminateSession(),this._completionFunction(t)},o.prototype.completeAuthenticatorSessionWithError=function(e){try{this.terminateSession()}catch(e){this._sdk.log(t.LogLevel.Warning,(function(){return"Can't dismiss authenticator session during error reporting."}))}this._rejectionFunction(e)},o.prototype.handleInputOrControlResponse=function(e){try{e.isControlRequest()?this.processControlRequest(e.getControlRequest()):null!=e.getActionEscapeRequest()?this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultEscapeRequested(e.getActionEscapeRequest())):this._operationMode==t.AuthenticatorSessionMode.Authentication?this.handleAuthenticationInputResponse(e.getResponse()):this.handleRegistrationInputResponse(e.getResponse())}catch(e){this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}},o.prototype.processRegisterAssertion=function(e,o){var r=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"register",e,o).then((function(e){r.handleRegisterAssertionResult(e)||(r._sdk.log(t.LogLevel.Info,(function(){return"Registration session done."})),r.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultAuthenticationCompleted(e)))})).catch((function(e){r._sdk.log(t.LogLevel.Error,(function(){return"Perform error recovery with server error "+e})),r.performErrorRecoveryForError(e)}))},o.prototype.processAuthenticateAssertion=function(e,o){var r=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"authenticate",e,o).then((function(i){r.handleAuthenticateAssertionResult(i,r._authenticatorDescription,"authenticate",e,o)||(r._sdk.log(t.LogLevel.Info,(function(){return"Authenticator session done."})),r.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultAuthenticationCompleted(i)))})).catch((function(e){r._sdk.log(t.LogLevel.Error,(function(){return"Perform error recovery with server error "+e})),r.performErrorRecoveryForError(e)}))},o.prototype.runMode=function(e){var n=this;return new Promise((function(o,r){if(n._completionFunction=o,n._rejectionFunction=r,n._operationMode=e,n._inputSession=n.createAuthenticatorSession(),!n._inputSession)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from authenticator session creation call.");n._inputSession.startSession(n._authenticatorDescription,n._operationMode,n._actionDriver.policyAction(),n._clientContext),n.authOrRegInStartedSession(!1)})).catch((function(e){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e)}))},o.prototype.handleGeneralAssertionResult=function(o){return this._sdk.log(t.LogLevel.Debug,(function(){return"Authenticator assertion response "+JSON.stringify(o)})),o.data&&(this._sdk.log(t.LogLevel.Debug,(function(){return"Processing authenticator assertion response: updating assertion authenticator description"})),this._authenticatorDescription.updateWithAssertionResult(o.data)),o.state!=e.Protocol.AuthSessionState.Pending&&(this._sdk.log(t.LogLevel.Info,(function(){return"Authenticator session complete; status "+o.state})),this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultAuthenticationCompleted(o)),!0)},o.prototype.handleUnregistrationAssertionResult=function(t){},o.prototype.handleRegisterAssertionResult=function(e){return!!this.handleGeneralAssertionResult(e)||!!e.assertion_error_code&&(this._sdk.log(t.LogLevel.Error,(function(){return"handleRegisterAssertionResult() Assertion error encoutered. Starting error recovery."})),this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.errorForAssertionResponse(e)),!0)},o.prototype.handleAuthenticateAssertionResult=function(n,o,r,i,s){if(this.handleGeneralAssertionResult(n))return!0;if(n.assertion_error_code)switch(n.assertion_error_code){case e.Protocol.AssertionErrorCode.MustRegister:return this._sdk.log(t.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() Authenticator expired; must register"})),this.handleRegistrationDueToExpiration(),!0;case e.Protocol.AssertionErrorCode.FailOver:return this._sdk.log(t.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() Failover signalled"})),this.handleFallback(),!0;default:return this._sdk.log(t.LogLevel.Error,(function(){return"handleAuthenticateAssertionResult() Assertion error encoutered. Starting error recovery. 2"})),this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.errorForAssertionResponse(n)),!0}else if(this._authenticatorDescription.getExpired())return this._sdk.log(t.LogLevel.Info,(function(){return"Authenticator expired; must register"})),this.handleRegistrationDueToExpiration(),!0;return!1},o.prototype.processAuthFailureAssertionAndHandleError=function(n,o){var r=this,i={num_of_failures:o};this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",i).then((function(o){if(!r.handleGeneralAssertionResult(o)){if(o.assertion_error_code)switch(o.assertion_error_code){case e.Protocol.AssertionErrorCode.FailOver:return r._sdk.log(t.LogLevel.Info,(function(){return"Failover signalled during local failure report"})),r.handleFallback(),!0}n=t.impl.AuthenticationErrorImpl.augmentErrorData(n,o.data),r.performErrorRecoveryForError(n)}}),(function(e){var n=t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e);r._sdk.log(t.LogLevel.Error,(function(){return"Error ${authError} signalled during local failure report"})),r.performErrorRecoveryForError(n,!0)}))},o.prototype.handleRegistrationDueToExpiration=function(){this._inputSession.changeSessionModeToRegistrationAfterExpiration(),this._operationMode=t.AuthenticatorSessionMode.Registration,this.registerInStartedSession(!1)},o.prototype.authOrRegInStartedSession=function(e){this._operationMode==t.AuthenticatorSessionMode.Authentication?this.authenticateInStartedSession(e):this.registerInStartedSession(e)},o.prototype.processControlRequest=function(e){switch(this._sdk.log(t.LogLevel.Debug,(function(){return"Processing control request "+e.getRequestType()})),e.getRequestType()){case t.ControlRequestType.AbortAuthentication:this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Authentication cancelled due to abort control request."));break;case t.ControlRequestType.ChangeMethod:this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultSwitchAuthenticator(null,this.getAuthenticationActionOtherAuthenticators()));break;case t.ControlRequestType.SelectMethod:this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultSwitchAuthenticator);break;case t.ControlRequestType.CancelAuthenticator:this.invokeUiHandlerCancellation();break;case t.ControlRequestType.RetryAuthenticator:this.authOrRegInStartedSession(!0);break;default:this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid ControlRequestType value during authentication session."))}},o.prototype.invokeUiHandlerCancellation=function(){var e=this;if(this._externalCancelled)this.processControlRequest(t.ControlRequest.create(t.ControlRequestType.AbortAuthentication));else{var n=[t.ControlRequestType.RetryAuthenticator,t.ControlRequestType.AbortAuthentication];this.getAuthenticationActionOtherAuthenticators().length>0&&n.push(t.ControlRequestType.ChangeMethod),this._actionDriver.availableAuthenticatorsForSwitching.length>0&&n.push(t.ControlRequestType.SelectMethod),this._uiHandler.controlOptionForCancellationRequestInSession(n,this._inputSession).then((function(o){o.getRequestType()!=t.ControlRequestType.CancelAuthenticator?n.indexOf(o.getRequestType())<0?e.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned an invalid option.")):e.processControlRequest(o):e.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned CancelAuthenticator which is an invalid option."))}))}},o.prototype.getAuthenticationActionOtherAuthenticators=function(){var t=this;return this._actionDriver.availableAuthenticatorsForSwitching.filter((function(e){return e!=t._authenticatorDescription}))},o.prototype.handleFallback=function(){var e=this;if(this._authenticatorDescription.fallback){var o=[t.AuthenticatorFallbackAction.Retry,t.AuthenticatorFallbackAction.Cancel],r=null,i=this._authenticatorDescription.fallback.method;i?(r=this._actionDriver.availableAuthenticators.filter((function(t){return t.getAuthenticatorId()==i}))[0])&&o.push(t.AuthenticatorFallbackAction.Fallback):this.getAuthenticationActionOtherAuthenticators().length>0&&o.push(t.AuthenticatorFallbackAction.AuthMenu),this._uiHandler.selectAuthenticatorFallbackAction(o,r,this._inputSession,this._actionDriver.policyAction(),this._clientContext).then((function(i){switch(e._sdk.log(t.LogLevel.Debug,(function(){return"Fallback action selected "+i})),o.indexOf(i)<0&&(e._sdk.log(t.LogLevel.Error,(function(){return"Invalid fallback action selected: "+i+" not in "+o})),e.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid fallback action selected by callback."))),i){case t.AuthenticatorFallbackAction.Fallback:case t.AuthenticatorFallbackAction.AuthMenu:e.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultSwitchAuthenticator(r));break;case t.AuthenticatorFallbackAction.Retry:e.authOrRegInStartedSession(!0);break;case t.AuthenticatorFallbackAction.Cancel:e.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User cancel in response to fallback action."))}}))}else this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot handle a fallback error without fallback specification in action."))},o.prototype.recoveryOptionsForError=function(e,n){var o=[t.AuthenticationErrorRecovery.Fail];return[t.AuthenticationErrorCode.AllAuthenticatorsLocked,t.AuthenticationErrorCode.AppImplementation,t.AuthenticationErrorCode.ControlFlowExpired,t.AuthenticationErrorCode.SessionRequired,t.AuthenticationErrorCode.InvalidDeviceBinding,t.AuthenticationErrorCode.UserCanceled].indexOf(e.getErrorCode())>=0?o:(n||!this._authenticatorDescription.getEnabled()||this._operationMode==t.AuthenticatorSessionMode.Authentication&&e.getErrorCode()==t.AuthenticationErrorCode.AuthenticatorExternalConfigError||o.push(t.AuthenticationErrorRecovery.RetryAuthenticator),this.getAuthenticationActionOtherAuthenticators().length>0&&o.push(t.AuthenticationErrorRecovery.ChangeAuthenticator),this._actionDriver.availableAuthenticatorsForSwitching.length>0&&o.push(t.AuthenticationErrorRecovery.SelectAuthenticator),o)},o.prototype.performErrorRecoveryForError=function(e,n){var o=this,r=this.recoveryOptionsForError(e,n),i=this.defaultRecoveryForError(e);r.indexOf(i)<0&&(i=r.indexOf(t.AuthenticationErrorRecovery.SelectAuthenticator)>=0?t.AuthenticationErrorRecovery.SelectAuthenticator:t.AuthenticationErrorRecovery.Fail),this._inputSession.promiseRecoveryForError(e,r,i).then((function(n){o._sdk.log(t.LogLevel.Debug,(function(){return"Error recovery selected "+n})),o._sdk.log(t.LogLevel.Debug,(function(){return"recover from error: "+e.getErrorCode()})),r.indexOf(n)<0&&(o._sdk.log(t.LogLevel.Error,(function(){return"Invalid error recovery option from callback: "+n+" not in "+r})),o.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid error recovery action selected by callback."))),o.handleErrorRecoveryAction(n,e)}))},o.prototype.handleErrorRecoveryAction=function(e,o){switch(e){case t.AuthenticationErrorRecovery.RetryAuthenticator:this.authOrRegInStartedSession(!0);break;case t.AuthenticationErrorRecovery.ChangeAuthenticator:this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultSwitchAuthenticator(null,this.getAuthenticationActionOtherAuthenticators()));break;case t.AuthenticationErrorRecovery.SelectAuthenticator:this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultSwitchAuthenticator);break;case t.AuthenticationErrorRecovery.Fail:default:this.completeAuthenticatorSessionWithError(o)}},o.prototype.defaultRecoveryForError=function(e){return this._operationMode==t.AuthenticatorSessionMode.Authentication?!this._authenticatorDescription.getLocked()&&this._authenticatorDescription.getRegistered()&&this._authenticatorDescription.getEnabled()&&e.getErrorCode()!=t.AuthenticationErrorCode.AuthenticatorLocked&&e.getErrorCode()!=t.AuthenticationErrorCode.AllAuthenticatorsLocked?t.AuthenticationErrorRecovery.RetryAuthenticator:e.getErrorCode()!=t.AuthenticationErrorCode.AllAuthenticatorsLocked?t.AuthenticationErrorRecovery.ChangeAuthenticator:t.AuthenticationErrorRecovery.Fail:t.AuthenticationErrorRecovery.RetryAuthenticator},o}();n.AuthenticationDriver=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),n.prototype.authenticateInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.registerInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.handleAuthenticationInputResponse=function(e){var n;try{n=this.generateAssertionDataForInputResponse(e)}catch(e){return void this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}this.processAuthenticateAssertion(n)},n.prototype.handleRegistrationInputResponse=function(e){try{var n=this.generateAssertionDataForInputResponse(e)}catch(e){return void this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}this.processRegisterAssertion(n)},n.prototype.generateAssertionDataForInputResponse=function(t){return{secret:this.generateSecretToSignForInputResponse(t)}},n}(e.AuthenticationDriver);e.AuthenticationDriverCentralizedSecretInputBased=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){function n(t){this._authenticationDriverCtor=t}return n.prototype.createAuthenticationDriver=function(t,e,n){return new this._authenticationDriverCtor(t,e,n)},n.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},n.prototype.isSupportedOnDevice=function(t){return!0},n.prototype.suggestParameters=function(t,e){return[]},n.refreshInvalidatedAuthenticatorsEnrollments=function(t){return new Promise((function(n,o){var r,i=new Array;for(var s in t.user.localEnrollments){r=t.user.localEnrollments[s];var a=e.AuthenticatorDrivers[r.authenticatorId];i.push(a.checkAuthenticatorInvalidatedAndNotifyUIHandler(t))}Promise.all(i).then((function(t){n(t)})).catch((function(t){o(t)}))}))},n.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(t){return Promise.resolve(!0)},n}();e.SimpleAuthenticationDriverDescriptor=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.getEnabled=function(){return this.getSupportedOnDevice()},n.getDescription=function(t,o){return new n(t,o,{},{status:e.Protocol.AuthenticationMethodStatus.Unregistered})},n}(n.AuthenticatorDescriptionImpl),r=function(r){function i(t,e){var n=r.call(this,t)||this;return n._authenticatorType=e,n}return V(i,r),i.prototype.evaluateLocalRegistrationStatus=function(n){var o=n.user.localEnrollments[this._authenticatorType];return o?o.validationStatus==e.LocalEnrollmentValidationStatus.Invalidated?t.AuthenticatorRegistrationStatus.LocallyInvalid:t.AuthenticatorRegistrationStatus.Registered:t.AuthenticatorRegistrationStatus.LocallyInvalid},i.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(r){var i=this;return new Promise((function(s,a){r.sdk.log(t.LogLevel.Info,(function(){return"Checking if authenticator "+i._authenticatorType+" has become invalidated."}));var u=r.user.localEnrollments[i._authenticatorType];if(u.status==e.LocalEnrollmentStatus.Registered&&u.validationStatus!=e.LocalEnrollmentValidationStatus.Invalidated)if(n.AuthenticatorDrivers[i._authenticatorType].evaluateLocalRegistrationStatus(r)==t.AuthenticatorRegistrationStatus.LocallyInvalid){r.sdk.log(t.LogLevel.Info,(function(){return"Authenticator "+i._authenticatorType+" already became invalidated. Invalidating enrollment record and notifying ui handler."}));var c=o.getDescription(r,u.authenticatorId);e.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(r.getCurrentUserInteractionSessionProvider(),c).then((function(t){s(t)})).catch((function(t){a(t)}))}else s(!1);else s(!1)}))},i}(n.SimpleAuthenticationDriverDescriptor);n.AuthenticationDriverDescriptorLocal=r}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(n){var o=function(o){function r(){return o.call(this,n.AuthenticationDriverDeviceBiometrics,r.authenticatorName)||this}return V(r,o),r.prototype.evaluateLocalRegistrationStatus=function(i){var s=o.prototype.evaluateLocalRegistrationStatus.call(this,i);if(s!=e.AuthenticatorRegistrationStatus.Registered)return s;var a=i.user.localEnrollments[r.authenticatorName],u=n.AuthenticationDriverDeviceBiometrics.authenticatorKeyTagForUser(i.user,a.version,a.salt),c=i.sdk.host.getKeyPair(u,t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return c?(c.closeKeyPair(),e.AuthenticatorRegistrationStatus.Registered):e.AuthenticatorRegistrationStatus.LocallyInvalid},r.prototype.isSupportedOnDevice=function(e){var n=e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.DeviceBiometricsSupported);return!!n&&"false"!=n},r.authenticatorName="device_biometrics",r}(n.AuthenticationDriverDescriptorLocal);n.AuthenticationDriverDescriptorDeviceBiometrics=o}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){!function(e){var n=function(n){function o(){return n.call(this,e.AuthenticationDriverFace)||this}return V(o,n),o.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.ImageAcquitisionSupported)},o}(e.SimpleAuthenticationDriverDescriptor);e.AuthenticationDriverDescriptorFace=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.isSupportedOnDevice=function(e){return"true"===e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.Fido2ClientPresent)},n}(e.SimpleAuthenticationDriverDescriptor);e.AuthenticationDriverDescriptorFido2=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(n){var o=function(o){function r(){return o.call(this,n.AuthenticationDriverFingerprint,r.authenticatorName)||this}return V(r,o),r.prototype.evaluateLocalRegistrationStatus=function(i){var s=o.prototype.evaluateLocalRegistrationStatus.call(this,i);if(s!=e.AuthenticatorRegistrationStatus.Registered)return s;var a=i.user.localEnrollments[r.authenticatorName],u=n.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(i.user,a.version,a.salt),c=i.sdk.host.getKeyPair(u,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return c?(c.closeKeyPair(),e.AuthenticatorRegistrationStatus.Registered):e.AuthenticatorRegistrationStatus.LocallyInvalid},r.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.FingerprintSupported)},r.authenticatorName="fingerprint",r}(n.AuthenticationDriverDescriptorLocal);n.AuthenticationDriverDescriptorFingerprint=o}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){function t(t,e){this._targetIdentifier=t,this._description=e.describe(),this._deviceDetails=e}return t.prototype.getDescription=function(){return this._description},t.prototype.getDeviceIdentifier=function(){return this._targetIdentifier},t.prototype.getDeviceDetails=function(){return this._deviceDetails},t.__tarsusInterfaceName="MobileApproveTarget",t}();e.MobileApproveTargetImpl=n;var o=function(){function o(){}return o.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},o.prototype.isSupportedOnDevice=function(t){return!0},o.prototype.suggestParameters=function(e,n){return o.createTargetsFromConfig(e).map((function(e){return t.AuthenticationActionParameterTargetSelection.create(e)}))},o.prototype.createAuthenticationDriver=function(t,n,o){return new e.AuthenticationDriverMobileApprove(t,n,o)},o.createTargetsFromConfig=function(e){return e.selectable_devices.map((function(e,o){var r=t.TargetDeviceDetailsImpl.fromServerFormat(e);return new n(e.device_id,r)}))},o.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(t){return Promise.resolve(!0)},o}();e.AuthenticationDriverDescriptorMobileApprove=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(n){var o=function(o){function r(){return o.call(this,n.AuthenticationDriverNativeFace,r.authenticatorName)||this}return V(r,o),r.prototype.evaluateLocalRegistrationStatus=function(i){var s=o.prototype.evaluateLocalRegistrationStatus.call(this,i);if(s!=e.AuthenticatorRegistrationStatus.Registered)return s;var a=i.user.localEnrollments[r.authenticatorName],u=n.AuthenticationDriverNativeFace.authenticatorKeyTagForUser(i.user,a.version,a.salt),c=i.sdk.host.getKeyPair(u,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return c?(c.closeKeyPair(),e.AuthenticatorRegistrationStatus.Registered):e.AuthenticatorRegistrationStatus.LocallyInvalid},r.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported)},r.authenticatorName="face_id",r}(n.AuthenticationDriverDescriptorLocal);n.AuthenticationDriverDescriptorNativeFace=o}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(){function t(t,e,n,o,r,i){this._channelIndex=t,this._channelAssertionId=e,this._targetIdentifier=n,this._description=o,this._channel=r,this._deviceDetails=i}return t.prototype.getDescription=function(){return this._description},t.prototype.getChannel=function(){return this._channel},t.prototype.getTargetIdentifier=function(){return this._targetIdentifier},t.prototype.getChannelAssertionId=function(){return this._channelAssertionId},t.prototype.getChannelIndex=function(){return this._channelIndex},t.prototype.getDeviceDetails=function(){return this._deviceDetails},t.__tarsusInterfaceName="OtpTarget",t}();n.OtpTargetImpl=o;var r=function(){function r(){}return r.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},r.prototype.isSupportedOnDevice=function(t){return!0},r.prototype.suggestParameters=function(e,n){return this.createTargetsFromConfig(e).map((function(e){return t.AuthenticationActionParameterTargetSelection.create(e)}))},r.prototype.createAuthenticationDriver=function(t,e,o){var r=this.createTargetsFromConfig(e);return new n.AuthenticationDriverOtp(t,e,r,o)},r.prototype.createTargetsFromConfig=function(n){return n.channels.map((function(n){var r;switch(n.type){case e.Protocol.AuthenticationMethodOtpChannelType.Email:r=t.OtpChannel.Email;break;case e.Protocol.AuthenticationMethodOtpChannelType.Sms:r=t.OtpChannel.Sms;break;case e.Protocol.AuthenticationMethodOtpChannelType.Voice:r=t.OtpChannel.VoiceCall;break;case e.Protocol.AuthenticationMethodOtpChannelType.Push:r=t.OtpChannel.PushNotification;break;default:r=t.OtpChannel.Unknown}return!n.targets&&n.target&&(n.targets={},n.targets[0]=n.target),n.targets||(n.targets={}),Object.keys(n.targets).map((function(e,i){var s=n.targets[e];switch(r){case t.OtpChannel.PushNotification:var a=s,u=t.TargetDeviceDetailsImpl.fromServerFormat(a);return new o(i,n.assertion_id,e,u.describe(),r,u);default:var c=s;return new o(i,n.assertion_id,e,c,r,null)}}))})).reduce((function(t,e){return t.concat(e)}),[])},r.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(t){return Promise.resolve(!0)},r}();n.AuthenticationDriverDescriptorOtp=r}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){function t(t,e){this._targetIdentifier=t,this._description=e.describe(),this._deviceDetails=e}return t.prototype.getDescription=function(){return this._description},t.prototype.getDeviceIdentifier=function(){return this._targetIdentifier},t.prototype.getDeviceDetails=function(){return this._deviceDetails},t.__tarsusInterfaceName="TotpTarget",t}();e.TotpTargetImpl=n;var o=function(){function o(){}return o.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},o.prototype.isSupportedOnDevice=function(t){return!0},o.prototype.suggestParameters=function(e,n){return o.createTargetsFromConfig(e).map((function(e){return t.AuthenticationActionParameterTargetSelection.create(e)}))},o.prototype.createAuthenticationDriver=function(t,n,o){return new e.AuthenticationDriverTotp(t,n,o)},o.createTargetsFromConfig=function(e){var o=e;return o.selectable_devices?o.selectable_devices.map((function(e,o){var r=t.TargetDeviceDetailsImpl.fromServerFormat(e);return new n(e.device_id,r)})):[]},o.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(t){return Promise.resolve(!0)},o}();e.AuthenticationDriverDescriptorTotp=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){!function(e){var n=function(n){function o(){return n.call(this,e.AuthenticationDriverVoice)||this}return V(o,n),o.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.AudioAcquitisionSupported)},o}(e.SimpleAuthenticationDriverDescriptor);e.AuthenticationDriverDescriptorVoice=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e,n){return o.call(this,t,e,n)||this}return V(r,o),Object.defineProperty(r.prototype,"lastObtainedKeyPair",{get:function(){return this._lastObtainedKeyPair},set:function(t){this._lastObtainedKeyPair&&this._lastObtainedKeyPair!=t&&this._lastObtainedKeyPair.closeKeyPair(),this._lastObtainedKeyPair=t},enumerable:!1,configurable:!0}),r.prototype.completeAuthenticatorSessionWithResult=function(r){this.operationMode===t.AuthenticatorSessionMode.Registration&&r instanceof n.AuthenticationDriverSessionResultAuthenticationCompleted&&(!r.assertionResult.assertion_error_code||r.assertionResult.assertion_error_code===e.Protocol.AssertionErrorCode.AssertionContainerNotComplete)&&(this._enrollmentRecordToCommit?(this._sdk.log(t.LogLevel.Debug,(function(){return"Updating local enrollment record on registration"})),this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit)):this._sdk.log(t.LogLevel.Warning,(function(){return"No enrollment record to update."}))),this._enrollmentRecordToCommit=null,this.lastObtainedKeyPair=null,o.prototype.completeAuthenticatorSessionWithResult.call(this,r)},r.prototype.completeAuthenticatorSessionWithError=function(t){this.lastObtainedKeyPair=null,o.prototype.completeAuthenticatorSessionWithError.call(this,t)},r.prototype.registerInStartedSession=function(t){this._enrollmentRecordToCommit=null},r.prototype.calculateAssertionFieldsWithAuthenticatorKey=function(e){var n=this;return new Promise((function(o,r){var i=t.util.asciiToHex(n.localAuthenticatorChallenge());e.signHex(i).then((function(e){return{fch:t.util.hexToBase64(e)}})).then(o,r)}))},r.prototype.handleAuthenticationInputResponse=function(n){var o=this,r=this.user.localEnrollments[this.authenticatorType];r||this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"Missing key for "+this.authenticatorType+" authenticator")),this.getKeyForEnrollmentDataAndInput(r,n).then((function(i){return o._sdk.log(t.LogLevel.Debug,(function(){return"Local authenticator key obtained; signing challenge"})),o.addRolloverDataIfNeeded(i,r,n).then((function(n){return o._externalCancelled?Promise.reject(o._actionDriver._controlFlowProcessor.createExternalCancellationError()):(o.lastObtainedKeyPair=n.key,o.calculateAssertionFieldsWithAuthenticatorKey(n.key).then((function(i){var s={};if(n.rolloverKeyData){o._sdk.log(t.LogLevel.Info,(function(){return"Local authenticator rollover requested"}));var a={};n.rolloverKeyData.key&&(a.key=n.rolloverKeyData.key.publicKeyToJson(),a.version=n.rolloverKeyData.schemeVersion),n.rolloverReason&&(a.reason=n.rolloverReason),n.rolloverOldKeyHash&&(a.expired_key={hash:n.rolloverOldKeyHash}),s.rollover=a,o._enrollmentRecordToCommit=r.duplicate(),o._enrollmentRecordToCommit.status=e.LocalEnrollmentStatus.Registered,o._enrollmentRecordToCommit.validationStatus=e.LocalEnrollmentValidationStatus.Validated,o._enrollmentRecordToCommit.salt=n.rolloverKeyData.salt,o._enrollmentRecordToCommit.version=n.rolloverKeyData.schemeVersion,o._enrollmentRecordToCommit.keyMaterial=n.rolloverKeyData.keyMeterial,o._enrollmentRecordToCommit.cryptoSettings=o._sdk.cryptoSettings,o._enrollmentRecordToCommit.authenticatorConfig=n.rolloverKeyData.authenticatorConfig,o._enrollmentRecordToCommit.publicKeyHash=t.util.calcPublicKeyHexStringEncodedSha256Hash(n.rolloverKeyData.key,o._sdk)}o.processAuthenticateAssertion(s,i)}),(function(t){return Promise.reject(t)})))})).catch((function(e){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))})).catch((function(e){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},r.prototype.addRolloverDataIfNeeded=function(e,n,o){var r=this;if(this.rolloverNeeded(n)){var i=this.getRolloverReason(n);return this._sdk.log(t.LogLevel.Debug,(function(){return"AuthenticatorKeyRoll: "+i})),this.generatePendingEnrollment(o,!0).then((function(o){return e.rolloverKeyData=o,e.rolloverReason=i,n.publicKeyHash?e.rolloverOldKeyHash=n.publicKeyHash:e.rolloverOldKeyHash=t.util.calcPublicKeyHexStringEncodedSha256Hash(e.key,r._sdk),Promise.resolve(e)}))}return Promise.resolve(e)},r.prototype.getNewOrUpdatedEnrollmentRecord=function(n){var o=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Register "+o.authenticatorType+": fetching local enrollment record"}));var r=this.user.localEnrollments[this.authenticatorType],i=t.util.calcPublicKeyHexStringEncodedSha256Hash(n.key,this._sdk);return r||(this._sdk.log(t.LogLevel.Debug,(function(){return"Register "+o.authenticatorType+": Generating new local enrollment record"})),r=this.user.createEnrollmentRecord(this.authenticatorType,n.schemeVersion,n.salt,e.LocalEnrollmentStatus.Unregistered,i)),r.status=e.LocalEnrollmentStatus.Registered,r.validationStatus=e.LocalEnrollmentValidationStatus.Validated,r.salt=n.salt,r.version=n.schemeVersion,r.cryptoSettings=this._sdk.cryptoSettings,r.publicKeyHash=i,r.keyMaterial=n.keyMeterial,r.authenticatorConfig=n.authenticatorConfig,r},r.prototype.handleRegistrationInputResponse=function(e){var n=this;this._sdk.log(t.LogLevel.Debug,(function(){return"Register "+n.authenticatorType+": Generating pending enrollment data"})),this.generatePendingEnrollment(e).then((function(t){return n.handleRegisterAssertion(t)})).catch((function(e){n.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},r.prototype.handleRegisterAssertion=function(e){var n=this;return this._sdk.log(t.LogLevel.Debug,(function(){return"Register "+n.authenticatorType+": Signing registration assertion"})),this.calculateAssertionFieldsWithAuthenticatorKey(e.key).then((function(o){n._sdk.log(t.LogLevel.Debug,(function(){return"Register "+n.authenticatorType+": Preparing registration assertion"}));var r=n.getNewOrUpdatedEnrollmentRecord(e);if(n._enrollmentRecordToCommit=r,n._externalCancelled)return Promise.reject(n._actionDriver._controlFlowProcessor.createExternalCancellationError());n.lastObtainedKeyPair=e.key;var i=G({public_key:e.key.publicKeyToJson(),version:e.schemeVersion},o);n.processRegisterAssertion(null,i)}),(function(t){return Promise.reject(t)}))},r.prototype.handleRegisterAssertionResult=function(t){return t.data&&t.data.update_vaults&&e.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,t.data.update_vaults,this._uiHandler,this._sdk),o.prototype.handleRegisterAssertionResult.call(this,t)},r.prototype.handleUnregistrationAssertionResult=function(n){var r=this,i=this.user.localEnrollments[this.authenticatorType];i?(i.status=e.LocalEnrollmentStatus.Unregistered,this.user.updateEnrollmentRecord(i),this.unregisterEnrollmentAssets(i)):this._sdk.log(t.LogLevel.Warning,(function(){return"Failed to find enrollment record for "+r.authenticatorType})),n.data&&n.data.update_vaults&&e.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,n.data.update_vaults,this._uiHandler,this._sdk),o.prototype.handleUnregistrationAssertionResult.call(this,n)},r.prototype.handleAuthenticateAssertionResult=function(n,r,i,s,a){if(this._enrollmentRecordToCommit)if(n.assertion_error_code){if(n.assertion_error_code==e.Protocol.AssertionErrorCode.AckRequired)return this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit),n.data&&n.data.update_vaults&&e.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,n.data.update_vaults,this._uiHandler,this._sdk),this.processRolloverAckAssertionRequest(this._enrollmentRecordToCommit.publicKeyHash,a),this._enrollmentRecordToCommit=null,!0}else this._sdk.log(t.LogLevel.Debug,(function(){return"Pending commit for enrollment; checking rollover status."})),n.data&&n.data.rollover&&0==n.data.rollover.code?(this._sdk.log(t.LogLevel.Info,(function(){return"Updating local enrollment record on authentication result"})),this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit)):this._sdk.log(t.LogLevel.Error,(function(){return"Received a rollover failure response from the server; aboting rollover."}));return this._enrollmentRecordToCommit=null,o.prototype.handleAuthenticateAssertionResult.call(this,n,r,i,s,a)},r.prototype.processRolloverAckAssertionRequest=function(e,n){this._sdk.log(t.LogLevel.Info,(function(){return"AuthenticatorKeyRollover: Processing ack assertion request..."}));var o={};if(n&&n.fch){o={fch:n.fch};var r={rollover_ack:{hash:e}};this.processAuthenticateAssertion(r,o)}else this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid assertion fields - missing fch"))},r.prototype.processLocalAuthenticatorError=function(t){this.performErrorRecoveryForError(t)},r.prototype.localAuthenticatorChallenge=function(){return this._actionDriver._controlFlowProcessor.challenge+this._authenticatorDescription.assertionId},r.prototype.getAuthenticatorEnrollmentConfig=function(){return null},r.prototype.onCancelRun=function(){o.prototype.onCancelRun.call(this),this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null)},r.prototype.shouldAllowBiometricFallbackButton=function(n){var o=this;if(!n)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter((function(t){return t!=o._authenticatorDescription}));if(this._actionDriver instanceof e.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof e.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var i=n,s=i.getFallbackButtonTitle();if(!(s&&s.length>0))return!1;var a=i.getFallbackControlRequestType();switch(null==a&&(a=t.ControlRequestType.SelectMethod),a){case t.ControlRequestType.ChangeMethod:case t.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticators.length>1;default:return!0}},r.prototype.publicKeyExpired=function(e){var n=this;if(!this._authenticatorConfig.public_key_expired)return!1;var o=e===this._authenticatorConfig.public_key_expired.hash;return this._sdk.log(t.LogLevel.Debug,(function(){return"AuthenticatorKeyRoll: authenticator "+n.authenticatorType+" \n                                                key hash matching expired key hash received from server: "+o})),o},r.prototype.getRolloverReason=function(t){return this.publicKeyExpired(t.publicKeyHash)?"Rollover of "+this.authenticatorType+" authenticator public key due to expiration":"Upgrading "+this.authenticatorType+" authenticator scheme from "+t.version+" to "+this.currentScheme},r.prototype.rolloverNeeded=function(t){return this.publicKeyExpired(t.publicKeyHash)||this.schemeVersionRequiresRollover(t.version)},r}(n.AuthenticationDriver);n.AuthenticationDriverLocal=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){t.instanceOfAuthenticationDriverSilentRegistrationSupport=function(t){return t.runSilentRegistration}}(t.authenticationdrivers||(t.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){!function(n){!function(n){var o=function(o){function r(){return null!==o&&o.apply(this,arguments)||this}return V(r,o),r.prototype.unregisterEnrollmentAssets=function(t){var e=this.authenticatorKeyTagForScheme(t.version,t.salt);this._sdk.host.deleteKeyPair(e)},r.prototype.invokeCancellationUiOrEscape=function(){var o=this._actionDriver._policyAction.getEscapeOptions().filter((function(e){return e.getPresentation()==t.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel}))[0];if(o){this._sdk.log(e.LogLevel.Debug,(function(){return"Got cancel escape option; responding with that."}));var r=new e.ActionEscapeRequest;r._escapeOption=o,r._escapeParameters=null,this.completeAuthenticatorSessionWithResult(new n.AuthenticationDriverSessionResultEscapeRequested(r))}else this._sdk.log(e.LogLevel.Debug,(function(){return"Invoking UI cancellation handler."})),this.invokeUiHandlerCancellation()},r}(n.AuthenticationDriverLocal);n.AuthenticationDriverLocalPersistentKeyPairBased=o}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.schemeVersionRequiresRollover=function(e){return"v0"==e||"v1"==e||"v2"==e&&"true"!=this._sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.StdSigningKeyIsHardwareProtectedSignAndEncryptKey)},n}(e.AuthenticationDriverLocalPersistentKeyPairBased);e.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){function e(){}return e.deviceBiometricInput=function(t,n){var o=e.newBiometricPromptInfo();return o.setLocalizedTitle(t.getTitle()),o.setLocalizedSubtitle(t.getSubtitle()),o.setLocalizedPrompt(t.getPrompt()),o.setCancelButtonTitle(t.getCancelButtonTitle()),n&&void 0!==n.require_confirmation?o.setRequireConfirmation(n.require_confirmation):o.setRequireConfirmation(!0),o},e.fingerprintInput=function(t){var n=e.newBiometricPromptInfo();n.setLocalizedPrompt(t.getPrompt());var o=t.getCancelButtonTitle();o&&0<o.length&&n.setCancelButtonTitle(o);var r=t.getFallbackButtonTitle();return r&&0<r.length&&n.setFallbackButtonTitle(r),n},e.nativeFaceInput=function(t){var n=e.newBiometricPromptInfo();n.setLocalizedPrompt(t.getPrompt());var o=t.getCancelButtonTitle();o&&0<o.length&&n.setCancelButtonTitle(o);var r=t.getFallbackButtonTitle();return r&&0<r.length&&n.setFallbackButtonTitle(r),n},e.newBiometricPromptInfo=function(){var e=new t.sdkhost.BiometricPromptInfo;return e.setCancelButtonTitle(null),e.setFallbackButtonTitle(null),e.setLocalizedPrompt(null),e.setLocalizedSubtitle(null),e.setLocalizedTitle(null),e},e}();e.BiometricPromptInfoFrom=n}(e.util||(e.util={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(r){function i(t,e,n){return r.call(this,t,e,n)||this}return V(i,r),i.authenticatorKeySchemeForMigratedEnrollment=function(t){if(0===t.indexOf("v0")){var e=t.split("_");return 1<e.length?e[1]:"v3"}return null},i.authenticatorKeyTagForUserForMigratedEnrollment=function(t,e,n){var r=i.authenticatorKeySchemeForMigratedEnrollment(e);return r?o.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(t,r,n):null},i.authenticatorKeyTagForUser=function(t,e,r){return i.authenticatorKeyTagForUserForMigratedEnrollment(t,e,r)||new n.TarsusKeyPath("per_user",t.guid.toString(),"local_auth_keys",o.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,e,r)},i.prototype.schemeVersionRequiresRollover=function(t){var e=i.authenticatorKeySchemeForMigratedEnrollment(t);return!(!e||!r.prototype.schemeVersionRequiresRollover.call(this,e))},Object.defineProperty(i.prototype,"signChallengeMode",{get:function(){var e=this._sdk.host.queryHostInfo(t.sdkhost.HostInformationKey.DeviceBiometricsUsesSign);return!!e&&"true"==e},enumerable:!1,configurable:!0}),i.prototype.runSilentRegistration=function(){var t=this;return this.generateAuthenticatorKey().then((function(n){var r=t.getNewOrUpdatedEnrollmentRecord(n),i={public_key:n.key.publicKeyToJson(),encrypted_challenge_mode:!t.signChallengeMode,version:n.schemeVersion};return t._actionDriver.sendAuthenticatorAssertionRequest(t._authenticatorDescription,"register",null,i).then((function(n){if(n.assertion_error_code)throw e.impl.AuthenticationErrorImpl.errorForAssertionResponse(n);return t.user.updateEnrollmentRecord(r),new o.AuthenticationDriverSessionResultAuthenticationCompleted(n)}))}))},i.prototype.createAuthenticatorSession=function(){return this._sdk.log(e.LogLevel.Debug,(function(){return"Create DSA session."})),this._uiHandler.createDeviceBiometricsAuthSession(o.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,this.user.displayName)},i.prototype.authenticateInStartedSession=function(t){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.registerInStartedSession=function(t){var n=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Register DSA in started session."})),r.prototype.registerInStartedSession.call(this,t),this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.handleRegistrationInputResponse=function(t){var n=this;this._sdk.log(e.LogLevel.Debug,(function(){return"Register "+n.authenticatorType+": Generating pending enrollment data"})),this.getNewPendingEnrollmentOrReuse(t).then((function(t){return n._pendingEnrollmentData=t,n.handleRegisterAssertion(t)})).catch((function(t){n.processLocalAuthenticatorError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},Object.defineProperty(i.prototype,"authenticatorType",{get:function(){return o.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentScheme",{get:function(){return"v1"},enumerable:!1,configurable:!0}),i.prototype.processLocalAuthenticatorError=function(o){var r=this,i=o,s=0,a=Promise.resolve();if(i.getErrorCode()==e.AuthenticationErrorCode.Internal&&i.getData()){var u=i.getData();s=u[t.sdkhost.ErrorDataNumFailures]||0,i=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(u,"Biometrics")||i,(u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricInvalidated||u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered())&&(this._sdk.log(e.LogLevel.Debug,(function(){return"Biometric invalidated "+u[t.sdkhost.ErrorDataInternalError]})),a=n.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}a.catch((function(t){r._sdk.log(e.LogLevel.Error,t)})),a.finally((function(){if(i.getErrorCode()==e.AuthenticationErrorCode.UserCanceled)return r._sdk.log(e.LogLevel.Debug,(function(){return"Device biometrics captured user cancel error code."})),void r.invokeCancellationUiOrEscape();s&&r._operationMode==e.AuthenticatorSessionMode.Authentication?r.processAuthFailureAssertionAndHandleError(i,s):r.performErrorRecoveryForError(i)}))},i.prototype.performErrorRecoveryForError=function(t,n){this.recoveryOptionsForError(t,n).indexOf(e.AuthenticationErrorRecovery.RetryAuthenticator)<0&&(this.lastObtainedKeyPair=null),r.prototype.performErrorRecoveryForError.call(this,t,n)},i.prototype.getKeyForEnrollmentDataAndInput=function(n,o){var r=this;return new Promise((function(i,s){var a,u=o,c=r.authenticatorKeyTagForScheme(n.version,n.salt);if(!(a=r.lastObtainedKeyPair&&r.lastObtainedKeyPair.getTag()===c.toString()?r.lastObtainedKeyPair:r._sdk.host.getKeyPair(c,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb))){var l={};throw l[t.sdkhost.ErrorDataInternalError]=t.sdkhost.InternalErrorBiometricInvalidated,new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated  biometrics.",l)}a.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.deviceBiometricInput(u,r._authenticatorConfig),null,null),i({key:a})}))},i.prototype.getNewPendingEnrollmentOrReuse=function(t,e){return this._pendingEnrollmentData?Promise.resolve(this._pendingEnrollmentData):this.generatePendingEnrollment(t,e)},i.prototype.generatePendingEnrollment=function(t,n){var o=this;return this.generateAuthenticatorKey().then((function(r){if(!n){var i=t;r.key.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.deviceBiometricInput(i,o._authenticatorConfig),null,null)}return r}))},i.prototype.generateAuthenticatorKey=function(){var n,o=this;n=this._sdk.host.generateRandomHexString(24);var r=this.authenticatorKeyTagForScheme(this.currentScheme,n);return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then((function(t){return{key:t,salt:n,schemeVersion:o.currentScheme}}),(function(t){if(t.getErrorCode()==e.AuthenticationErrorCode.Internal&&t.getData()){var n=t.getData(),o=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(n,"Biometrics");if(o)throw o}throw t})))},i.prototype.calculateAssertionFieldsWithAuthenticatorKey=function(t){var n=this._authenticatorConfig;if(!this.signChallengeMode){if(this.operationMode==e.AuthenticatorSessionMode.Registration)return t.decrypt("").then((function(){return{data:{encrypted_challenge_mode:!0}}}));var o=n&&n.encrypted_challenge;return o?new Promise((function(n,r){var i=e.util.base64ToHex(o);t.decrypt(i).then((function(t){return{fch:e.util.hexToBase64(t)}})).then(n,r)})):Promise.reject(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Invalid server response for decrypt-mode authenticator. Missing encrypted challenge."))}return r.prototype.calculateAssertionFieldsWithAuthenticatorKey.call(this,t)},i.prototype.authenticatorKeyTagForScheme=function(t,e){return i.authenticatorKeyTagForUser(this.user,t,e)},i.prototype.completeAuthenticatorSessionWithResult=function(t){this._pendingEnrollmentData=null,r.prototype.completeAuthenticatorSessionWithResult.call(this,t)},i.prototype.completeAuthenticatorSessionWithError=function(t){this._pendingEnrollmentData=null,r.prototype.completeAuthenticatorSessionWithError.call(this,t)},i}(o.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme);o.AuthenticationDriverDeviceBiometrics=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o){return n.call(this,t,e,o)||this}return V(o,n),o.prototype.getMaxStep=function(){return-1},o.prototype.authenticateInStartedSession=function(t){t||this.initializeFirstStep(),this.pumpStep()},o.prototype.registerInStartedSession=function(t){t||this.initializeFirstStep(),this.pumpStep()},o.prototype.pumpStep=function(){var e=this,n=this._inputSession;n.setInputStep(this._currentStepIndex,this.getMaxStep(),this._currentStep),n.promiseInput().then((function(t){return e.handleInputOrControlResponse(t)}),(function(n){return e.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(n))}))},o.prototype.handleAuthenticateAssertionResult=function(t,e,o,r,i){return!!this.handleStepManagementAssertionResult(t)||n.prototype.handleAuthenticateAssertionResult.call(this,t,e,o,r,i)},o.prototype.handleRegisterAssertionResult=function(t){return!!this.handleStepManagementAssertionResult(t)||n.prototype.handleRegisterAssertionResult.call(this,t)},o.prototype.handleStepManagementAssertionResult=function(t){if(t.assertion_error_code==e.Protocol.AssertionErrorCode.NotFinished){var n=this.prepareNextAuthenticationStep(t);return n!=this._currentStep&&(this._currentStep=n,this._currentStepIndex++),this.pumpStep(),!0}return t.assertion_error_code==e.Protocol.AssertionErrorCode.RepeatCurrentStep&&(this._currentStep=this.updateCurrentAuthenticationStep(t,this._currentStep),this.pumpStep(),!0)},o.prototype.initializeFirstStep=function(){this._currentStep=this.createInitialInputStep(),this._currentStepIndex=0},o}(n.AuthenticationDriver);n.AuthenticationDriverMultiStep=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createFaceAuthSession("face",this.user.displayName)},n.prototype.createInitialInputStep=function(){var e=this._authenticatorConfig;return new t.impl.CameraAcquisitionStepDescriptionImpl(e.acquisition_challenges)},n.prototype.prepareNextAuthenticationStep=function(t){return this.createInitialInputStep()},n.prototype.updateCurrentAuthenticationStep=function(t,e){return e},n.prototype.handleAuthenticationInputResponse=function(t){var e=t;this.processAuthenticateAssertion(e.getAcquisitionResponse())},n.prototype.handleRegistrationInputResponse=function(t){var e=t;this.processRegisterAssertion(e.getAcquisitionResponse())},n}(e.AuthenticationDriverMultiStep);e.AuthenticationDriverFace=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){var n,o;o=e.sdk||(e.sdk={}),function(r){var i=function(){function r(t,e,n,o,r,i){this.cancellationDOMErrorNames=["NotAllowedError","AbortError"],this.sdk=t,this.username=e,this.uiHandler=n,this.clientContext=o,this.actionContext=r,this.config=i,this.config.require_display_name_from_user&&(this.hostUiAuthenticatorSession=this.uiHandler.createFido2AuthSession("fido2",e))}return r.prototype.startSession=function(t,e,n,r){this.description=t,this.mode=e,this.actionContext=n,this.clientContext=r,this.hostUiAuthenticatorSession&&(this.mode==o.AuthenticatorSessionMode.Registration?this.hostUiAuthenticatorSession.startSession(t,e,n,r):(this.hostUiAuthenticatorSession.endSession(),delete this.hostUiAuthenticatorSession))},r.prototype.changeSessionModeToRegistrationAfterExpiration=function(){this.mode=t.ts.mobile.sdk.AuthenticatorSessionMode.Registration,this.hostUiAuthenticatorSession&&this.hostUiAuthenticatorSession.changeSessionModeToRegistrationAfterExpiration()},r.prototype.promiseRecoveryForError=function(t,e,n){return this.hostUiAuthenticatorSession?this.hostUiAuthenticatorSession.promiseRecoveryForError(t,e,n):Promise.resolve(o.AuthenticationErrorRecovery.Fail)},r.prototype.promiseInput=function(){return this.hostUiAuthenticatorSession?this.hostUiAuthenticatorSession.promiseInput():this.performFido2CredentialsOp()},r.prototype.endSession=function(){this.hostUiAuthenticatorSession&&(this.hostUiAuthenticatorSession.endSession(),delete this.hostUiAuthenticatorSession)},r.prototype.performFido2CredentialsOp=function(r){var i,s,a=this;return this.mode===t.ts.mobile.sdk.AuthenticatorSessionMode.Authentication?(i=this.config.credentialRequestOptions,s=e.sdkhost.Fido2CredentialsOpType.Get):(i=this.config.credentialCreationOptions,r&&(i=this.enrichOptionsWithDisplayName(i,r)),s=e.sdkhost.Fido2CredentialsOpType.Create),this.sdk.host.fido2CredentialsOp(this.uiHandler,this.clientContext,this.actionContext,s,i).then((function(t){return o.InputOrControlResponse.createInputResponse(n.Fido2InputResponseInternal.createSuccessResponse(t))})).catch((function(e){var r=t.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(e);if(r.getErrorCode()===o.AuthenticationErrorCode.UserCanceled){a.sdk.log(o.LogLevel.Debug,(function(){return"Received FIDO2 cancellation request."}));var i=a.actionContext.getEscapeOptions().filter((function(e){return e.getPresentation()==t.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel}))[0];return i?(a.sdk.log(o.LogLevel.Debug,(function(){return"Got cancel escape option; responding with that."})),o.InputOrControlResponse.createEscapeResponse(i,null)):(a.sdk.log(o.LogLevel.Debug,(function(){return"Responding with auth cancel control request."})),o.InputOrControlResponse.createControlResponse(o.ControlRequest.create(o.ControlRequestType.CancelAuthenticator)))}return a.sdk.log(o.LogLevel.Debug,(function(){return"Received FIDO2 error response from client: "+r})),o.InputOrControlResponse.createInputResponse(n.Fido2InputResponseInternal.createdFailedResponse(r))}))},r.prototype.enrichOptionsWithDisplayName=function(t,e){return t.publicKey.user.displayName=e,t},r}();r.Fido2AuthenticatorSessionInternal=i;var s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return V(r,t),r.prototype.createAuthenticatorSession=function(){if("true"===this._sdk.host.queryHostInfo(e.sdkhost.HostInformationKey.Fido2ClientPresent))return new i(this._sdk,this.user.displayName,this._uiHandler,this._clientContext,this._actionDriver.policyAction(),this._authenticatorConfig);throw new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.AuthenticatorExternalConfigError,"Can't find FIDO2 client to handle FIDO2 authentication.")},r.prototype.authenticateInStartedSession=function(t){var e=this;this._inputSession.promiseInput().then((function(t){return e.handleInputOrControlResponse(t)}),(function(t){return e.completeAuthenticatorSessionWithError(o.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},r.prototype.handleAuthenticationInputResponse=function(t){if(t instanceof n.Fido2AuthenticatorSuccessResponse){this._sdk.log(o.LogLevel.Debug,(function(){return"Fido2 received Fido2AuthenticatorSuccessResponse."}));var e=t.getFido2Response();this.processAuthenticateAssertion({assertion_credential:{id:e.id,response:{authenticatorData:e.response.authenticatorData,clientDataJSON:e.response.clientDataJSON,signature:e.response.signature,userHandle:e.response.userHandle},type:e.type,clientExtensionResults:e.clientExtensionResults}})}else t instanceof n.Fido2AuthenticationFailedResponse?(this._sdk.log(o.LogLevel.Debug,(function(){return"Fido2 received Fido2AuthenticationFailedResponse."})),this.handleFido2FailureResponse(t)):(this._sdk.log(o.LogLevel.Error,(function(){return"Fido2 received unknkown response type."})),this.performErrorRecoveryForError(new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.AppImplementation,"Fido2 received unknkown response type.")))},r.prototype.registerInStartedSession=function(t){var e=this;this._inputSession.promiseInput().then((function(t){return e.handleInputOrControlResponse(t)}),(function(t){return e.completeAuthenticatorSessionWithError(o.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},r.prototype.handleRegistrationInputResponse=function(t){var e=this;if(t instanceof o.Fido2InputResponse){var r=t.getDisplayName();this._sdk.log(o.LogLevel.Debug,(function(){return"Fido2 received authenticator display name: "+r})),this.validateDisplayNameFormat(r)?(this._displayName=r,this._inputSession.performFido2CredentialsOp(r).then((function(t){return e.handleInputOrControlResponse(t)}),(function(t){return e.completeAuthenticatorSessionWithError(o.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))):this.performErrorRecoveryForError(new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.InvalidInput,"Display name can't be empty"))}else if(t instanceof n.Fido2AuthenticatorSuccessResponse){this._sdk.log(o.LogLevel.Debug,(function(){return"Fido2 received Fido2AuthenticatorSuccessResponse."}));var i=t.getFido2Response();(!this._displayName||this._displayName.length<=0)&&(this._displayName=this._authenticatorConfig.credentialCreationOptions.publicKey.user.displayName),this.processRegisterAssertion({attestation_credential:{id:i.id,response:{attestationObject:i.response.attestationObject,clientDataJSON:i.response.clientDataJSON,transports:i.response.transports},type:i.type,clientExtensionResults:i.clientExtensionResults},display_name:this._displayName})}else t instanceof n.Fido2AuthenticationFailedResponse?(this._sdk.log(o.LogLevel.Debug,(function(){return"Fido2 received Fido2AuthenticationFailedResponse."})),this.handleFido2FailureResponse(t)):(this._sdk.log(o.LogLevel.Error,(function(){return"Fido2 received unknkown response type."})),this.performErrorRecoveryForError(new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.AppImplementation,"Fido2 received unknkown response type.")))},r.prototype.handleFido2FailureResponse=function(t){this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",{num_of_failures:1}),this.performErrorRecoveryForError(t.getFailureError())},r.prototype.handleAuthenticateAssertionResult=function(e,r,i,s,a){if(e.assertion_error_code&&e.assertion_error_code==n.Protocol.AssertionErrorCode.FailedAssertion&&e.data)switch(e.data.reason){case n.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonAttestationReverificationFailed:this._sdk.log(o.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() for FIDO2 that failed attestation reverification"}));var u=new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.AuthenticatorError,e.assertion_error_message||"FIDO2 credential failed attestation reverification");return u.setPublicProperty(o.AuthenticationErrorProperty.AuthenticationErrorReason,o.AuthenticationErrorPropertySymbol.AuthenticationErrorReasonAttestationReverificationFailed),this.performErrorRecoveryForError(u),!0;case n.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonCredentialFiltered:return this._sdk.log(o.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() for FIDO2 with filtered credential"})),this.handleCredentialFiltered(e)}return t.prototype.handleAuthenticateAssertionResult.call(this,e,r,i,s,a)},r.prototype.handleRegisterAssertionResult=function(e){if(e.assertion_error_code&&e.assertion_error_code==n.Protocol.AssertionErrorCode.Internal&&e.data)switch(e.data.reason){case n.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonCredentialFiltered:return this._sdk.log(o.LogLevel.Debug,(function(){return"handleRegisterAssertionResult() for FIDO2 with filtered credential"})),this.handleCredentialFiltered(e)}return t.prototype.handleRegisterAssertionResult.call(this,e)},r.prototype.handleCredentialFiltered=function(t){var e=new o.impl.AuthenticationErrorImpl(o.AuthenticationErrorCode.AuthenticatorError,t.assertion_error_message||"FIDO2 with filtered credential");return e.setPublicProperty(o.AuthenticationErrorProperty.AuthenticationErrorReason,o.AuthenticationErrorPropertySymbol.AuthenticationErrorReasonCredentialFiltered),this.performErrorRecoveryForError(e),!0},r.prototype.validateDisplayNameFormat=function(t){return!(!t||t.length<=0)},r}(r.AuthenticationDriver);r.AuthenticationDriverFido2=s}((n=o.core||(o.core={})).authenticationdrivers||(n.authenticationdrivers={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){o.AUTHENTICATION_DRIVER_FINGERPRINT_CURRENT_SCHEME="v3";var r=function(r){function i(t,e,n){return r.call(this,t,e,n)||this}return V(i,r),i.prototype.getBiometricPromptFallbackControlType=function(){return null!=this._biometricPromptFallbackControlType?this._biometricPromptFallbackControlType:e.ControlRequestType.SelectMethod},i.authenticatorKeyTagForUser=function(t,e,r){return new n.TarsusKeyPath("per_user",t.guid.toString(),"local_auth_keys",o.AuthenticationDriverDescriptorFingerprint.authenticatorName,e,r)},i.prototype.shouldAllowBiometricFallbackButton=function(t){var o=this;if(!t)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter((function(t){return t!=o._authenticatorDescription}));if(this._actionDriver instanceof n.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof n.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var i=t,s=i.getFallbackButtonTitle();if(!(s&&s.length>0))return!1;var a=i.getFallbackControlRequestType();switch(null==a&&(a=e.ControlRequestType.SelectMethod),a){case e.ControlRequestType.ChangeMethod:return this._actionDriver.availableAuthenticatorsForSwitching.filter((function(t){return t!=o._authenticatorDescription})).length>0;case e.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticatorsForSwitching.length>0;default:return!0}},i.prototype.runSilentRegistration=function(){var t=this;return this.generateAuthenticatorKey().then((function(n){var r=t.getNewOrUpdatedEnrollmentRecord(n),i={public_key:n.key.publicKeyToJson(),version:n.schemeVersion};return t._actionDriver.sendAuthenticatorAssertionRequest(t._authenticatorDescription,"register",null,i).then((function(n){if(n.assertion_error_code)throw e.impl.AuthenticationErrorImpl.errorForAssertionResponse(n);return t.user.updateEnrollmentRecord(r),new o.AuthenticationDriverSessionResultAuthenticationCompleted(n)}))}))},i.prototype.createAuthenticatorSession=function(){return this._uiHandler.createFingerprintAuthSession(o.AuthenticationDriverDescriptorFingerprint.authenticatorName,this.user.displayName)},i.prototype.authenticateInStartedSession=function(t){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.registerInStartedSession=function(t){var n=this;r.prototype.registerInStartedSession.call(this,t),this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},Object.defineProperty(i.prototype,"authenticatorType",{get:function(){return o.AuthenticationDriverDescriptorFingerprint.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentScheme",{get:function(){return o.AUTHENTICATION_DRIVER_FINGERPRINT_CURRENT_SCHEME},enumerable:!1,configurable:!0}),i.prototype.processLocalAuthenticatorError=function(o){var r=this,i=o,s=0,a=Promise.resolve();if(i.getErrorCode()==e.AuthenticationErrorCode.Internal&&i.getData()){var u=i.getData();s=u[t.sdkhost.ErrorDataNumFailures]||s,i=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(u,"Fingerprint")||i,(u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricInvalidated)&&(a=n.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}a.catch((function(t){r._sdk.log(e.LogLevel.Error,t)})),a.finally((function(){var n=i.getData();if(!s||r._operationMode!=e.AuthenticatorSessionMode.Authentication)return n[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricFallbackPressed?(r._sdk.log(e.LogLevel.Debug,(function(){return"Biometric prompt fallback button pressed"})),void r.processControlRequest(e.ControlRequest.create(r.getBiometricPromptFallbackControlType()))):i.getErrorCode()==e.AuthenticationErrorCode.UserCanceled?(r._sdk.log(e.LogLevel.Debug,(function(){return"Fingerprint authenticator captured user cancel error code."})),void r.invokeCancellationUiOrEscape()):void r.performErrorRecoveryForError(i);r.processAuthFailureAssertionAndHandleError(i,s)}))},i.prototype.getKeyForEnrollmentDataAndInput=function(n,o){var r=this;return new Promise((function(i,s){var a=o;r.shouldAllowBiometricFallbackButton(a)&&(r._biometricPromptFallbackControlType=a.getFallbackControlRequestType());var u=r.authenticatorKeyTagForScheme(n.version,n.salt),c=r._sdk.host.getKeyPair(u,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!c){var l={};throw l[t.sdkhost.ErrorDataInternalError]=t.sdkhost.InternalErrorBiometricInvalidated,new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated Fingerprint.",l)}c.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.fingerprintInput(a),r._uiHandler,r._inputSession),i({key:c})}))},i.prototype.generatePendingEnrollment=function(t,n){var o=this;return this.generateAuthenticatorKey().then((function(r){if(!n){var i=t;o.shouldAllowBiometricFallbackButton(i)&&(o._biometricPromptFallbackControlType=i.getFallbackControlRequestType()),r.key.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.fingerprintInput(i),o._uiHandler,o._inputSession)}return r}))},i.prototype.generateAuthenticatorKey=function(){var n,o=this;n=this._sdk.host.generateRandomHexString(24);t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey;var r=this.authenticatorKeyTagForScheme(this.currentScheme,n);return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then((function(t){return{key:t,salt:n,schemeVersion:o.currentScheme}}),(function(t){if(t.getErrorCode()==e.AuthenticationErrorCode.Internal&&t.getData()){var n=t.getData(),o=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(n,"Fingerprint");if(o)throw o}throw t})))},i.prototype.authenticatorKeyTagForScheme=function(t,e){return i.authenticatorKeyTagForUser(this.user,t,e)},i}(o.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme);o.AuthenticationDriverFingerprint=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e;(function(t){function e(t){for(var e=[],n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e.push(o):o<2048?e.push(192|o>>6,128|63&o):o<55296||o>=57344?e.push(224|o>>12,128|o>>6&63,128|63&o):(n++,o=65536+((1023&o)<<10|1023&t.charCodeAt(n)),e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o))}return e}function n(t){var e,n="";for(e=0;e<t.length;e++){var o=t[e];if(o<128)n+=String.fromCharCode(o);else if(o>191&&o<224)n+=String.fromCharCode((31&o)<<6|63&t[e+1]),e+=1;else if(o>223&&o<240)n+=String.fromCharCode((15&o)<<12|(63&t[e+1])<<6|63&t[e+2]),e+=2;else{var r=((7&o)<<18|(63&t[e+1])<<12|(63&t[e+2])<<6|63&t[e+3])-65536;n+=String.fromCharCode(r>>10|55296,1023&r|56320),e+=3}}return n}function o(t){for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n).toString(16);o.length<2&&(o="0"+o),e+=o}return e}t.numberToHex=function(t,e){var n=t.toString(16);if(n.length>e/4)throw"Number out of range for bitcount.";for(;n.length<e/4;)n="0"+n;return n},t.toUTF8Array=e,t.fromUTF8Array=n,t.hexToAscii=function(t){for(var e=[],o=0;o<t.length;o+=2)e.push(parseInt(t.substr(o,2),16));return n(e)},t.asciiToHex=function(t){return e(t).map((function(t){var e=t.toString(16);return e.length<2&&(e="0"+e),e})).join("")},t.base64ToHex=function(t){return o(atob(t))},t.bytesToHex=o,t.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},t.hexToBase64=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=0,r="",i=0;i<t.length;i++)n=(n<<4)+parseInt(t[i],16),(o+=4)>=6&&(r+=e[n>>o-6],n&=255>>8-(o-=6));for(o&&(r+=e[n<<6-o]);r.length%4;)r+="=";return r},t.isHexString=function(t){return new RegExp("^([0-9A-Fa-f]{2})+$").test(t)},t.stringToBytes=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t.charCodeAt(n));return e},t.calcPublicKeyHexStringEncodedSha256Hash=function(e,n){var o=e.publicKeyToJson().key;return sha256(t.stringToBytes(atob(o)))},t.nameof=function(t){return t},t.checkedCast=function(t,e){if(e instanceof t)return e;throw Error("Checked cast failed. Expected "+t)},t.wrapPromiseWithActivityIndicator=function(t,e,n,o){return t.startActivityIndicator(e,n),o.then((function(o){return t.endActivityIndicator(e,n),o}),(function(o){return t.endActivityIndicator(e,n),Promise.reject(o)}))};var r=function(){function t(){var e=this;this._cancelPromise=new Promise((function(n,o){e._cancelFn=function(){o(t.CancelRequest)},e._cancelled&&o(t.CancelRequest)}))}return Object.defineProperty(t.prototype,"cancellablePromise",{get:function(){return this._cancellablePromise},enumerable:!1,configurable:!0}),t.prototype.resolveWith=function(t){this._cancelled?this._cancellablePromise=this._cancelPromise:(this._underlyingPromise=new Promise(t),this._cancellablePromise=Promise.race([this._cancelPromise,this._underlyingPromise]))},t.prototype.cancel=function(){this._cancelled=!0,this._cancelFn&&this._cancelFn()},t.CancelRequest={},t}();t.CancelablePromiseHolder=r,t.LANGUAGES={"zh-HK":"zh-HK","zh-CN":"zh-Hans","zh-TW":"zh-Hant",zh:"zh-Hans",da:"da-DK",nl:"nl-NL","en-AU":"en-AU","en-GB":"en-GB",en:"en-US","en-IN":"en-IN",fi:"fi-FI",fr:"fr-FR","fr-CA":"fr-CA",de:"de-DE",it:"it-IT",is:"is-IS",ja:"ja-JP",ko:"ko-KR",nb:"nb-NO",pl:"pl-PL","pt-BR":"pt-BR",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU","es-MX":"es-MX",es:"es-ES",ca:"ca-ES","es-US":"es-US",sv:"sv-SE",tr:"tr-TR",vi:"vi-VN",el:"el-GR",id:"id-ID",hu:"hu-HU",th:"th-TH",hi:"hi-IN",cs:"cs-CZ",sk:"sk-SK",uk:"uk-UA",hr:"hr-CS",he:"he-IL",iw:"he-IL",ar:"ar-SA"}})((e=t.sdk||(t.sdk={})).util||(e.util={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e,n){return o.call(this,t,e,n)||this}return V(r,o),r.enrollmentVersion2KeyGenVersion=function(t){return t>="v3"?"s2":"s1"},r.prototype.unregisterEnrollmentAssets=function(t){},Object.defineProperty(r.prototype,"currentScheme",{get:function(){return"v3"},enumerable:!1,configurable:!0}),r.prototype.processLocalAuthenticatorError=function(t){var n=t;t.getErrorCode()==e.AuthenticationErrorCode.InvalidInput&&this._operationMode==e.AuthenticatorSessionMode.Authentication?this.processAuthFailureAssertionAndHandleError(n,1):this.performErrorRecoveryForError(n)},r.prototype.getKeyForEnrollmentDataAndInput=function(t,n){var o=this;return new Promise((function(e,r){t.version>="v2"?o.getKeyForEnrollmentDataAndInputV2(t,n).then(e,r):o.getKeyForEnrollmentDataAndInputPreV2(t,n).then(e,r)})).then((function(t){if(!t)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.InvalidInput,"Invalid input provided to authenticator.");return{key:t}}))},r.prototype.generatePendingEnrollment=function(o){var i=this;return new Promise((function(s,a){var u=i._sdk.host.generateRandomHexString(32),c=i._sdk.host.generateRandomHexString(64),l=i.extractPbkdfInputFromInputResponse(o);return e.util.wrapPromiseWithActivityIndicator(i._uiHandler,i._actionDriver.policyAction(),i._clientContext,i._sdk.host.generateHexSeededKeyPairExternalRepresentation(t.sdkhost.KeyClass.FidoECCSigningKey,c,r.enrollmentVersion2KeyGenVersion(i.currentScheme),null).then((function(e){return n.vault.pbkdfStretchHexSecretIntoAESKey(u,l,i._sdk.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),i._sdk.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,i._sdk).then((function(n){return n.encrypt(c).then((function(n){return{key:i._sdk.host.importVolatileKeyPair(t.sdkhost.KeyClass.FidoECCSigningKey,e),salt:u,schemeVersion:i.currentScheme,keyMeterial:n}}))}))}))).then(s,a)}))},r.prototype.getKeyForEnrollmentDataAndInputV2=function(e,o){var i=this,s=this.extractPbkdfInputFromInputResponse(o);return n.vault.pbkdfStretchHexSecretIntoAESKey(e.salt,s,e.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),e.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,this._sdk).then((function(n){return n.decrypt(e.keyMaterial,null).then((function(n){return i._sdk.host.generateHexSeededKeyPairExternalRepresentation(t.sdkhost.KeyClass.FidoECCSigningKey,n,r.enrollmentVersion2KeyGenVersion(e.version),e.publicKeyHash).then((function(e){return i._sdk.host.importVolatileKeyPair(t.sdkhost.KeyClass.FidoECCSigningKey,e)}))}))}))},r.prototype.getKeyForEnrollmentDataAndInputPreV2=function(e,n){var o=this;return this.authenticatorKeyTagForScheme(e.version,e.salt,e.cryptoSettings,n).then((function(e){return o._sdk.host.getKeyPair(e,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.None)}))},r.prototype.schemeVersionRequiresRollover=function(t){return"v0"==t||"v1"==t},r.prototype.authenticatorKeyTagForScheme=function(t,o,r,i){var s=this;return new Promise((function(a,u){var c=s.extractPbkdfInputFromInputResponse(i);if("v0"==t&&(s._sdk.log(e.LogLevel.Debug,(function(){return"Using SDK CryptoSettings for migrated enrollment."})),r=s._sdk.cryptoSettings),!r)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Missing crypt settings for local enrollment.");s._sdk.host.generatePbkdf2HmacSha1HexString(o,c,r.getLocalEnrollmentKeySizeInBytes(),r.getLocalEnrollmentKeyIterationCount()).then((function(o){var r=e.util.hexToBase64(o);return new n.TarsusKeyPath("per_user",s.user.guid.toString(),"local_auth_keys",s.authenticatorType,t,r)})).then(a,u)}))},r}(o.AuthenticationDriverLocal);o.AuthenticationDriverLocalSecretInputBased=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return n.authenticatorName},enumerable:!1,configurable:!0}),n.prototype.handleAuthenticationInputResponse=function(n){var o=n;t.impl.PatternInputImpl.validateFormat(o)?e.prototype.handleAuthenticationInputResponse.call(this,n):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.handleRegistrationInputResponse=function(n){var o=this._authenticatorConfig,r=n;t.impl.PatternInputImpl.validateFormat(r)?o.min_length&&t.impl.PatternInputImpl.getPatternLength(r)<o.min_length?this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern length.")):e.prototype.handleRegistrationInputResponse.call(this,n):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.extractPbkdfInputFromInputResponse=function(e){var n=e;return t.util.asciiToHex(n.getPatternDescription())},n.prototype.createAuthenticatorSession=function(){var t,e,o=this._authenticatorConfig,r=this._uiHandler.createPatternAuthSession(n.authenticatorName,this.user.displayName,3,4);return null===(e=(t=r).setMinLength)||void 0===e||e.call(t,o.min_length),r},n.prototype.authenticateInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.registerInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.authenticatorName="pattern",n}(e.AuthenticationDriverLocalSecretInputBased);e.AuthenticationDriverLocalPattern=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return n.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),n.prototype.handleRegistrationInputResponse=function(n){n.getPin().length!=this.pinLength?this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Expecting an entry of length "+this.pinLength+".")):e.prototype.handleRegistrationInputResponse.call(this,n)},n.prototype.generatePendingEnrollment=function(t){var n=this;return e.prototype.generatePendingEnrollment.call(this,t).then((function(t){var e={length:n.pinLength};return t.authenticatorConfig=e,t}))},n.prototype.extractPbkdfInputFromInputResponse=function(e){var n=e;return t.util.asciiToHex(n.getPin())},n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPinAuthSession(n.authenticatorName,this.user.displayName,this.pinLength)},n.prototype.authenticateInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.registerInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.authenticatorName="pin",n}(e.AuthenticationDriverLocalSecretInputBased);e.AuthenticationDriverLocalPinCode=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(n){function o(t,e,o){return n.call(this,t,e,o)||this}return V(o,n),o.prototype.poll=function(){var n=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"authenticate",this.pollingAssertionData(),{}).then((function(o){n.filterAssertionResult(o)&&n.shouldContinuePolling(o)?n.pumpInput():n.handleAuthenticateAssertionResult(o,n._authenticatorDescription,"authenticate",n.pollingAssertionData)||(n._sdk.log(t.LogLevel.Info,(function(){return"Authenticator session done."})),n.completeAuthenticatorSessionWithResult(new e.AuthenticationDriverSessionResultAuthenticationCompleted(o)))})).catch((function(e){n.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},o.prototype.longPoll=function(e,n){var o=this;this._actionDriver.sendPollingRequest(e,n).then((function(t){t.change_detected?o.poll():o.pumpInput()})).catch((function(e){o.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},o}(e.AuthenticationDriver);e.AuthenticationDriverPolling=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){!function(n){!function(o){var r=function(r){function i(t,e,n){var o=r.call(this,t,e,n)||this;return o.methodName="mobileApprove",o.setupDataModel(e,n),o}return V(i,r),i.prototype.createAuthenticatorSession=function(){var o=this,r=this._uiHandler.createMobileApproveAuthSession("mobile_approve",this.user.displayName,this._instructions);if(!r)throw e.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createMobileApproveAuthSession");if(r.setAvailableTargets(this._selectableDevices),this._state==n.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate){this._selectedDevices=this._selectableDevices.map((function(t){return t}));var i=null;this._otp&&(i=t.ts.mobile.sdk.impl.MobileApproveOtpImpl.createFromServerFormat(this._otp)),r.setCreatedApprovalInfo(this._selectedDevices,i)}if(this._authenticationParameters){var s=this._authenticationParameters.filter((function(t){e.AuthenticationActionParameterTargetSelection}));if(0!=s.length){this._sdk.log(e.LogLevel.Debug,(function(){return"Target based driver found target selection parameters."}));var a=this._selectableDevices.reduce((function(t,e){return t[e.getDeviceIdentifier()]=e,t}),{});this._pendingTargetSelection=s.map((function(t){var n=t.getTarget(),o=a[n.getDeviceIdentifier()];if(!o)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Authentication parameter tried to select a device not presented as a selectable target");return o}),{}),this._sdk.log(e.LogLevel.Debug,(function(){return"Target based driver will select targets "+o._pendingTargetSelection+" based on selection parameter."}))}}return r},i.prototype.authenticateInStartedSession=function(t){this._autoExecuted?this._autoExecuted=!1:this.reset(),this.pumpInput()},i.prototype.pumpInput=function(){if(this._state===n.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval)this.createApproval();else{if(this._state!==n.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Illegal authenticator state encountered: "+this._state);this.requestInputAndHandle()}},i.prototype.registerInStartedSession=function(t){throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Cannot register Mobile Approve authenticator.")},i.prototype.createApproval=function(){var t=this;if(this._approvalId=null,this._pendingTargetSelection&&Object.keys(this._pendingTargetSelection).length){this._sdk.log(e.LogLevel.Debug,(function(){return"Performing pending target selection "+t._pendingTargetSelection}));var n=e.TargetBasedAuthenticatorInput.createTargetsSelectionRequest(this._pendingTargetSelection);this._pendingTargetSelection=null,this.handleAuthenticationInputResponse(n)}else this._strategy.user_selection&&this._selectableDevices&&this._selectableDevices.length?this.requestInputAndHandle():this.handleAuthenticationInputResponse(e.TargetBasedAuthenticatorInput.createTargetsSelectionRequest([]))},i.prototype.requestInputAndHandle=function(){var t=this;this._inputSession.promiseInput().then((function(e){t.handleInputOrControlResponse(e)}))},i.prototype.handleAuthenticationInputResponse=function(t){switch(this._state){case n.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval:var o=t.getSelectedTargets();if(o){this.handleTargetSelectionInput(o);break}throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Expected target selection input response but got: "+t);case n.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate:var r=t.getAuthenticatorInput();if(r instanceof e.MobileApproveInputRequestPolling){var i=r.getPollingTimeout();if(i){var s={type:"approval",approval_id:this._approvalId||""};this.longPoll(s,i)}else this.poll();break}throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Expected polling request input response but got: "+t);default:throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Illegal state for authenticator: "+this._state)}},i.prototype.handleTargetSelectionInput=function(t){var n=this;this._selectedDevices=t.map((function(t){var o=t;if(n._selectableDevices.indexOf(o)<0)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Attempt to select a Mobile Approve target not originally listed in the session.");return o})),this.createForSelectedTargets()},i.prototype.createForSelectedTargets=function(){var n,o=this;n=this._selectedDevices&&this._selectedDevices.length?{device_ids:this._selectedDevices.map((function(t){return t.getDeviceIdentifier()}))}:{},this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"approval",n,{}).then((function(n){if(!o.handleGeneralAssertionResult(n))if(n.assertion_error_code)o._sdk.log(e.LogLevel.Error,(function(){return"Assertion error encoutered. Starting error recovery."})),o.performErrorRecoveryForError(e.impl.AuthenticationErrorImpl.errorForAssertionResponse(n));else{var r=null,i=n.data;i.otp&&(r=t.ts.mobile.sdk.impl.MobileApproveOtpImpl.createFromServerFormat(i.otp)),o._approvalId=i.approval_id||null,o._state=i.state,o._inputSession.setCreatedApprovalInfo(o._selectedDevices,r),o._sdk.log(e.LogLevel.Debug,(function(){return"Restarting auth or reg."})),o.pumpInput()}})).catch((function(t){o.completeAuthenticatorSessionWithError(t)}))},i.prototype.handleRegistrationInputResponse=function(t){throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Cannot register Mobile Approve authenticator.")},i.prototype.processControlRequest=function(t){t.getRequestType()===e.ControlRequestType.RetryAuthenticator&&this.reset(),r.prototype.processControlRequest.call(this,t)},i.prototype.filterAssertionResult=function(t){if(5==t.assertion_error_code)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.ApprovalDenied,"Approval was denied");if(21==t.assertion_error_code)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.ApprovalExpired,"Approval has expired");return!0},i.prototype.shouldContinuePolling=function(t){return t.assertion_error_code==n.Protocol.AssertionErrorCode.ExternalProcessPending},i.prototype.pollingAssertionData=function(){return{approval_id:this._approvalId}},i.prototype.reset=function(){this._state=n.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval,this._approvalId=null,this._selectedDevices=null,this._inputSession.setCreatedApprovalInfo(null,null)},i.prototype.setupDataModel=function(t,e){this._state=t.state,this._otp=t.otp||null,this._strategy=t.strategy,this._selectableDevices=o.AuthenticationDriverDescriptorMobileApprove.createTargetsFromConfig(t),this._instructions=t.instructions,this._approvalId=t.approval_id||null,this._approvalId&&(this._autoExecuted=!0)},i}(o.AuthenticationDriverPolling);o.AuthenticationDriverMobileApprove=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(e.sdk||(e.sdk={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(r){function i(t,e,n){return r.call(this,t,e,n)||this}return V(i,r),i.prototype.getBiometricPromptFallbackControlType=function(){return null!=this._biometricPromptFallbackControlType?this._biometricPromptFallbackControlType:e.ControlRequestType.SelectMethod},i.authenticatorKeyTagForUser=function(t,e,o){return new n.TarsusKeyPath("per_user",t.guid.toString(),"local_auth_keys","native_face",e,o)},i.prototype.shouldAllowBiometricFallbackButton=function(t){var o=this;if(!t)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter((function(t){return t!=o._authenticatorDescription}));if(this._actionDriver instanceof n.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof n.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var i=t,s=i.getFallbackButtonTitle();if(!(s&&s.length>0))return!1;var a=i.getFallbackControlRequestType();switch(null==a&&(a=e.ControlRequestType.SelectMethod),a){case e.ControlRequestType.ChangeMethod:return this._actionDriver.availableAuthenticatorsForSwitching.filter((function(t){return t!=o._authenticatorDescription})).length>0;case e.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticatorsForSwitching.length>0;default:return!0}},i.prototype.runSilentRegistration=function(){var t=this;return this.generateFaceNativeKeyForScheme(this.currentScheme).then((function(n){var r=t.getNewOrUpdatedEnrollmentRecord(n),i={public_key:n.key.publicKeyToJson(),version:n.schemeVersion};return t._actionDriver.sendAuthenticatorAssertionRequest(t._authenticatorDescription,"register",null,i).then((function(n){if(n.assertion_error_code)throw e.impl.AuthenticationErrorImpl.errorForAssertionResponse(n);return t.user.updateEnrollmentRecord(r),new o.AuthenticationDriverSessionResultAuthenticationCompleted(n)}))}))},i.prototype.createAuthenticatorSession=function(){return this._uiHandler.createNativeFaceAuthSession(o.AuthenticationDriverDescriptorNativeFace.authenticatorName,this.user.displayName)},i.prototype.authenticateInStartedSession=function(t){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},i.prototype.registerInStartedSession=function(t){var n=this;r.prototype.registerInStartedSession.call(this,t),this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},Object.defineProperty(i.prototype,"authenticatorType",{get:function(){return o.AuthenticationDriverDescriptorNativeFace.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentScheme",{get:function(){return"v2"},enumerable:!1,configurable:!0}),i.prototype.processLocalAuthenticatorError=function(o){var r=this,i=o,s=0,a=Promise.resolve();if(i.getErrorCode()==e.AuthenticationErrorCode.Internal&&i.getData()){var u=i.getData();s=u[t.sdkhost.ErrorDataNumFailures]||s,i=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(u,"Native Face")||i,(u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||u[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricInvalidated)&&(a=n.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}a.catch((function(t){r._sdk.log(e.LogLevel.Error,t)})),a.finally((function(){var n=i.getData();if(!s||r._operationMode!=e.AuthenticatorSessionMode.Authentication)return n[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricFallbackPressed?(r._sdk.log(e.LogLevel.Debug,(function(){return"Biometric prompt fallback button pressed"})),void r.processControlRequest(e.ControlRequest.create(r.getBiometricPromptFallbackControlType()))):i.getErrorCode()==e.AuthenticationErrorCode.UserCanceled?(r._sdk.log(e.LogLevel.Debug,(function(){return"Native face authenticator captured user cancel error code."})),void r.invokeCancellationUiOrEscape()):void r.performErrorRecoveryForError(i);r.processAuthFailureAssertionAndHandleError(i,s)}))},i.prototype.getKeyForEnrollmentDataAndInput=function(n,o){var r=this;return new Promise((function(i,s){var a=o;r.shouldAllowBiometricFallbackButton(a)&&(r._biometricPromptFallbackControlType=a.getFallbackControlRequestType());var u=r.authenticatorKeyTagForScheme(n.version,n.salt),c=r._sdk.host.getKeyPair(u,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!c){var l={};throw l[t.sdkhost.ErrorDataInternalError]=t.sdkhost.InternalErrorBiometricInvalidated,new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated FaceID.",l)}c.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.nativeFaceInput(a),null,null),i({key:c})}))},i.prototype.generatePendingEnrollment=function(t,n){if(!n){var o=t;this.shouldAllowBiometricFallbackButton(o)&&(this._biometricPromptFallbackControlType=o.getFallbackControlRequestType())}return this.generateKeyForScheme(t,this.currentScheme).then((function(t){return n||t.key.setBiometricPromptInfo(e.util.BiometricPromptInfoFrom.nativeFaceInput(o),null,null),t}))},i.prototype.generateKeyForScheme=function(t,e){return this.generateFaceNativeKeyForScheme(e)},i.prototype.schemeVersionRequiresRollover=function(t){return"v0"==t||"v1"==t},i.prototype.generateFaceNativeKeyForScheme=function(n){var o;o="v1"==n||"v2"==n?this._sdk.host.generateRandomHexString(24):"";var r=this.authenticatorKeyTagForScheme(n,o);return e.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then((function(t){return{key:t,salt:o,schemeVersion:n}}),(function(t){if(t.getErrorCode()==e.AuthenticationErrorCode.Internal&&t.getData()){var n=t.getData(),o=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(n,"Native Face");if(o)throw o}throw t})))},i.prototype.authenticatorKeyTagForScheme=function(t,e){return i.authenticatorKeyTagForUser(this.user,t,e)},i}(o.AuthenticationDriverLocalPersistentKeyPairBased);o.AuthenticationDriverNativeFace=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o,r){var i=n.call(this,t,e,r)||this;return i._possibleTargets=o,i.setupDataModel(e),i}return V(o,n),o.prototype.getPossibleTargets=function(){return this._possibleTargets},o.prototype.createAuthenticatorSession=function(){var e,n=this;if(0!=(e=this._authenticationParameters?this._authenticationParameters.filter((function(e){return e instanceof t.AuthenticationActionParameterTargetSelection})):[]).length){this._sdk.log(t.LogLevel.Debug,(function(){return"Target based driver found target selection parameters."}));var o=e[0].getTarget().getChannelAssertionId(),r=this._possibleTargets.filter((function(t){return t.getChannelAssertionId()==o}));r.length?(this._pendingTargetSelection=r[0],this._sdk.log(t.LogLevel.Debug,(function(){return"Target based driver will select target "+n._pendingTargetSelection+" based on selection parameter."})),this._lastSelectedTarget=this._pendingTargetSelection):this._sdk.log(t.LogLevel.Warning,(function(){return"Target selection parameter for target based auth driver specified invalid target assertiong id "+o+"."}))}var i=this._uiHandler.createOtpAuthSession("otp",this.user.displayName,this._possibleTargets,this._autoExecTarget);if(!i)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createOtpAuthSession");return i.setAvailableTargets(this._possibleTargets),i},o.prototype.authenticateInStartedSession=function(e){var n=this;if(0==this._possibleTargets.length)return this._sdk.log(t.LogLevel.Warning,(function(){return"No authentication target available for OTP. Doing error recovery."})),void this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,"No targets available for OTP."),!0);if(this._sdk.log(t.LogLevel.Debug,(function(){return"Notifying current session of generated OTP format and target"})),this._inputSession.setGeneratedOtp(this._format,this._lastSelectedTarget),this._pendingTargetSelection){this._sdk.log(t.LogLevel.Debug,(function(){return"Performing pending target selection "+n._pendingTargetSelection}));var o=t.TargetBasedAuthenticatorInput.createTargetsSelectionRequest([this._pendingTargetSelection]);this._pendingTargetSelection=null,this.handleInputOrControlResponse(t.InputOrControlResponse.createInputResponse(o))}else this._inputSession.promiseInput().then((function(t){n.handleInputOrControlResponse(t)})).catch((function(e){n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},o.prototype.registerInStartedSession=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register OTP authenticator.")},o.prototype.handleTargetBasedAuthenticatorConcreteInput=function(e){if(e instanceof t.OtpInputOtpSubmission)this.processAuthenticateAssertion({otp:e.getOtp()},{assertion_id:this._possibleTargets[0].getChannelAssertionId()});else{if(!(e instanceof t.OtpInputRequestResend))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unknown OTP response type received from application callback.");this.triggerForSelectedTarget()}},o.prototype.handleAuthenticateAssertionResult=function(e,o,r,i,s){return e.data&&e.data.additional_error_code&&1==e.data.additional_error_code&&(this._sdk.log(t.LogLevel.Debug,(function(){return"Reached max number of attempts - invalidating current target."})),this._lastSelectedTarget=null,this._format=null),n.prototype.handleAuthenticateAssertionResult.call(this,e,o,r,i,s)},o.prototype.handleAuthenticationInputResponse=function(e){if(e.getAuthenticatorInput())this.handleTargetBasedAuthenticatorConcreteInput(e.getAuthenticatorInput());else{if(!e.getSelectedTargets()[0])throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid target-based authetnicator response type received from application callback. Target-based authenticator inputs must be created by calling TargetBasedAuthenticatorInput.createAuthenticatorInput.");var n=e.getSelectedTargets();if(n.length>1)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select multiple OTP targets while OTP supports only a single target.");var o=n[0];if(this._possibleTargets.indexOf(o)<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select an OTP target not originally listed in the session.");this._lastSelectedTarget=o,this.triggerForSelectedTarget()}},o.prototype.triggerForSelectedTarget=function(){var n=this;if(!this._lastSelectedTarget)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to trigger OTP generation without a selected target.");var o={target_id:this._lastSelectedTarget.getTargetIdentifier(),channel_index:this._lastSelectedTarget.getChannelIndex()},r={assertion_id:this._lastSelectedTarget.getChannelAssertionId()};this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"otp",o,r).then((function(o){o.assertion_error_code&&o.assertion_error_code!=e.Protocol.AssertionErrorCode.FailOver&&(n._sdk.log(t.LogLevel.Error,(function(){return"Assertion error encoutered. Clearing last selected target."})),n._lastSelectedTarget=null),n.handleAuthenticateAssertionResult(o,n._authenticatorDescription,"otp",r,r)||(o.data&&o.data.otp_format&&(n._sdk.log(t.LogLevel.Debug,(function(){return"Received updated OTP and format."})),n._format=t.OtpFormatImpl.fromAssertionFormat(o.data.otp_format)),n._sdk.log(t.LogLevel.Debug,(function(){return"Restarting auth or reg."})),n.authOrRegInStartedSession(!0))})).catch((function(t){n.completeAuthenticatorSessionWithError(t)}))},o.prototype.handleRegistrationInputResponse=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register OTP authenticator.")},o.prototype.setupDataModel=function(n){this._otpInitialState=n.state,this._otpInitialState==e.Protocol.AuthenticationMethodOtpState.Validate&&(this._lastSelectedTarget=this._possibleTargets[0],this._autoExecTarget=this._lastSelectedTarget);var o=n.format||n.otp_format;this._format=o&&t.OtpFormatImpl.fromAssertionFormat(o)||null},o}(n.AuthenticationDriver);n.AuthenticationDriverOtp=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPasswordAuthSession("password",this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.registerInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},n.prototype.handleAuthenticationInputResponse=function(e){var n=e.getPassword();n&&n.length>0?this.processAuthenticateAssertion({password:n}):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Password can't be empty"))},n.prototype.handleRegistrationInputResponse=function(e){var n=e.getPassword();n&&n.length>0?this.processRegisterAssertion({password:n}):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Password can't be empty"))},n}(e.AuthenticationDriver);e.AuthenticationDriverPassword=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),n.prototype.createAuthenticatorSession=function(){var t,e,n=this._authenticatorConfig,o=this._uiHandler.createPatternAuthSession("pattern_centralized",this.user.displayName,3,4);return null===(e=(t=o).setMinLength)||void 0===e||e.call(t,n.min_length),o},n.prototype.handleAuthenticationInputResponse=function(n){var o=n;t.impl.PatternInputImpl.validateFormat(o)?e.prototype.handleAuthenticationInputResponse.call(this,n):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.handleRegistrationInputResponse=function(n){var o=n,r=this._authenticatorConfig;t.impl.PatternInputImpl.validateFormat(o)?r.min_length&&t.impl.PatternInputImpl.getPatternLength(o)<r.min_length?this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern length.")):e.prototype.handleRegistrationInputResponse.call(this,n):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.generateSecretToSignForInputResponse=function(t){return t.getPatternDescription()},n}(e.AuthenticationDriverCentralizedSecretInputBased);e.AuthenticationDriverPattern=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),Object.defineProperty(n.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPinAuthSession("pin_centralized",this.user.displayName,this.pinLength)},n.prototype.handleRegistrationInputResponse=function(n){n.getPin().length==this.pinLength?e.prototype.handleRegistrationInputResponse.call(this,n):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Invalid PIN length provided.",{expected_length:this.pinLength}))},n.prototype.generateSecretToSignForInputResponse=function(t){return t.getPin()},n}(e.AuthenticationDriverCentralizedSecretInputBased);e.AuthenticationDriverPinCode=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e,n){return o.call(this,t,e,n)||this}return V(r,o),r.prototype.createAuthenticatorSession=function(){var t=this,e=this.generatePlaceholderServerTokenGenerationPayload(),n=r.placeholderExtensionPoint.firstNonNull((function(n){return n.createPlaceholderAuthSession(t._authenticatorDescription.getPlaceholderId(),t._authenticatorConfig.placeholder_type||"",t._authenticatorDescription.getName()||"",t.user.displayName,t._authenticatorConfig.data||"",e)}));return n||this._uiHandler.createPlaceholderAuthSession(this._authenticatorDescription.getPlaceholderId(),this._authenticatorConfig.placeholder_type||"",this._authenticatorDescription.getName()||"",this.user.displayName,this._authenticatorConfig.data||"",e)},r.prototype.authenticateOrRegisterInStratedSession=function(t){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(t){return n.completeAuthenticatorSessionWithError(e.impl.AuthenticationErrorImpl.ensureAuthenticationError(t))}))},r.prototype.authenticateInStartedSession=function(t){this.authenticateOrRegisterInStratedSession(t)},r.prototype.registerInStartedSession=function(t){this.authenticateOrRegisterInStratedSession(t)},r.prototype.handleAuthenticationInputResponse=function(t){this.handleAuthenticationOrRegistrationInputResponse(t)},r.prototype.handleRegistrationInputResponse=function(t){this.handleAuthenticationOrRegistrationInputResponse(t)},r.prototype.handleAuthenticationOrRegistrationInputResponse=function(t){t instanceof e.PlaceholderAuthSuccessResponse?(this._sdk.log(e.LogLevel.Debug,(function(){return"Placeholder received PlaceholderAuthSuccessResponse."})),this.handlePlaceholderSuccessResponse(t)):t instanceof e.PlaceholderAuthFailureResponse?(this._sdk.log(e.LogLevel.Debug,(function(){return"Placeholder received PlaceholderAuthFailureResponse."})),this.handlePlaceholderFailureResponse(t)):t instanceof e.PlaceholderAuthFailureWithServerProvidedStatusResponse?(this._sdk.log(e.LogLevel.Debug,(function(){return"Placehoder received PlaceholderAuthFailureWithServerProvidedStatusResponse"})),this.processAuthFailureAssertionAndHandleError(t.getFailureError(),1)):(this._sdk.log(e.LogLevel.Error,(function(){return"Placeholder received unknkown response type."})),this.performErrorRecoveryForError(new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.AppImplementation,"Placeholder received unknkown response type.")))},r.prototype.handlePlaceholderSuccessResponse=function(t){var n={token:t.getPlaceholderToken()};this._operationMode==e.AuthenticatorSessionMode.Authentication?this.processAuthenticateAssertion(n):this.processRegisterAssertion(n)},r.prototype.handlePlaceholderFailureResponse=function(t){this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",{num_of_failures:1});var o={status:t.getRegistrationStatus()==e.AuthenticatorRegistrationStatus.Registered?n.Protocol.AuthenticationMethodStatus.Registered:n.Protocol.AuthenticationMethodStatus.Unregistered,expired:t.getExpired(),locked:t.getLocked(),last_used:0};this._authenticatorDescription.updateWithAuthenticatorState(o),this.performErrorRecoveryForError(t.getFailureError())},r.prototype.generatePlaceholderServerTokenGenerationPayload=function(){var t=this.user.deviceId||this._actionDriver._controlFlowProcessor._session.deviceId(),e={assertion_id:this._authenticatorDescription.assertionId,challenge:this._actionDriver._controlFlowProcessor.challenge,device_id:t,auth_type:this._authenticatorDescription.getAuthenticatorId()};return btoa(JSON.stringify(e))},r.placeholderExtensionPoint=new n.ExtensionPoint(t.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_PLACEHOLDER_EXTENSION),r}(o.AuthenticationDriver);o.AuthenticationDriverPlaceholder=r}(n.authenticationdrivers||(n.authenticationdrivers={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){var r=e.call(this,t,n,o)||this;return r._pendingRestartRequest=!1,r}return V(n,e),Object.defineProperty(n.prototype,"currentQuestionsStep",{get:function(){return this._currentStep},enumerable:!1,configurable:!0}),n.prototype.createAuthenticatorSession=function(){return this._pendingRestartRequest=!1,this._uiHandler.createSecurityQuestionAuthSession("question",this.user.displayName)},n.prototype.authenticateInStartedSession=function(n){var o=this,r=Promise.resolve(null);this._pendingRestartRequest&&(this._pendingRestartRequest=!1,r=this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"restart",{}).then((function(e){e.data&&e.data.question?o._currentStep=o.loadStepFromQuestionDict(e.data.question):o.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unexpected response to question restart request."))}))),r.then((function(t){e.prototype.authenticateInStartedSession.call(o,n)}))},n.prototype.loadStepFromQuestionDict=function(e){var n=Object.keys(e);if(1!=n.length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting a single authentication question.");return t.impl.SecurityQuestionStepDescriptionImpl.createForAuthQuestion(new t.impl.SecurityQuestionImpl(n[0],e[n[0]],!0))},n.prototype.createInitialInputStep=function(){var e=this._authenticatorConfig;switch(this._operationMode){case t.AuthenticatorSessionMode.Authentication:if(!e.question)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting authentication question dictionary.");return this.loadStepFromQuestionDict(e.question);case t.AuthenticatorSessionMode.Registration:if(!e.questions)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting registration question dictionary.");if(!e.reg_min_questions)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting minimum registered questions field");if(e.max_answer_length||(e.max_answer_length=-1),!e.min_answer_length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting minimum answer length");var n=e.questions,o=Object.keys(n).map((function(e){return new t.impl.SecurityQuestionImpl(e,n[e].text,n[e].registered)}));return t.impl.SecurityQuestionStepDescriptionImpl.createForRegistrationQuestions(o,e.reg_min_questions,e.max_answer_length,e.min_answer_length)}},n.prototype.prepareNextAuthenticationStep=function(t){return this.loadStepFromQuestionDict(t.data.question)},n.prototype.updateCurrentAuthenticationStep=function(t,e){return e},n.prototype.handleAuthenticationInputResponse=function(e){var n=e;if(this.sortValidAnswers(n),1!=n.getAnswers().length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expecting exactly one answer on secuirty question authentication.");var o=this.securityQuestionAnswersResposneToAnswerMap(n);this.processAuthenticateAssertion({answer:o})},n.prototype.handleRegistrationInputResponse=function(e){var n=e,o=this.currentSecurityQuestionsStep().getMinAnswersNeeded();if(0==o)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"No answers were provided");this.sortValidAnswers(n).length;var r=0;this.currentQuestionsStep.getSecurityQuestions().forEach((function(t){t.getAnswered()&&r++}));var i=this.securityQuestionAnswersResposneToJson(n),s=i.answers.length+r-i.deleted_answers.length;if(this._sdk.log(t.LogLevel.Debug,(function(){return"handleRegistrationInputResponse: alreadyAnswered:"+r+" with sent list of "+i.answers.length+" and deleted of "+i.deleted_answers.length})),o>s)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Only "+s+" answers were provided to security questions registration process. "+s+" answers out of required minimum of "+o+".");this.processRegisterAssertion(this.securityQuestionAnswersResposneToJson(n))},n.prototype.handleErrorRecoveryAction=function(n,o){o.getErrorCode()==t.AuthenticationErrorCode.InvalidInput&&(this._pendingRestartRequest=!0),e.prototype.handleErrorRecoveryAction.call(this,n,o)},n.prototype.sortValidAnswers=function(e){for(var n=Array(),o=0,r=e.getAnswers();o<r.length;o++){var i=r[o];if(!i.getIsRemoved()){if(!i.getAnswer()||!i.getAnswer().getAnswerText()||i.getAnswer().getAnswerText().length<this.currentQuestionsStep.getMinAnswerLength())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer too short. Answer must be at least "+this.currentQuestionsStep.getMinAnswerLength()+" characters.");if(this.currentQuestionsStep.getMaxAnswerLength()>0&&i.getAnswer().getAnswerText().length>this.currentQuestionsStep.getMaxAnswerLength())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer too long. Answer must be maximum "+this.currentQuestionsStep.getMaxAnswerLength()+" characters.");n.push(i)}}return n},n.prototype.securityQuestionAnswersResposneToJson=function(e){var n=this,o={},r=Array();return e.getAnswers().forEach((function(e){if(n.currentSecurityQuestionsStep().getSecurityQuestions().indexOf(e.getQuestion())<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer provided to a question not included in this step.");if(e.getIsRemoved())r.push(e.getQuestion().getSecurityQuestionId());else{var i=e.getAnswer().getAnswerText().toLocaleLowerCase();o[e.getQuestion().getSecurityQuestionId()]=i}})),{answers:o,deleted_answers:r}},n.prototype.securityQuestionAnswersResposneToAnswerMap=function(e){var n=this,o={};return e.getAnswers().forEach((function(e){if(n.currentSecurityQuestionsStep().getSecurityQuestions().indexOf(e.getQuestion())<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer provided to a question not included in this step.");var r=e.getAnswer().getAnswerText().toLocaleLowerCase();o[e.getQuestion().getSecurityQuestionId()]=r})),o},n.prototype.currentSecurityQuestionsStep=function(){return this._currentStep},n}(e.AuthenticationDriverMultiStep);e.AuthenticationDriverSecurityQuestions=n}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){};t.AuthenticationDriverSessionResult=e;var n=function(t){function e(e,n){var o=t.call(this)||this;return o.requiredAuthenticator=e||null,o.allowedAuthenticators=n||null,o}return V(e,t),e}(e);t.AuthenticationDriverSessionResultSwitchAuthenticator=n;var o=function(t){function e(e){var n=t.call(this)||this;return n.assertionResult=e,n}return V(e,t),e}(e);t.AuthenticationDriverSessionResultAuthenticationCompleted=o;var r=function(t){function e(e){var n=t.call(this)||this;return n.escapeRequest=e,n}return V(e,t),e}(e);t.AuthenticationDriverSessionResultEscapeRequested=r}(t.authenticationdrivers||(t.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(o){function r(t,e,n){var r=o.call(this,t,e,n)||this;return r._previousSelectedDevices=[],r.methodName="totp",r.setupDataModel(e,n),r}return V(r,o),r.prototype.setupDataModel=function(t,o){this._state=t.state,this._requiresChallengeGeneration=t.state!=e.Protocol.AuthenticationMethodTotpState.Validate,this._selectedDevices=null,this._state==e.Protocol.AuthenticationMethodTotpState.Validate&&t.challenge&&(this._challenge=this.createTotpChallenge(t.challenge)),t.selectable_devices?this._selectableDevices=n.AuthenticationDriverDescriptorTotp.createTargetsFromConfig(t):this._selectableDevices=null},r.prototype.createAuthenticatorSession=function(){var e=this;if(this._authenticationParameters){var n=this._authenticationParameters.filter((function(e){t.AuthenticationActionParameterTargetSelection}));if(this._selectableDevices&&0!=n.length){this._sdk.log(t.LogLevel.Debug,(function(){return"Target based driver found target selection parameters."}));var o=this._selectableDevices.reduce((function(t,e){return t[e.getDeviceIdentifier()]=e,t}),{});this._pendingTargetSelection=n.map((function(e){var n=e.getTarget(),r=o[n.getDeviceIdentifier()];if(!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Authentication parameter tried to select a device not presented as a selectable target");return r}),{}),this._sdk.log(t.LogLevel.Debug,(function(){return"Target based driver will select targets "+e._pendingTargetSelection+" based on selection parameter."}))}}var r=this._uiHandler.createTotpAuthSession("totp",this.user.displayName);if(!r)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTotpAuthSession");return r.setAvailableTargets(this._selectableDevices),r},r.prototype.handleRegistrationInputResponse=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register TOTP authenticator.")},r.prototype.registerInStartedSession=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register TOTP authenticator.")},r.prototype.authenticateInStartedSession=function(e){var n=this;!this._selectedDevices&&this._pendingTargetSelection&&this._pendingTargetSelection.length&&(this._sdk.log(t.LogLevel.Debug,(function(){return"TOTP authentication driver has "+n._pendingTargetSelection.length+" pending targets."})),this._selectedDevices=this._pendingTargetSelection),this.requestInput()},r.prototype.requestInput=function(){var e=this;this._inputSession.setTargetDevices(this._selectedDevices),this._inputSession.setChallenge(this._challenge),this.pendingChallengeGeneration()?this.sendGenerateTotpAssertion():this._inputSession.promiseInput().then((function(t){e.handleInputOrControlResponse(t)})).catch((function(n){e.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(n))}))},r.prototype.handleAuthenticationInputResponse=function(e){var n=e.getAuthenticatorInput(),o=e.getSelectedTargets();if(n){this._sdk.log(t.LogLevel.Debug,(function(){return"Handling OTP code Input."}));var r={totp:n.getCode()};this._selectedDevices&&(r.device_ids=this._selectedDevices.map((function(t){return t.getDeviceIdentifier()}))),this.processAuthenticateAssertion(r)}else{if(!o||!this._selectableDevices)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid target-based authenticator response type received from application callback. Target-based authenticator inputs must be created by calling TargetBasedAuthenticatorInput.createAuthenticatorInput.");var i=this._selectableDevices;if(this._sdk.log(t.LogLevel.Debug,(function(){return"Handling target selection Input."})),this._selectedDevices=o.map((function(e){var n=e;if(i.indexOf(n)<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select a Totp target not originally listed in the session.");return n})),0===this._selectedDevices.length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"No targets selected for TOTP.");this.requestInput()}},r.prototype.sendGenerateTotpAssertion=function(){var n=this,o={};this._selectedDevices&&(o.device_ids=this._selectedDevices.map((function(t){return t.getDeviceIdentifier()}))),this._sdk.log(t.LogLevel.Debug,(function(){return"Requesting TOTP generation"})),this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"generate",o,{}).then((function(r){n._previousSelectedDevices=n._selectedDevices||[],r.assertion_error_code&&r.assertion_error_code!=e.Protocol.AssertionErrorCode.FailOver&&(n._sdk.log(t.LogLevel.Error,(function(){return"Assertion error encountered."})),n._selectedDevices=null),!n.handleAuthenticateAssertionResult(r,n._authenticatorDescription,"generate",o)&&r.data&&(n._state=r.data.state,r.data.challenge&&(n._challenge=n.createTotpChallenge(r.data.challenge)),n.requestInput())})).catch((function(e){n.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},r.prototype.pendingChallengeGeneration=function(){var t=this._selectedDevices&&(this._previousSelectedDevices.length!==this._selectedDevices.length||this._previousSelectedDevices.some((function(t,e){return t!==this._selectedDevices[e]}),this)),n=!this._selectableDevices;return this._requiresChallengeGeneration&&(t||n&&this._state==e.Protocol.AuthenticationMethodTotpState.Generate)},r.prototype.createTotpChallenge=function(e){var n=new t.TotpChallenge;return n.setValue(e.value),n.setFormat(t.TotpChallengeFormatImpl.fromAssertionFormat(e.format)),n},r.prototype.handleAuthenticateAssertionResult=function(n,r,i,s,a){if(n.assertion_error_code&&n.assertion_error_code==e.Protocol.AssertionErrorCode.RepeatCurrentStep&&n.data&&"check_digit"==n.data.reason){this._sdk.log(t.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() for Totp code with incorrect check digit"}));var u=new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,n.assertion_error_message||"Totp code with incorrect check digit");return u.setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorInvalidInputErrorDescription,t.AuthenticationErrorPropertySymbol.AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit),this.performErrorRecoveryForError(u),!0}return o.prototype.handleAuthenticateAssertionResult.call(this,n,r,i,s,a)},r}(n.AuthenticationDriver);n.AuthenticationDriverTotp=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n;!function(t){t.LONG="tooLong",t.SHORT="tooShort",t.LOUD="tooLoud",t.SOFT="tooSoft",t.NOISY="tooNoisy",t.WRONG_PASSPHRASE="wrongPassphrase",t.VALID_PASSPHRASE="000"}(n||(n={}));var o=function(e){function o(t,n,o){return e.call(this,t,n,o)||this}return V(o,e),o.prototype.createAuthenticatorSession=function(){return this._uiHandler.createVoiceAuthSession("voice",this.user.displayName)},o.prototype.updatePassphraseFromAssertionResultIfNeeded=function(e){var n=e.data;if(n){var o=n.passphrase_text;if(o)this._sdk.log(t.LogLevel.Debug,(function(){return"handleAuthenticateAssertionResult() received updated passphrase"})),this._authenticatorConfig.passphrase_text=o}},o.prototype.handleRegisterAssertionResult=function(t){return this.updatePassphraseFromAssertionResultIfNeeded(t),e.prototype.handleRegisterAssertionResult.call(this,t)},o.prototype.handleAuthenticateAssertionResult=function(t,n,o,r,i){return this.updatePassphraseFromAssertionResultIfNeeded(t),e.prototype.handleAuthenticateAssertionResult.call(this,t,n,o,r,i)},o.prototype.createInitialInputStep=function(){var e=this._authenticatorConfig;return new t.impl.AudioAcquisitionStepDescriptionImpl(this.createStepTag(),e.passphrase_text)},o.prototype.prepareNextAuthenticationStep=function(e){var n=this._authenticatorConfig;return new t.impl.AudioAcquisitionStepDescriptionImpl(this.createStepTag(e.data&&e.data.additional_error_code),n.passphrase_text)},o.prototype.updateCurrentAuthenticationStep=function(t,e){return this.prepareNextAuthenticationStep(t)},o.prototype.handleAuthenticationInputResponse=function(t){var e=t;this.processAuthenticateAssertion(e.getAcquisitionResponse())},o.prototype.handleRegistrationInputResponse=function(t){var e=t;this.processRegisterAssertion(e.getAcquisitionResponse())},o.prototype.createStepTag=function(t){return"voice_"+(t?this.mapHintToVoiceError(t):n.VALID_PASSPHRASE)},o.prototype.mapHintToVoiceError=function(e){switch(e){case 101:return n.LONG;case 102:return n.SHORT;case 103:return n.LOUD;case 104:return n.SOFT;case 105:return n.NOISY;case 106:return n.WRONG_PASSPHRASE;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Voice error code "+e+" is unknown/unhandled")}},o}(e.AuthenticationDriverMultiStep);e.AuthenticationDriverVoice=o}(e.authenticationdrivers||(e.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){t.AuthenticatorDrivers={password:new t.SimpleAuthenticationDriverDescriptor(t.AuthenticationDriverPassword),pin_centralized:new t.SimpleAuthenticationDriverDescriptor(t.AuthenticationDriverPinCode),pin:new t.AuthenticationDriverDescriptorLocal(t.AuthenticationDriverLocalPinCode,t.AuthenticationDriverLocalPinCode.authenticatorName),pattern:new t.AuthenticationDriverDescriptorLocal(t.AuthenticationDriverLocalPattern,t.AuthenticationDriverLocalPattern.authenticatorName),pattern_centralized:new t.SimpleAuthenticationDriverDescriptor(t.AuthenticationDriverPattern),fingerprint:new t.AuthenticationDriverDescriptorFingerprint,face_id:new t.AuthenticationDriverDescriptorNativeFace,otp:new t.AuthenticationDriverDescriptorOtp,face_server:new t.AuthenticationDriverDescriptorFace,voice_server:new t.AuthenticationDriverDescriptorVoice,mobile_approve:new t.AuthenticationDriverDescriptorMobileApprove,totp:new t.AuthenticationDriverDescriptorTotp,question:new t.SimpleAuthenticationDriverDescriptor(t.AuthenticationDriverSecurityQuestions),fido2:new t.AuthenticationDriverDescriptorFido2(t.AuthenticationDriverFido2),device_biometrics:new t.AuthenticationDriverDescriptorDeviceBiometrics,__placeholder:new t.SimpleAuthenticationDriverDescriptor(t.AuthenticationDriverPlaceholder)}}(t.authenticationdrivers||(t.authenticationdrivers={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.collectors||(o.collectors={}),n=function(){function t(t){this.enabledCollectors=t}return t.prototype.isEnabled=function(){var t=this.getAssociatedCollectorType();return null==t||-1!=this.enabledCollectors.indexOf(t)},t}(),e.Collector=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.collectors||(o.collectors={}),n=function(t){function e(e,n){var o=t.call(this,e)||this;return o.cacheValidityPeriod=n,o}return V(e,t),e.prototype.provide=function(t){var e=this;return new Promise((function(n,o){var r=e.getCachedData(t);r?n(r):e.provideNewData(t).then((function(o){e.saveCollectionResultToLocalStorage(t,o),n(o)}),o)}))},e.prototype.saveCollectionResultToLocalStorage=function(t,e){var n=t.host,o=this.getSchemeVersionTarsusKeyPath(),r=new Object;r.timeStamp=Date.now(),r.collectionResult=e,n.writeStorageKey(o,r)},e.prototype.getCachedData=function(t){var e=t.host,n=this.getSchemeVersionTarsusKeyPath(),o=e.readStorageKey(n);if(!o.collectionResult||!o.timeStamp)return t.log(r.LogLevel.Debug,(function(){return"No collected data found in cache."})),null;var i=o.timeStamp;return Date.now()-i>this.cacheValidityPeriod?(t.log(r.LogLevel.Debug,(function(){return"Cached collected data invalidated."})),null):(t.log(r.LogLevel.Debug,(function(){return"Loaded cached collector data: "+JSON.stringify(o.collectionResult)})),o.collectionResult)},e}(e.Collector),e.CacheableCollector=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.collectors||(o.collectors={}),n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.provide=function(e){return $(this,void 0,void 0,(function(){var n,o;return X(this,(function(r){switch(r.label){case 0:return n=new Object,o=n,[4,e.host.queryAsyncHostInfo(t.sdkhost.AsyncHostInformationKey.Fido2UserVerifyingPlatformAuthenticatorAvailable)];case 1:return o.fido2_user_verifying_platform_authenticator_available="true"==r.sent(),n.audio_acquisition_supported="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.AudioAcquitisionSupported),n.finger_print_supported="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.FingerprintSupported),n.image_acquisition_supported="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.ImageAcquitisionSupported),n.persistent_keys_supported="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.PersistentKeysSupported),n.face_id_key_bio_protection_supported="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported),n.fido2_client_present="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.Fido2ClientPresent),n.dyadic_present="true"==e.host.queryHostInfo(t.sdkhost.HostInformationKey.DyadicPresent),n.installed_plugins=e.pluginManager.getInitializedPlugins().map((function(e){return{plugin_name:e.getPluginInfo().getPluginName(),plugin_version:t.tarsusplugin.impl.PluginInfoImpl.versionToString(e.getPluginInfo())}})),""!=e.host.queryHostInfo(t.sdkhost.HostInformationKey.HostProvidedFeatures)&&(n.host_provided_features=e.host.queryHostInfo(t.sdkhost.HostInformationKey.HostProvidedFeatures)),[2,n]}}))}))},n.prototype.getAssociatedCollectorType=function(){return r.CollectorType.Capabilities},n}(e.Collector),e.CapabilitiesCollector=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),e=r.core||(r.core={}),n=e.collectors||(e.collectors={}),o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.prototype.provide=function(t){var n=new Object;for(var o in r.CollectorType)n[o]=e.Protocol.CollectorState.Disabled;for(var i=0,s=this.enabledCollectors;i<s.length;i++)n[s[i]]=e.Protocol.CollectorState.Active;var a=new Object;for(var u in r.CollectorType)this.isNumeric(u)&&(a[r.CollectorType[u].toLowerCase()]=n[u]);return Promise.resolve(a)},n.prototype.getAssociatedCollectorType=function(){return null},n.prototype.isNumeric=function(t){return parseInt(t,10)>=0},n}(n.Collector),n.CollectorsStateCollector=o}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.collectors||(o.collectors={}),n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.provide=function(e){var n=e.host,r=new Object;r.logged_users=0,o.User.iterateUsers(e,(function(t){t.deviceBound&&++r.logged_users}));var i=n.queryHostInfo(t.sdkhost.HostInformationKey.DevicePersistenceMode);return"string"==typeof i&&(r.persistence_mode=i),Promise.resolve(r)},n.prototype.getAssociatedCollectorType=function(){return r.CollectorType.DeviceDetails},n}(e.Collector),e.DeviceDetailsCollector=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){var e,n,o,r;r=t.sdk||(t.sdk={}),o=r.core||(r.core={}),e=o.collectors||(o.collectors={}),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.provide=function(t){for(var n=new Object,o=0,r=e.authenticatorDriversLocal;o<r.length;o++){var i=r[o],s=this.provideLocalEnrollmentData(t,i);s&&(n[i]=s)}return Promise.resolve(n)},e.prototype.getAssociatedCollectorType=function(){return r.CollectorType.LocalEnrollments},e.prototype.provideLocalEnrollmentData=function(t,e){var n=null;if(t.currentSession){var o=t.currentSession.user.localEnrollments[e];o&&((n=new Object).registration_status=o.status,n.validation_status=o.validationStatus)}return n},e.authenticatorDriversLocal=[o.authenticationdrivers.AuthenticationDriverLocalPinCode.authenticatorName,o.authenticationdrivers.AuthenticationDriverLocalPattern.authenticatorName,o.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName,o.authenticationdrivers.AuthenticationDriverDescriptorNativeFace.authenticatorName],e}(e.Collector),e.LocalEnrollmentsCollector=n}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){t.TarsusCollectors={capabilities:{createCollector:t.CapabilitiesCollector},collector_state:{createCollector:t.CollectorsStateCollector},device_details:{createCollector:t.DeviceDetailsCollector},local_enrollments:{createCollector:t.LocalEnrollmentsCollector}}}(t.collectors||(t.collectors={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){var e=function(){};t.PKCredentialException=e;var n=function(){function t(t,e){this._credentialId=t,this._userInteractionSessionProvider=e}return Object.defineProperty(t.prototype,"credentialId",{get:function(){return this._credentialId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return this._userInteractionSessionProvider._session.user},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdk",{get:function(){return this._userInteractionSessionProvider._sdk},enumerable:!1,configurable:!0}),t.prototype.getClientContext=function(){return this._userInteractionSessionProvider._clientContext},t}();t.PKCredential=n}(t.credential||(t.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o){var r=n.call(this,t,o)||this;return r._host=e,r._externalCancelled=!1,r}return V(o,n),Object.defineProperty(o.prototype,"uiHandler",{get:function(){return this._userInteractionSessionProvider._uiHandler},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"authenticatorDescription",{get:function(){return this._authenticatorDescription},enumerable:!1,configurable:!0}),o.prototype.onCancelRun=function(){this._externalCancelled=!0,this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null)},o.prototype.startCredentialSession=function(e){if(this._authenticatorConfig=this._host.getAuthenticatorConfig(this),this._inputSession=this.createAuthenticatorSession(),!this._inputSession)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from authenticator session creation call.");this._authenticatorDescription=this._host.getAuthenticatorDescription(this),this._inputSession.startSession(this._authenticatorDescription,t.AuthenticatorSessionMode.Authentication,this._host.getPolicyAction(this),e)},o.prototype.endCredentialSession=function(){this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null),this._inputSession&&(this._inputSession.endSession(),delete this._inputSession)},o.prototype.signHex=function(t){var e=this;return this.doSafeCredentialOperation((function(){return e.lastObtainedKeyPair.signHex(t)}))},o.prototype.unwrapAsymmetricKeyPairFromPrivateHex=function(t,e){var n=this;return this.doSafeCredentialOperation((function(){return n.lastObtainedKeyPair.unwrapAsymmetricKeyPairFromPrivateKeyHex(t,e)}))},o.prototype.doSafeCredentialOperation=function(e){var n=this;return new Promise((function(o,r){n._rejectionFunction||n._completionFunction?r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Illegal credential state")):(n._rejectionFunction=r,n._completionFunction=function(i){n.lastObtainedKeyPair=i;try{e().then(o,(function(e){return n.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))}catch(e){r(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}},n.authenticateInStartedSession(!1))})).finally((function(){n._rejectionFunction=null,n._completionFunction=null}))},o.prototype.promiseRecoveryForError=function(e,n,o){var r=this;return n.indexOf(o)<0&&(o=n.indexOf(t.AuthenticationErrorRecovery.SelectAuthenticator)>=0?t.AuthenticationErrorRecovery.SelectAuthenticator:t.AuthenticationErrorRecovery.Fail),this._inputSession.promiseRecoveryForError(e,n,o).then((function(o){return r.sdk.log(t.LogLevel.Debug,(function(){return"Error recovery selected "+o})),r.sdk.log(t.LogLevel.Debug,(function(){return"recover from error: "+e.getErrorCode()})),n.indexOf(o)<0?(r.sdk.log(t.LogLevel.Error,(function(){return"Invalid error recovery option from callback: "+o+" not in "+n})),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid error recovery action selected by callback."))):Promise.resolve(o)}))},o.prototype.evaluateLocalRegistrationStatus=function(){var n=this.user.localEnrollments[this.credentialId];return n?n.validationStatus==e.LocalEnrollmentValidationStatus.Invalidated?t.AuthenticatorRegistrationStatus.LocallyInvalid:n.status!=e.LocalEnrollmentStatus.Registered?t.AuthenticatorRegistrationStatus.Unregistered:t.AuthenticatorRegistrationStatus.Registered:t.AuthenticatorRegistrationStatus.LocallyInvalid},Object.defineProperty(o.prototype,"lastObtainedKeyPair",{get:function(){return this._lastObtainedKeyPair},set:function(t){this._lastObtainedKeyPair&&this._lastObtainedKeyPair!=t&&(t&&this._lastObtainedKeyPair.getTag()===t.getTag()||this._lastObtainedKeyPair.closeKeyPair()),this._lastObtainedKeyPair=t},enumerable:!1,configurable:!0}),o.prototype.authenticateInStartedSession=function(e){var n=this;this._inputSession.promiseInput().then((function(t){return n.handleInputOrControlResponse(t)}),(function(e){return n.completeCredentialOperationWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}))},o.prototype.handleAuthenticationInputResponse=function(e){var n=this,o=this.user.localEnrollments[this.credentialId];o?this.getKeyForEnrollmentDataAndInput(o,e).then((function(e){n.sdk.log(t.LogLevel.Debug,(function(){return"Local authenticator key obtained; signing challenge"})),n.completeCredentialOperationWithResult(e)})).catch((function(e){n.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))})):this.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"Missing key for fingerprint authenticator"))},o.prototype.processLocalAuthenticatorError=function(e){var n=this,o=this._host.getCredentialValidErrorRecoveryOptions(this,e),r=o.indexOf(t.AuthenticationErrorRecovery.RetryAuthenticator)>=0?t.AuthenticationErrorRecovery.RetryAuthenticator:t.AuthenticationErrorRecovery.Fail;this.promiseRecoveryForError(e,o,r).then((function(t){n.handleErrorRecoveryAction(t,e)}))},o.prototype.completeCredentialOperationWithResult=function(t){this._completionFunction(t)},o.prototype.completeCredentialOperationWithError=function(t){this._rejectionFunction(t)},o.prototype.handleInputOrControlResponse=function(e){try{e.isControlRequest()?e.getControlRequest().getRequestType()==t.ControlRequestType.CancelAuthenticator?this.invokeUiHandlerCancellation():this.signalControlRequest(e.getControlRequest()):e.getActionEscapeRequest()?this.signalEscapeRequest(e.getActionEscapeRequest()):this.handleAuthenticationInputResponse(e.getResponse())}catch(e){this.completeCredentialOperationWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}},o.prototype.signalControlRequest=function(e){this._externalCancelled&&e.getRequestType()==t.ControlRequestType.CancelAuthenticator&&(e=t.ControlRequest.create(t.ControlRequestType.AbortAuthentication)),this._rejectionFunction(e)},o.prototype.signalEscapeRequest=function(t){this._rejectionFunction(t)},o.prototype.invokeUiHandlerCancellation=function(){var e=this,n=this._host.getCredentialAvailableCancellationOptions(this);this.uiHandler.controlOptionForCancellationRequestInSession(n,this._inputSession).then((function(o){o.getRequestType()==t.ControlRequestType.CancelAuthenticator&&e.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned CancelAuthenticator which is an invalid option.")),n.indexOf(o.getRequestType())<0&&e.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned an invalid option.")),e.signalControlRequest(o)}))},o.prototype.handleErrorRecoveryAction=function(e,n){switch(e){case t.AuthenticationErrorRecovery.RetryAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.RetryAuthenticator));break;case t.AuthenticationErrorRecovery.ChangeAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.ChangeMethod));break;case t.AuthenticationErrorRecovery.SelectAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.SelectMethod));break;case t.AuthenticationErrorRecovery.Fail:default:this.completeCredentialOperationWithError(n)}},o}(n.PKCredential);n.PKCredentialAuthLocal=o}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(t,e,n){return o.call(this,t,e,n)||this}return V(r,o),r.prototype.getKeyForEnrollmentDataAndInput=function(t,n){var o=this;return new Promise((function(e,r){t.version>="v2"?o.getKeyForEnrollmentDataAndInputV2(t,n).then(e,r):o.getKeyForEnrollmentDataAndInputPreV2(t,n).then(e,r)})).then((function(t){if(!t)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.InvalidInput,"Invalid input provided to credential.");return t}))},r.prototype.getKeyForEnrollmentDataAndInputV2=function(e,o){var r=this,i=this.extractPbkdfInputFromInputResponse(o);return n.vault.pbkdfStretchHexSecretIntoAESKey(e.salt,i,e.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),e.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,this.sdk).then((function(o){return o.decrypt(e.keyMaterial,null).then((function(o){return r.sdk.host.generateHexSeededKeyPairExternalRepresentation(t.sdkhost.KeyClass.FidoECCSigningKey,o,n.authenticationdrivers.AuthenticationDriverLocalSecretInputBased.enrollmentVersion2KeyGenVersion(e.version),e.publicKeyHash).then((function(e){return r.sdk.host.importVolatileKeyPair(t.sdkhost.KeyClass.FidoECCSigningKey,e)}))}))}))},r.prototype.getKeyForEnrollmentDataAndInputPreV2=function(e,n){var o=this;return this.authenticatorKeyTagForScheme(e.version,e.salt,e.cryptoSettings,n).then((function(e){return o.sdk.host.getKeyPair(e,t.sdkhost.KeyClass.StdSigningKey,t.sdkhost.KeyBiometricProtectionMode.None)}))},r.prototype.authenticatorKeyTagForScheme=function(t,o,r,i){var s=this;return new Promise((function(a,u){var c=s.extractPbkdfInputFromInputResponse(i);if("v0"==t&&(s.sdk.log(e.LogLevel.Debug,(function(){return"Using SDK CryptoSettings for migrated enrollment."})),r=s.sdk.cryptoSettings),!r)throw new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Missing crypto settings for local enrollment.");s.sdk.host.generatePbkdf2HmacSha1HexString(o,c,r.getLocalEnrollmentKeySizeInBytes(),r.getLocalEnrollmentKeyIterationCount()).then((function(o){var r=e.util.hexToBase64(o);return new n.TarsusKeyPath("per_user",s.user.guid.toString(),"local_auth_keys",s.credentialId,t,r)})).then(a,u)}))},r}(o.PKCredentialAuthLocal);o.PKCredentialLocalSecretInputBased=r}(n.credential||(n.credential={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(){};e.CredentialAuthPinCodeConfig=n;var o=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),Object.defineProperty(n.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),n.prototype.extractPbkdfInputFromInputResponse=function(e){var n=e;return t.util.asciiToHex(n.getPin())},n.prototype.createAuthenticatorSession=function(){return this.uiHandler.createPinAuthSession(this.credentialId,this.user.displayName,this.pinLength)},n.create=function(t,e,o){return new n(t,e,o)},n}(e.PKCredentialLocalSecretInputBased);e.PKCredentialLocalPinCode=o}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(e){var n=function(e){function n(t,n,o){return e.call(this,t,n,o)||this}return V(n,e),n.prototype.handleAuthenticationInputResponse=function(n){var o=n;t.impl.PatternInputImpl.validateFormat(o)?e.prototype.handleAuthenticationInputResponse.call(this,n):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.extractPbkdfInputFromInputResponse=function(e){var n=e;return t.util.asciiToHex(n.getPatternDescription())},n.prototype.createAuthenticatorSession=function(){var t,e,n=this._authenticatorConfig,o=this.uiHandler.createPatternAuthSession(this.credentialId,this.user.displayName,3,4);return null===(e=(t=o).setMinLength)||void 0===e||e.call(t,n.min_length),o},n.create=function(t,e,o){return new n(t,e,o)},n}(e.PKCredentialLocalSecretInputBased);e.PKCredentialLocalPattern=n}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(e){!function(n){!function(o){var r=function(o){function r(){return null!==o&&o.apply(this,arguments)||this}return V(r,o),r.prototype.authenticatorKeyTagForScheme=function(t,e){return new n.TarsusKeyPath("per_user",this.user.guid.toString(),"local_auth_keys",this.credentialId,t,e)},r.prototype.getKeyForEnrollmentDataAndInput=function(n,o){var r=this;return new Promise((function(i,s){var a=r.authenticatorKeyTagForScheme(n.version,n.salt),u=r.sdk.host.getKeyPair(a,t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!u){var c={};throw c[t.sdkhost.ErrorDataInternalError]=t.sdkhost.InternalErrorBiometricInvalidated,new e.impl.AuthenticationErrorImpl(e.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated biometric authenticator.",c)}r.updateKeyPairWithAuthenticationInput(u,r._inputSession,o),i(u)}))},r.prototype.processLocalAuthenticatorError=function(o){var r=this,i=o,s=Promise.resolve();if(i.getErrorCode()==e.AuthenticationErrorCode.Internal&&i.getData()){var a=i.getData();i=e.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(a,this.credentialId)||i,(a[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||a[t.sdkhost.ErrorDataInternalError]==t.sdkhost.InternalErrorBiometricInvalidated)&&(s=n.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._userInteractionSessionProvider,this._authenticatorDescription))}s.catch((function(t){r.sdk.log(e.LogLevel.Error,t)})),s.finally((function(){if(i.getErrorCode()==e.AuthenticationErrorCode.UserCanceled)return r.sdk.log(e.LogLevel.Debug,(function(){return"${this.credentialId} authenticator captured user cancel error code."})),void r.invokeUiHandlerCancellation();r.completeCredentialOperationWithError(i)}))},r.prototype.evaluateLocalRegistrationStatus=function(){var n=o.prototype.evaluateLocalRegistrationStatus.call(this);if(n!=e.AuthenticatorRegistrationStatus.Registered)return n;var r=this.user.localEnrollments[this.credentialId],i=this.authenticatorKeyTagForScheme(r.version,r.salt),s=this.sdk.host.getKeyPair(i,t.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,t.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return s?(s.closeKeyPair(),e.AuthenticatorRegistrationStatus.Registered):e.AuthenticatorRegistrationStatus.LocallyInvalid},r}(o.PKCredentialAuthLocal);o.PKCredentialBiometric=r}(n.credential||(n.credential={}))}(e.core||(e.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o){return n.call(this,t,e,o)||this}return V(o,n),o.prototype.updateKeyPairWithAuthenticationInput=function(e,n,o){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.fingerprintInput(o),this.uiHandler,n)},o.prototype.authenticatorKeyTagForScheme=function(t,n){return e.authenticationdrivers.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(this.user,t,n)},o.prototype.createAuthenticatorSession=function(){return this.uiHandler.createFingerprintAuthSession(this.credentialId,this.user.displayName)},o.prototype.shouldAllowBiometricFallbackButton=function(t){if(!t)return!1;var e=t.getFallbackButtonTitle();return!!(e&&e.length>0)},o.create=function(t,e,n){return new o(t,e,n)},o}(n.PKCredentialBiometric);n.PKCredentialFingerprint=o}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o){return n.call(this,t,e,o)||this}return V(o,n),o.prototype.updateKeyPairWithAuthenticationInput=function(e,n,o){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.nativeFaceInput(o),null,null)},o.prototype.authenticatorKeyTagForScheme=function(t,n){return e.authenticationdrivers.AuthenticationDriverNativeFace.authenticatorKeyTagForUser(this.user,t,n)},o.prototype.createAuthenticatorSession=function(){return this.uiHandler.createNativeFaceAuthSession(this.credentialId,this.user.displayName)},o.prototype.shouldAllowBiometricFallbackButton=function(t){if(!t)return!1;var e=t.getFallbackButtonTitle();return!!(e&&e.length>0)},o.create=function(t,e,n){return new o(t,e,n)},o}(n.PKCredentialBiometric);n.PKCredentialNativeFace=o}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){!function(n){var o=function(n){function o(t,e,o){return n.call(this,t,e,o)||this}return V(o,n),o.prototype.updateKeyPairWithAuthenticationInput=function(e,n,o){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.deviceBiometricInput(o,this._authenticatorConfig),null,null)},o.prototype.authenticatorKeyTagForScheme=function(t,o){return e.authenticationdrivers.AuthenticationDriverDeviceBiometrics.authenticatorKeyTagForUserForMigratedEnrollment(this.user,t,o)||n.prototype.authenticatorKeyTagForScheme.call(this,t,o)},o.prototype.createAuthenticatorSession=function(){return this.uiHandler.createDeviceBiometricsAuthSession(this.credentialId,this.user.displayName)},o.create=function(t,e,n){return new o(t,e,n)},o}(n.PKCredentialBiometric);n.PKCredentialDeviceBiometrics=o}(e.credential||(e.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){!function(t){t.CredentialTypes={pin:t.PKCredentialLocalPinCode,pattern:t.PKCredentialLocalPattern,fingerprint:t.PKCredentialFingerprint,face_id:t.PKCredentialNativeFace,device_biometrics:t.PKCredentialDeviceBiometrics}}(t.credential||(t.credential={}))}(t.core||(t.core={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getEscapeOption=function(){return this._escapeOption},t.prototype.setEscapeOption=function(t){this._escapeOption=t},t.prototype.getEscapeParameters=function(){return this._escapeParameters},t.prototype.setEscapeParameters=function(t){this._escapeParameters=t},t.__tarsusInterfaceName="ActionEscapeRequest",t}();t.ActionEscapeRequest=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="AnonymousPolicyInvocationOptions",e}(t.JourneyInvocationOptions);t.AnonymousPolicyInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="ApprovalPolicyInvocationOptions",e}(t.JourneyInvocationOptions);t.ApprovalPolicyInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getAcquisitionResponse=function(){return this._acquisitionResponse},e.prototype.setAcquisitionResponse=function(t){this._acquisitionResponse=t},e.__tarsusInterfaceName="AudioInputResponse",e}(t.InputResponseType);t.AudioInputResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="AuthenticateInvocationOptions",e}(t.JourneyInvocationOptions);t.AuthenticateInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Internal=0]="Internal",t[t.InvalidInput=1]="InvalidInput",t[t.AuthenticatorLocked=2]="AuthenticatorLocked",t[t.AllAuthenticatorsLocked=3]="AllAuthenticatorsLocked",t[t.NoRegisteredAuthenticator=4]="NoRegisteredAuthenticator",t[t.RegisteredSecretAlreadyInHistory=5]="RegisteredSecretAlreadyInHistory",t[t.Communication=6]="Communication",t[t.UserCanceled=7]="UserCanceled",t[t.AppImplementation=8]="AppImplementation",t[t.PolicyRejection=9]="PolicyRejection",t[t.AuthenticatorInvalidated=10]="AuthenticatorInvalidated",t[t.ControlFlowExpired=11]="ControlFlowExpired",t[t.SessionRequired=12]="SessionRequired",t[t.AuthenticatorError=13]="AuthenticatorError",t[t.ApprovalWrongState=14]="ApprovalWrongState",t[t.TotpNotProvisioned=15]="TotpNotProvisioned",t[t.AuthenticatorExternalConfigError=16]="AuthenticatorExternalConfigError",t[t.InvalidDeviceBinding=17]="InvalidDeviceBinding",t[t.InvalidIdToken=18]="InvalidIdToken",t[t.DeviceNotFound=19]="DeviceNotFound",t[t.ApprovalDenied=20]="ApprovalDenied",t[t.ApprovalExpired=21]="ApprovalExpired",t[t.ApplicationGeneratedRecoverableError=22]="ApplicationGeneratedRecoverableError",t[t.UserNotFound=23]="UserNotFound"}(t.AuthenticationErrorCode||(t.AuthenticationErrorCode={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.AuthenticatorExternalConfigErrorReason=0]="AuthenticatorExternalConfigErrorReason",t[t.AuthenticatorInvalidInputErrorDescription=1]="AuthenticatorInvalidInputErrorDescription",t[t.InvalidIdTokenErrorReason=2]="InvalidIdTokenErrorReason",t[t.UserRecordDeleted=3]="UserRecordDeleted",t[t.AuthenticationErrorFailingActionType=4]="AuthenticationErrorFailingActionType",t[t.AuthenticationErrorReason=5]="AuthenticationErrorReason"}(t.AuthenticationErrorProperty||(t.AuthenticationErrorProperty={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled=0]="AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled",t[t.AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary=1]="AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary",t[t.AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent=2]="AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent",t[t.AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit=3]="AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit",t[t.InvalidIdTokenErrorReasonExpiredToken=4]="InvalidIdTokenErrorReasonExpiredToken",t[t.InvalidIdTokenErrorReasonBadToken=5]="InvalidIdTokenErrorReasonBadToken",t[t.AuthenticationErrorReasonAttestationReverificationFailed=6]="AuthenticationErrorReasonAttestationReverificationFailed",t[t.AuthenticationErrorReasonCredentialFiltered=7]="AuthenticationErrorReasonCredentialFiltered",t[t.AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure=8]="AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure"}(t.AuthenticationErrorPropertySymbol||(t.AuthenticationErrorPropertySymbol={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.RetryAuthenticator=0]="RetryAuthenticator",t[t.ChangeAuthenticator=1]="ChangeAuthenticator",t[t.SelectAuthenticator=2]="SelectAuthenticator",t[t.Fail=3]="Fail"}(t.AuthenticationErrorRecovery||(t.AuthenticationErrorRecovery={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Register=0]="Register",t[t.Unregister=1]="Unregister",t[t.Reregister=2]="Reregister"}(t.AuthenticatorConfigurationAction||(t.AuthenticatorConfigurationAction={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Fallback=0]="Fallback",t[t.AuthMenu=1]="AuthMenu",t[t.Retry=2]="Retry",t[t.Cancel=3]="Cancel"}(t.AuthenticatorFallbackAction||(t.AuthenticatorFallbackAction={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Registered=0]="Registered",t[t.Unregistered=1]="Unregistered",t[t.LocallyInvalid=2]="LocallyInvalid"}(t.AuthenticatorRegistrationStatus||(t.AuthenticatorRegistrationStatus={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.SelectAuthenticator=0]="SelectAuthenticator",t[t.Abort=1]="Abort",t[t.Escape=2]="Escape"}(t.AuthenticatorSelectionResultType||(t.AuthenticatorSelectionResultType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Authentication=0]="Authentication",t[t.Registration=1]="Registration"}(t.AuthenticatorSessionMode||(t.AuthenticatorSessionMode={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="BindInvocationOptions",e}(t.JourneyInvocationOptions);t.BindInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getAcquisitionResponse=function(){return this._acquisitionResponse},e.prototype.setAcquisitionResponse=function(t){this._acquisitionResponse=t},e.__tarsusInterfaceName="CameraInputResponse",e}(t.InputResponseType);t.CameraInputResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Accounts=0]="Accounts",t[t.DeviceDetails=1]="DeviceDetails",t[t.Contacts=2]="Contacts",t[t.Owner=3]="Owner",t[t.Software=4]="Software",t[t.Location=5]="Location",t[t.LocationCountry=6]="LocationCountry",t[t.Bluetooth=7]="Bluetooth",t[t.ExternalSDKDetails=8]="ExternalSDKDetails",t[t.HWAuthenticators=9]="HWAuthenticators",t[t.Capabilities=10]="Capabilities",t[t.LargeData=11]="LargeData",t[t.LocalEnrollments=12]="LocalEnrollments",t[t.DeviceFingerprint=13]="DeviceFingerprint",t[t.AppPermissions=14]="AppPermissions"}(t.CollectorType||(t.CollectorType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.Credentials=1]="Credentials",t[t.Full=2]="Full"}(t.ConnectionCryptoMode||(t.ConnectionCryptoMode={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.CancelAuthenticator=0]="CancelAuthenticator",t[t.RetryAuthenticator=1]="RetryAuthenticator",t[t.ChangeMethod=2]="ChangeMethod",t[t.SelectMethod=3]="SelectMethod",t[t.AbortAuthentication=4]="AbortAuthentication"}(t.ControlRequestType||(t.ControlRequestType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Remove=0]="Remove",t[t.Rename=1]="Rename"}(t.DeviceManagementAction||(t.DeviceManagementAction={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.RecentlyUsed=0]="RecentlyUsed",t[t.NoRecentActivity=1]="NoRecentActivity",t[t.LongInactivity=2]="LongInactivity",t[t.Disabled=3]="Disabled",t[t.Removed=4]="Removed"}(t.DeviceStatus||(t.DeviceStatus={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Submit=0]="Submit",t[t.Abort=1]="Abort",t[t.Escape=2]="Escape"}(t.FormControlRequest||(t.FormControlRequest={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Disable=0]="Disable",t[t.RecoverDeviceAndBindingOnAuthenticate=1]="RecoverDeviceAndBindingOnAuthenticate"}(t.InvalidUserRecordRecoveryMode||(t.InvalidUserRecordRecoveryMode={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Off=0]="Off",t[t.Critical=1]="Critical",t[t.Error=2]="Error",t[t.Warning=3]="Warning",t[t.Info=4]="Info",t[t.Debug=5]="Debug"}(t.LogLevel||(t.LogLevel={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Approve=0]="Approve",t[t.Deny=1]="Deny"}(t.MobileApprovalAction||(t.MobileApprovalAction={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Pending=0]="Pending",t[t.Approved=1]="Approved",t[t.Denied=2]="Denied",t[t.Expired=3]="Expired"}(t.MobileApprovalStatus||(t.MobileApprovalStatus={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Unknown=0]="Unknown",t[t.Sms=1]="Sms",t[t.Email=2]="Email",t[t.PushNotification=3]="PushNotification",t[t.VoiceCall=4]="VoiceCall"}(t.OtpChannel||(t.OtpChannel={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getFailureError=function(){return this._failureError},e.prototype.setFailureError=function(t){this._failureError=t},e.prototype.getExpired=function(){return this._expired},e.prototype.setExpired=function(t){this._expired=t},e.prototype.getRegistered=function(){return this._registered},e.prototype.setRegistered=function(t){this._registered=t},e.prototype.getRegistrationStatus=function(){return this._registrationStatus},e.prototype.setRegistrationStatus=function(t){this._registrationStatus=t},e.prototype.getLocked=function(){return this._locked},e.prototype.setLocked=function(t){this._locked=t},e.__tarsusInterfaceName="PlaceholderAuthFailureResponse",e}(t.PlaceholderInputResponse);t.PlaceholderAuthFailureResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getFailureError=function(){return this._failureError},e.prototype.setFailureError=function(t){this._failureError=t},e.__tarsusInterfaceName="PlaceholderAuthFailureWithServerProvidedStatusResponse",e}(t.PlaceholderInputResponse);t.PlaceholderAuthFailureWithServerProvidedStatusResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getPlaceholderToken=function(){return this._placeholderToken},e.prototype.setPlaceholderToken=function(t){this._placeholderToken=t},e.__tarsusInterfaceName="PlaceholderAuthSuccessResponse",e}(t.PlaceholderInputResponse);t.PlaceholderAuthSuccessResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.__tarsusInterfaceName="PolicyInvocationOptions",e}(t.JourneyInvocationOptions);t.PolicyInvocationOptions=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Skip=0]="Skip",t[t.Abort=1]="Abort",t[t.Continue=2]="Continue"}(t.PromotionControlRequest||(t.PromotionControlRequest={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Numeric=0]="Numeric",t[t.Alphanumeric=1]="Alphanumeric",t[t.Binary=2]="Binary"}(t.QrCodeFormat||(t.QrCodeFormat={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.RedirectToPolicy=0]="RedirectToPolicy",t[t.CancelRedirect=1]="CancelRedirect"}(t.RedirectResponseType||(t.RedirectResponseType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getAnswers=function(){return this._answers},e.__tarsusInterfaceName="SecurityQuestionAnswersInputResponse",e}(t.SecurityQuestionInputResponse);t.SecurityQuestionAnswersInputResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.__tarsusInterfaceName="SuspensionContext",t}();t.SuspensionContext=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getValue=function(){return this._value},t.prototype.setValue=function(t){this._value=t},t.prototype.getFormat=function(){return this._format},t.prototype.setFormat=function(t){this._format=t},t.__tarsusInterfaceName="TotpChallenge",t}();t.TotpChallenge=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getName=function(){return this._name},t.prototype.setName=function(t){this._name=t},t.prototype.getValue=function(){return this._value},t.prototype.setValue=function(t){this._value=t},t.__tarsusInterfaceName="TransportHeader",t}();t.TransportHeader=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getStatus=function(){return this._status},t.prototype.setStatus=function(t){this._status=t},t.prototype.getMethod=function(){return this._method},t.prototype.setMethod=function(t){this._method=t},t.prototype.getHeaders=function(){return this._headers},t.prototype.setHeaders=function(t){this._headers=t},t.prototype.getBodyJson=function(){return this._bodyJson},t.prototype.setBodyJson=function(t){this._bodyJson=t},t.__tarsusInterfaceName="TransportResponse",t}();t.TransportResponse=e}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Disable=0]="Disable",t[t.DownloadOnInit=1]="DownloadOnInit"}(t.UIAssetsDownloadMode||(t.UIAssetsDownloadMode={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.UserId=0]="UserId",t[t.IdToken=1]="IdToken"}(t.UserHandleType||(t.UserHandleType={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Fido2UserVerifyingPlatformAuthenticatorAvailable=0]="Fido2UserVerifyingPlatformAuthenticatorAvailable"}(t.AsyncHostInformationKey||(t.AsyncHostInformationKey={}))}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getLocalizedTitle=function(){return this._localizedTitle},t.prototype.setLocalizedTitle=function(t){this._localizedTitle=t},t.prototype.getLocalizedSubtitle=function(){return this._localizedSubtitle},t.prototype.setLocalizedSubtitle=function(t){this._localizedSubtitle=t},t.prototype.getLocalizedPrompt=function(){return this._localizedPrompt},t.prototype.setLocalizedPrompt=function(t){this._localizedPrompt=t},t.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},t.prototype.setFallbackButtonTitle=function(t){this._fallbackButtonTitle=t},t.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},t.prototype.setCancelButtonTitle=function(t){this._cancelButtonTitle=t},t.prototype.getRequireConfirmation=function(){return this._requireConfirmation},t.prototype.setRequireConfirmation=function(t){this._requireConfirmation=t},t.__tarsusInterfaceName="BiometricPromptInfo",t}();t.BiometricPromptInfo=e}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Create=0]="Create",t[t.Get=1]="Get"}(t.Fido2CredentialsOpType||(t.Fido2CredentialsOpType={}))}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.Version=0]="Version",t[t.Platform=1]="Platform",t[t.FingerprintSupported=2]="FingerprintSupported",t[t.HostProvidedFeatures=3]="HostProvidedFeatures",t[t.FaceIdKeyBioProtectionSupported=4]="FaceIdKeyBioProtectionSupported",t[t.ImageAcquitisionSupported=5]="ImageAcquitisionSupported",t[t.AudioAcquitisionSupported=6]="AudioAcquitisionSupported",t[t.PersistentKeysSupported=7]="PersistentKeysSupported",t[t.DyadicPresent=8]="DyadicPresent",t[t.StdSigningKeyIsHardwareProtectedSignAndEncryptKey=9]="StdSigningKeyIsHardwareProtectedSignAndEncryptKey",t[t.Fido2ClientPresent=10]="Fido2ClientPresent",t[t.DeviceBiometricsSupported=11]="DeviceBiometricsSupported",t[t.DeviceBiometricsFPContinuation=12]="DeviceBiometricsFPContinuation",t[t.DeviceBiometricsUsesSign=13]="DeviceBiometricsUsesSign",t[t.DevicePersistenceMode=14]="DevicePersistenceMode",t[t.Fido2RelyingParty=15]="Fido2RelyingParty"}(t.HostInformationKey||(t.HostInformationKey={}))}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.NormalProtection=1]="NormalProtection",t[t.BindToEnrollmentDb=2]="BindToEnrollmentDb"}(t.KeyBiometricProtectionMode||(t.KeyBiometricProtectionMode={}))}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.StdSigningKey=0]="StdSigningKey",t[t.StdEncryptionKey=1]="StdEncryptionKey",t[t.GeneralPurposeAES=2]="GeneralPurposeAES",t[t.NoIntegrityAES=3]="NoIntegrityAES",t[t.FidoECCSigningKey=4]="FidoECCSigningKey",t[t.HardwareProtectedSignAndEncryptKey=5]="HardwareProtectedSignAndEncryptKey"}(t.KeyClass||(t.KeyClass={}))}(t.sdkhost||(t.sdkhost={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getResultPayload=function(){return this._resultPayload},e.create=function(e){return t.ts.mobile.tarsusplugin.impl.IdpInvocationResultImpl.create(e)},e.__tarsusInterfaceName="IdpInvocationResult",e}();e.IdpInvocationResult=n}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(n){var o=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return V(n,e),n.prototype.getPayload=function(){return this._payload},n.create=function(e){return t.ts.mobile.tarsusplugin.impl.KycDataCollectionResultImpl.create(e)},n.__tarsusInterfaceName="KycDataCollectionResult",n}(e.sdk.InputResponseType);n.KycDataCollectionResult=o}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getPluginName=function(){return this._pluginName},e.prototype.setPluginName=function(t){this._pluginName=t},e.prototype.getVersionMajor=function(){return this._versionMajor},e.prototype.setVersionMajor=function(t){this._versionMajor=t},e.prototype.getVersionMinor=function(){return this._versionMinor},e.prototype.setVersionMinor=function(t){this._versionMinor=t},e.prototype.getVersionPatch=function(){return this._versionPatch},e.prototype.setVersionPatch=function(t){this._versionPatch=t},e.prototype.getRequiredPluginApiLevel=function(){return this._requiredPluginApiLevel},e.prototype.setRequiredPluginApiLevel=function(t){this._requiredPluginApiLevel=t},e.create=function(){return t.ts.mobile.tarsusplugin.impl.PluginInfoImpl.create()},e.__tarsusInterfaceName="PluginInfo",e}();e.PluginInfo=n}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getCode=function(){return this._code},e.prototype.getTimeStepSeconds=function(){return this._timeStepSeconds},e.prototype.getExpiresInSeconds=function(){return this._expiresInSeconds},e.prototype.getSecondsTillNextInvocation=function(){return this._secondsTillNextInvocation},e.prototype.getShouldUpdateSpecificProperties=function(){return this._shouldUpdateSpecificProperties},e.prototype.getGeneratorSpecificDataToStore=function(){return this._generatorSpecificDataToStore},e.prototype.getMessage=function(){return this._message},e.create=function(e,n,o,r,i,s,a){return t.ts.mobile.tarsusplugin.impl.TotpCodeGenerationOutputImpl.create(e,n,o,r,i,s,a)},e.__tarsusInterfaceName="TotpCodeGenerationOutput",e}();e.TotpCodeGenerationOutput=n}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getEscapeRequest=function(){return this._escapeRequest},e.prototype.setEscapeRequest=function(t){this._escapeRequest=t},e.__tarsusInterfaceName="TotpProvisionEscapeRequest",e}(t.TotpProvisionResult);t.TotpProvisionEscapeRequest=e}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){var n=function(){function e(){}return e.prototype.getUnprotectedProvisionOutput=function(){return this._unprotectedProvisionOutput},e.prototype.getSecretToLock=function(){return this._secretToLock},e.create=function(e,n){return t.ts.mobile.tarsusplugin.impl.VaultBasedTotpProvisionOutputImpl.create(e,n)},e.__tarsusInterfaceName="VaultBasedTotpProvisionOutput",e}();e.VaultBasedTotpProvisionOutput=n}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getResultPayload=function(){return this._resultPayload},e.create=function(t){var n=new e;return n._resultPayload=t,n},e.__tarsusInterfaceName="IdpInvocationResult",e}(t.IdpInvocationResult);e.IdpInvocationResultImpl=n}(t.impl||(t.impl={}))}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.getPayload=function(){return this._payload},e.create=function(t){var n=new e;return n._payload=t,n},e.__tarsusInterfaceName="KycDataCollectionResult",e}(t.KycDataCollectionResult);e.KycDataCollectionResultImpl=n}(t.impl||(t.impl={}))}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(e){!function(e){!function(e){!function(n){var o=function(e){function n(){var t=e.call(this)||this;return t._versionMajor=0,t._versionMinor=0,t._versionPatch=0,t}return V(n,e),n.create=function(){return new t.ts.mobile.tarsusplugin.impl.PluginInfoImpl},n.versionToString=function(t){return t.getVersionMajor()+"."+t.getVersionMinor()+"."+t.getVersionPatch()},n.toString=function(t){return t.getPluginName()+" v"+this.versionToString(t)},n}(e.PluginInfo);n.PluginInfoImpl=o}(e.impl||(e.impl={}))}(e.tarsusplugin||(e.tarsusplugin={}))}(e.mobile||(e.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t,n,o,r,i,s,a){var u=new e;return u._code=t,n&&(u._message=n),u._timeStepSeconds=o,u._expiresInSeconds=r,u._secondsTillNextInvocation=i,u._shouldUpdateSpecificProperties=s,a&&(u._generatorSpecificDataToStore=a),u},e}(t.TotpCodeGenerationOutput);e.TotpCodeGenerationOutputImpl=n}(t.impl||(t.impl={}))}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(e){var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.create=function(t,n){var o=new e;return o._secretToLock=t,o._unprotectedProvisionOutput=n,o},e}(t.VaultBasedTotpProvisionOutput);e.VaultBasedTotpProvisionOutputImpl=n}(t.impl||(t.impl={}))}(t.tarsusplugin||(t.tarsusplugin={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={})),function(t){!function(t){!function(t){!function(t){!function(t){function e(t){return!!t.tlvSerializable}function n(n,o){var r=[];return Object.keys(o).forEach((function(i){var s=n[i];if(!s)throw"TLV encoding error: Unknown tag "+i;var a=o[i];a instanceof Array||(a=[a]),a.forEach((function(o){var a=o.__type||s.tagType||e(o)&&t.TlvTypes.Serializable;if(!a)throw"Unknown type for tag "+i;o.__type&&(o=o.__value);var u=a(o,n);r.push(t.TlvTypes.UInt16(s.id)),r.push(t.TlvTypes.UInt16(u.length/2)),r.push(u)}))})),r.join("")}t.instanceOfTlvSerializable=e,t.TlvTypes={UInt8:function(e){return t.numberToHex(e,8)},UInt16:function(e){return t.numberToHex(e>>8&255|(255&e)<<8,16)},UInt32:function(e){return t.numberToHex((255&e)<<24|(e>>8&255)<<16|(e>>16&255)<<8|e>>24&255,32)},Object:function(t,e){return n(e,t)},Serializable:function(t,e){return t.tlvSerialize(e)},String:function(e,n){return t.asciiToHex(e)},HexBinary:function(t,e){return t},Struct:function(t){return function(e,n){var o=[];return Object.keys(t).forEach((function(r){if(r in e){var i=e[r],s=t[r];o.push(s(i,n))}})),o.join("")}}},t.tlvEncodeHex=n}(t.util||(t.util={}))}(t.sdk||(t.sdk={}))}(t.mobile||(t.mobile={}))}(t.ts||(t.ts={}))}(Y||(Y={}));var Z=com.ts.mobile.sdk.createSdk(),tt=new j;Z.setTarsusHost(tt),Z.setTransportProvider(new s(tt)),Z.setEnabledCollectors([com.ts.mobile.sdk.CollectorType.DeviceDetails,com.ts.mobile.sdk.CollectorType.LargeData,com.ts.mobile.sdk.CollectorType.Capabilities]),Z.setEnabledCollectorsForAnonymousJourneys([com.ts.mobile.sdk.CollectorType.DeviceDetails,com.ts.mobile.sdk.CollectorType.Capabilities]),Z.setLogLevel(com.ts.mobile.sdk.LogLevel.Error),window.xmui&&Z.setUiHandler(new window.xmui.XmUIHandler),t.XmSdk=function(){return Z},Object.defineProperty(t,"__esModule",{value:!0})}));
